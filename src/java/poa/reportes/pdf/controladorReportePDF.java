/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package poa.reportes.pdf;

import com.itextpdf.text.BaseColor;
import com.itextpdf.text.Chunk;
import com.itextpdf.text.Document;
import com.itextpdf.text.DocumentException;
import com.itextpdf.text.Element;
import com.itextpdf.text.Font;
import com.itextpdf.text.Image;
import com.itextpdf.text.PageSize;
import com.itextpdf.text.Paragraph;
import com.itextpdf.text.html.WebColors;
import com.itextpdf.text.pdf.PdfPCell;
import com.itextpdf.text.pdf.PdfPTable;
import com.itextpdf.text.pdf.PdfPageEvent;
import com.itextpdf.text.pdf.PdfWriter;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.OutputStream;
import java.io.PrintWriter;
import java.text.DateFormat;
import java.text.DecimalFormat;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Date;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import java.awt.Color;
import java.math.BigDecimal;
import java.math.RoundingMode;
import java.util.Locale;
import java.util.Objects;
import java.util.Random;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import poa.acceso.adActividadRequerimiento;
import poa.acceso.adAreaGestion;
import poa.acceso.adComponenteMeta;
import poa.acceso.adEjecucion;
import poa.acceso.adProyecto;
import poa.acceso.adTecho;
import poa.clases.cActividadRequerimiento;
import poa.clases.cAreaGestion;
import poa.clases.cComponenteMeta;
import poa.clases.cProyecto;
import poa.clases.cTecho;

/**
 *
 * @author PLANIFICACION
 */
public class controladorReportePDF extends HttpServlet {

    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException, FileNotFoundException {

        if (request.getParameter("accion") != null) {

            String strAccion = request.getParameter("accion");

            switch (strAccion) {

                case "reporteProyectoCompleto": {
                    try {
                        reporteProyectoCompleto(request, response);
                    } catch (DocumentException ex) {
                        Logger.getLogger(controladorReportePDF.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
                break;
                case "reporteProyectoCompletoPlan": {
                    try {
                        reporteProyectoCompletoPlan(request, response);
                    } catch (DocumentException ex) {
                        Logger.getLogger(controladorReportePDF.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
                break;
                case "reportePOA": {
                    try {
                        reportePOA(request, response);
                    } catch (DocumentException ex) {
                        Logger.getLogger(controladorReportePDF.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
                break;
                case "reportePOA20": {
                    try {
                        reportePOA20(request, response);
                    } catch (DocumentException ex) {
                        Logger.getLogger(controladorReportePDF.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
                break;
                case "reportePOAUnidades": {
                    try {
                        reportePOAUnidades(request, response);
                    } catch (DocumentException ex) {
                        Logger.getLogger(controladorReportePDF.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
                break;
                case "reportePOAEvalUnidades": {
                    try {
                        reportePOAEvalUnidades(request, response);
                    } catch (DocumentException ex) {
                        Logger.getLogger(controladorReportePDF.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
                break;
                case "reportePOAEvalAdmin": {
                    try {
                        reportePOAEvalAdmin(request, response);
                    } catch (DocumentException ex) {
                        Logger.getLogger(controladorReportePDF.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
                break;
                case "reporteJustificativo": {
                    try {
                        reporteJustificativo(request, response);
                    } catch (DocumentException ex) {
                        Logger.getLogger(controladorReportePDF.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
                break;
                case "reporteJustificativoUni": {
                    try {
                        reporteJustificativoUni(request, response);
                    } catch (DocumentException ex) {
                        Logger.getLogger(controladorReportePDF.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
                break;
                case "reporteOficio": {
                    try {
                        reporteOficio(request, response);
                    } catch (DocumentException ex) {
                        Logger.getLogger(controladorReportePDF.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
                break;
                case "reporteCustodios": {
                    try {
                        reporteCustodios(request, response);
                    } catch (DocumentException ex) {
                        Logger.getLogger(controladorReportePDF.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
                break;
                case "reporteSolicitud": {
                    try {
                        reporteSolicitud(request, response);
                    } catch (DocumentException ex) {
                        Logger.getLogger(controladorReportePDF.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
                break;
                case "reporteSolicitudTH": {
                    try {
                        reporteSolicitudTH(request, response);
                    } catch (DocumentException ex) {
                        Logger.getLogger(controladorReportePDF.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
                break;
                case "reporteSolicitudTHOP": {
                    try {
                        reporteSolicitudTHOP(request, response);
                    } catch (DocumentException ex) {
                        Logger.getLogger(controladorReportePDF.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
                break;
                case "reporteSolicitudOP": {
                    try {
                        reporteSolicitudOP(request, response);
                    } catch (DocumentException ex) {
                        Logger.getLogger(controladorReportePDF.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
                break;
            }
        }
    }

    private void reporteProyectoCompleto(HttpServletRequest request, HttpServletResponse response) throws FileNotFoundException, IOException, DocumentException {
        Document document = new Document(PageSize.LETTER, 60, 45, 120, 50);
        //Document document = new Document(PageSize.LETTER, 60, 45, 140, 75);
        DecimalFormat formateador = new DecimalFormat("####,###,###.##");
        try {
            String path = getServletContext().getRealPath("/") + "img/reporte/";
            String pathimg = getServletContext().getRealPath("/") + "img/reporte/";
// Paso 2: Establecemos el ContentType y creamos una instancia del Writer
            response.setContentType("application/pdf");
            String titulo = request.getParameter("agnombrepdf");
            OutputStream file = new FileOutputStream(new File(path + "reporte_POA.pdf"));
            PdfWriter writer = PdfWriter.getInstance(document, response.getOutputStream());
            //PdfWriter writer2 = PdfWriter.getInstance(document, file);
            formatoReporteV eventos = new formatoReporteV(path, titulo, pathimg + "logo-plan.png");

            writer.setPageEvent(eventos);
            //writer2.setPageEvent(eventos);
// Paso 3
            document.open();
// Paso 4
            document.addTitle("Perfil del Proyecto");

            //Lista de presupuesto
            List<cProyecto> resultproy = new ArrayList<cProyecto>();
            adProyecto aComp = new adProyecto();
            resultproy = aComp.ListarProyectoCompleto(Integer.parseInt(request.getParameter("proyidpdf")));

            Font fuente = new Font();
            fuente.setSize(10);
            Font fuen = new Font(Font.FontFamily.TIMES_ROMAN, 12, 1);
            Font fuen1 = new Font(Font.FontFamily.TIMES_ROMAN, 11, Font.BOLD | Font.ITALIC);
            Font fuente1 = new Font(Font.FontFamily.TIMES_ROMAN, 11, 1);
            Font fuente2 = new Font(Font.FontFamily.TIMES_ROMAN, 9, 1);
            Font fuente3 = new Font(Font.FontFamily.TIMES_ROMAN, 8, 0);
            Font fuente3ne = new Font(Font.FontFamily.TIMES_ROMAN, 7, 1, BaseColor.BLACK);

            BaseColor azul = WebColors.getRGBColor("#133351");
            Chunk parteag = new Chunk(resultproy.get(0).getAg().getAg_nombre(), fuen);
            Paragraph paraag = new Paragraph();
            paraag.add(parteag);
            paraag.setAlignment(Element.ALIGN_CENTER);
            document.add(paraag);

            Chunk parte2 = new Chunk("PERFIL DEL PROYECTO", fuen);
            Paragraph para2 = new Paragraph();
            para2.add(parte2);
            para2.setAlignment(Element.ALIGN_CENTER);
            document.add(para2);
            document.add(new Paragraph(" "));

            PdfPTable tablef = new PdfPTable(4);
            tablef.setTotalWidth(new float[]{105, 155, 105, 155});
            tablef.setLockedWidth(true);
            PdfPCell cell;

            cell = new PdfPCell(new Paragraph("OBJETIVO ESTRATÈGICO:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getPer().getPerspectiva_nombre(), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            cell.setColspan(3);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("OBJETIVO OPERATIVO:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getPer().getObjetivo_nombre(), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            cell.setColspan(3);
            tablef.addCell(cell);

            if (resultproy.get(0).getProyecto_ag() <= 2022) {
                cell = new PdfPCell(new Paragraph("ACTIVIDAD PRESUPUESTARIA:", fuente2));
            } else {
                cell = new PdfPCell(new Paragraph("PROYECTO INSTITUCIONAL:", fuente2));
            }
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getPer().getAp_nombre(), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            cell.setColspan(3);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("NOMBRE:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getProyecto_nombre(), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            cell.setColspan(3);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("FIN DEL PROYECTO:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getProyecto_fin(), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            cell.setColspan(3);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("PROPÒSITO:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getProyecto_proposito(), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            cell.setColspan(3);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("FECHA INICIO:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            try {
                if (resultproy.get(0).getProyecto_fi_rep().isEmpty()) {
                    cell = new PdfPCell(new Paragraph(resultproy.get(0).getProyecto_fi(), fuente3));
                } else {
                    cell = new PdfPCell(new Paragraph(resultproy.get(0).getProyecto_fi_rep(), fuente3));
                }
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                tablef.addCell(cell);
            } catch (Exception e) {
                cell = new PdfPCell(new Paragraph(resultproy.get(0).getProyecto_fi(), fuente3));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                tablef.addCell(cell);
            }

            cell = new PdfPCell(new Paragraph("FECHA FIN:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);
            try {
                if (resultproy.get(0).getProyecto_ff_rep().isEmpty()) {
                    cell = new PdfPCell(new Paragraph(resultproy.get(0).getProyecto_ff(), fuente3));
                } else {
                    cell = new PdfPCell(new Paragraph(resultproy.get(0).getProyecto_ff_rep(), fuente3));
                }
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                tablef.addCell(cell);
            } catch (Exception e) {
                cell = new PdfPCell(new Paragraph(resultproy.get(0).getProyecto_ff(), fuente3));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                tablef.addCell(cell);
            }
            cell = new PdfPCell(new Paragraph("RESPONSABLE:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getProyecto_responsable(), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setColspan(3);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("INTEGRANTES:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            if (resultproy.get(0).getProyecto_integrantes() == null || resultproy.get(0).getIntegrantes().isEmpty()) {
                cell = new PdfPCell(new Paragraph("No tiene integrantes.", fuente3));
            } else if (resultproy.get(0).getProyecto_integrantes() != null && !resultproy.get(0).getProyecto_integrantes().equals("null")) {
                cell = new PdfPCell(new Paragraph(resultproy.get(0).getProyecto_integrantes(), fuente3));
            } else {
                String integrantes = "";
                for (int j = 0; j < resultproy.get(0).getIntegrantes().size(); j++) {
                    integrantes += resultproy.get(0).getIntegrantes().get(j).getProyecto_integrantes() + ", ";
                }
                cell = new PdfPCell(new Paragraph(integrantes, fuente3));
            }
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setColspan(3);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("MULTIDISCIPLINARIO:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            if (resultproy.get(0).getProyecto_multi()) {
                cell = new PdfPCell(new Paragraph("SI", fuente3));
            } else {
                cell = new PdfPCell(new Paragraph("NO", fuente3));
            }
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setColspan(3);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("MONTO:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("$" + formateador.format(resultproy.get(0).getProyecto_monto()), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setColspan(3);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            tablef.addCell(cell);

            document.add(tablef);

            document.add(new Paragraph(" "));
            if (resultproy.get(0).getProyecto_anio() >= 2022) {
                Chunk parte3 = new Chunk("ARTICULACIÓN CON PLANES DE ASEGURAMIENTO DE LA CALIDAD Y DE MEJORAS INSTITUCIONALES", fuen);
                Paragraph para3 = new Paragraph();
                para3.add(parte3);
                para3.setAlignment(Element.ALIGN_CENTER);
                document.add(para3);
                document.add(new Paragraph(" "));
                PdfPTable tableCalidad = new PdfPTable(6);
                tableCalidad.setTotalWidth(new float[]{75, 100, 60, 100, 120, 65});
                tableCalidad.setLockedWidth(true);
                Font fuentetitulo = new Font(Font.FontFamily.TIMES_ROMAN, 7, 1, BaseColor.WHITE);

                cell = new PdfPCell(new Paragraph("COD. PLAN", fuentetitulo));
                cell.setPadding(5);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableCalidad.addCell(cell);

                cell = new PdfPCell(new Paragraph("PLAN", fuentetitulo));
                cell.setPadding(5);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableCalidad.addCell(cell);

                cell = new PdfPCell(new Paragraph("NUM. ACT", fuentetitulo));
                cell.setPadding(5);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableCalidad.addCell(cell);

                cell = new PdfPCell(new Paragraph("META", fuentetitulo));
                cell.setPadding(5);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableCalidad.addCell(cell);

                cell = new PdfPCell(new Paragraph("ACTIVIDAD", fuentetitulo));
                cell.setPadding(5);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableCalidad.addCell(cell);

                cell = new PdfPCell(new Paragraph("RESPONSABLE", fuentetitulo));
                cell.setPadding(5);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(azul);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableCalidad.addCell(cell);

                if (resultproy.get(0).getProceso().size() > 0) {
                    for (int i = 0; i < resultproy.get(0).getProceso().size(); i++) {
                        cell = new PdfPCell(new Paragraph(resultproy.get(0).getProceso().get(i).getProceso_codigo(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(5);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tableCalidad.addCell(cell);

                        cell = new PdfPCell(new Paragraph(resultproy.get(0).getProceso().get(i).getProceso_nombre(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(5);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tableCalidad.addCell(cell);

                        cell = new PdfPCell(new Paragraph(resultproy.get(0).getProceso().get(i).getAm_codigo(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(5);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tableCalidad.addCell(cell);

                        cell = new PdfPCell(new Paragraph(resultproy.get(0).getProceso().get(i).getAm_meta(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(5);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tableCalidad.addCell(cell);

                        cell = new PdfPCell(new Paragraph(resultproy.get(0).getProceso().get(i).getAm_nombre(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(5);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tableCalidad.addCell(cell);

                        cell = new PdfPCell(new Paragraph(resultproy.get(0).getProceso().get(i).getAm_responsable(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(5);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tableCalidad.addCell(cell);
                    }
                } else {
                    cell = new PdfPCell(new Paragraph("Sin articulación", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(5);
                    cell.setBorderWidth(1);
                    cell.setColspan(6);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tableCalidad.addCell(cell);
                }

                document.add(tableCalidad);

                document.add(new Paragraph(" "));
            } else {
                Chunk parte3 = new Chunk("ARTICULACIÓN CON PROCESOS DE ASEGURAMIENTO DE LA CALIDAD", fuen);
                Paragraph para3 = new Paragraph();
                para3.add(parte3);
                para3.setAlignment(Element.ALIGN_CENTER);
                document.add(para3);
                document.add(new Paragraph(" "));

                PdfPTable tableCalidad = new PdfPTable(2);
                tableCalidad.setTotalWidth(new float[]{110, 410});
                tableCalidad.setLockedWidth(true);
                int tcar = 0, tins = 0;
                for (int i = 0; i < resultproy.get(0).getProceso().size(); i++) {
                    if (resultproy.get(0).getProceso().get(i).getProceso_codigo().equals("AEC1617")) {
                        tcar++;
                    } else {
                        tins++;
                    }
                }

                cell = new PdfPCell(new Paragraph("ACCIONES DE MEJORA CARRERA:", fuente2));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setRowspan(tcar);
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                tableCalidad.addCell(cell);

                for (int i = 0; i < resultproy.get(0).getProceso().size(); i++) {
                    if (resultproy.get(0).getProceso().get(i).getProceso_codigo().equals("AEC1617")) {
                        cell = new PdfPCell(new Paragraph(resultproy.get(0).getProceso().get(i).getAm_nombre(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                        tableCalidad.addCell(cell);
                    }
                }

                cell = new PdfPCell(new Paragraph("ACCIONES DE MEJORA INSTITUCIONALES:", fuente2));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setRowspan(tins);
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                tableCalidad.addCell(cell);

                for (int i = 0; i < resultproy.get(0).getProceso().size(); i++) {
                    if (resultproy.get(0).getProceso().get(i).getProceso_codigo().equals("AI2016")) {
                        cell = new PdfPCell(new Paragraph(resultproy.get(0).getProceso().get(i).getAm_nombre(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                        tableCalidad.addCell(cell);
                    }
                }
                document.add(tableCalidad);
            }

            List<cComponenteMeta> componentes = new ArrayList<cComponenteMeta>();
            List<cComponenteMeta> metas = new ArrayList<cComponenteMeta>();
            List<cComponenteMeta> indicadores = new ArrayList<cComponenteMeta>();
            List<cActividadRequerimiento> actividades = new ArrayList<cActividadRequerimiento>();
            List<cActividadRequerimiento> requerimientos = new ArrayList<cActividadRequerimiento>();
            adComponenteMeta cComp = new adComponenteMeta();
            adActividadRequerimiento cAct = new adActividadRequerimiento();
            componentes = cComp.ListarComponentesRep(Integer.parseInt(request.getParameter("proyidpdf")));
            for (int j = 0; j < componentes.size(); j++) {
                metas = cComp.ListarMetasRep(componentes.get(j).getComponente_id());
                indicadores = cComp.ListarIndicadorRep(metas.get(0).getMeta_id());
                actividades = cAct.ListarActividadRep(componentes.get(j).getComponente_id(), 1);
                int num = j + 1;
                Font fuentetitulo = new Font(Font.FontFamily.TIMES_ROMAN, 8, 1, BaseColor.WHITE);
                Font fuentetexto = new Font(Font.FontFamily.TIMES_ROMAN, 7, 1, BaseColor.WHITE);
                document.add(new Paragraph(" "));
                Chunk parte4 = new Chunk("COMPONENTE " + num, fuen);
                Paragraph para4 = new Paragraph();
                para4.add(parte4);
                para4.setAlignment(Element.ALIGN_CENTER);
                document.add(para4);
                document.add(new Paragraph(" "));

                Chunk parte5 = new Chunk(componentes.get(j).getComponente_nombre(), fuen1);
                Paragraph para5 = new Paragraph();
                para5.add(parte5);
                para5.setAlignment(Element.ALIGN_LEFT);
                document.add(para5);

                Paragraph parameta = new Paragraph();
                Chunk parte1 = new Chunk("Meta:", fuente2);
                Chunk partemeta = new Chunk(metas.get(0).getMeta_nombre(), fuente3);
                parameta.add(parte1);
                parameta.add(partemeta);
                parameta.setAlignment(Element.ALIGN_JUSTIFIED);
                document.add(parameta);

                document.add(new Paragraph(" "));
                PdfPTable tableind = new PdfPTable(4);
                tableind.setTotalWidth(new float[]{130, 130, 130, 130});
                tableind.setLockedWidth(true);

                cell = new PdfPCell(new Paragraph("INDICADORES", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(5);
                cell.setColspan(4);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                tableind.addCell(cell);

                cell = new PdfPCell(new Paragraph("NOMBRE", fuentetexto));
                cell.setPadding(5);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableind.addCell(cell);

                cell = new PdfPCell(new Paragraph("DESCRIPCIÓN", fuentetexto));
                cell.setPadding(5);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableind.addCell(cell);

                cell = new PdfPCell(new Paragraph("TIPO", fuentetexto));
                cell.setPadding(5);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableind.addCell(cell);

                cell = new PdfPCell(new Paragraph("FÓRMULA", fuentetexto));
                cell.setPadding(5);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(azul);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableind.addCell(cell);

                for (int in = 0; in < indicadores.size(); in++) {
                    cell = new PdfPCell(new Paragraph(indicadores.get(in).getIndicador_nombre(), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(5);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    tableind.addCell(cell);

                    cell = new PdfPCell(new Paragraph(indicadores.get(in).getIndicador_descripcion(), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(5);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    tableind.addCell(cell);

                    cell = new PdfPCell(new Paragraph(indicadores.get(in).getIndicador_tipo(), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(5);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tableind.addCell(cell);

                    String formula;
                    if (indicadores.get(in).getIndicador_ejecutado() == null) {
                        formula = "No tiene formula";
                    } else {
                        formula = indicadores.get(in).getIndicador_ejecutado() + "/" + indicadores.get(in).getIndicador_planificado();
                    }
                    cell = new PdfPCell(new Paragraph(formula, fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(5);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    tableind.addCell(cell);
                }

                document.add(tableind);

                document.add(new Paragraph(" "));

                PdfPTable tableact = new PdfPTable(6);
                tableact.setTotalWidth(new float[]{136, 133, 40, 40, 40, 131});
                tableact.setLockedWidth(true);

                cell = new PdfPCell(new Paragraph("ACTIVIDADES", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(3);
                cell.setColspan(6);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                tableact.addCell(cell);

                cell = new PdfPCell(new Paragraph("NOMBRE", fuentetexto));
                cell.setPadding(3);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setRowspan(2);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableact.addCell(cell);

                cell = new PdfPCell(new Paragraph("RESPONSABLE", fuentetexto));
                cell.setPadding(3);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setRowspan(2);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableact.addCell(cell);

                cell = new PdfPCell(new Paragraph("CUATRIMESTRE", fuentetexto));
                cell.setPadding(3);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderWidthBottom(1);
                cell.setColspan(3);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableact.addCell(cell);

                cell = new PdfPCell(new Paragraph("MONTO", fuentetexto));
                cell.setPadding(3);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setRowspan(2);
                cell.setBorderColorRight(azul);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableact.addCell(cell);

                cell = new PdfPCell(new Paragraph("I (%)", fuentetexto));
                cell.setPadding(3);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableact.addCell(cell);

                cell = new PdfPCell(new Paragraph("II (%)", fuentetexto));
                cell.setPadding(3);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableact.addCell(cell);

                cell = new PdfPCell(new Paragraph("III (%)", fuentetexto));
                cell.setPadding(3);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableact.addCell(cell);
                double mact = 0;

                for (int in = 0; in < actividades.size(); in++) {
                    cell = new PdfPCell(new Paragraph(actividades.get(in).getActividad_nombre(), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    tableact.addCell(cell);

                    cell = new PdfPCell(new Paragraph(actividades.get(in).getActividad_responsable(), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    tableact.addCell(cell);

                    cell = new PdfPCell(new Paragraph(formateador.format(actividades.get(in).getCuatri().get(0).getC1()) + "%", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tableact.addCell(cell);

                    cell = new PdfPCell(new Paragraph(formateador.format(actividades.get(in).getCuatri().get(0).getC2()) + "%", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tableact.addCell(cell);

                    cell = new PdfPCell(new Paragraph(formateador.format(actividades.get(in).getCuatri().get(0).getC3()) + "%", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tableact.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$" + formateador.format(actividades.get(in).getActividad_monto()), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    tableact.addCell(cell);
                    mact += actividades.get(in).getActividad_monto();
                }
                cell = new PdfPCell(new Paragraph("TOTAL", fuentetexto));
                cell.setPadding(3);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setColspan(5);
                tableact.addCell(cell);

                cell = new PdfPCell(new Paragraph("$" + formateador.format(mact), fuentetexto));
                cell.setPadding(3);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(azul);
                cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                tableact.addCell(cell);

                document.add(tableact);

                document.add(new Paragraph(" "));

                requerimientos = cAct.ListarRequerimientoRep(componentes.get(j).getComponente_id());
                if (requerimientos.size() > 0) {
                    PdfPTable tablereq = new PdfPTable(9);
                    tablereq.setTotalWidth(new float[]{92, 92, 30, 30, 30, 55, 64, 63, 64});
                    tablereq.setLockedWidth(true);

                    cell = new PdfPCell(new Paragraph("REQUERIMIENTOS", fuentetitulo));
                    cell.setBackgroundColor(azul);
                    cell.setPadding(3);
                    cell.setColspan(10);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setBorderWidthBottom(1);
                    cell.setBorderColorBottom(BaseColor.WHITE);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("ACTIVIDAD", fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setRowspan(2);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("NOMBRE", fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setRowspan(2);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("CUATRIMESTRE", fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderWidthBottom(1);
                    cell.setColspan(3);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setBorderColorBottom(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("CANTIDAD", fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderWidthBottom(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setBorderColorBottom(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setRowspan(2);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("COSTO U", fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setRowspan(2);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("COSTO SIN IVA", fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setRowspan(2);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("COSTO TOTAL", fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(azul);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setRowspan(2);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("I (%)", fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("II (%)", fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("III (%)", fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablereq.addCell(cell);
                    double mreq = 0;

                    for (int in = 0; in < requerimientos.size(); in++) {
                        cell = new PdfPCell(new Paragraph(requerimientos.get(in).getActividad_nombre(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        if (requerimientos.get(in).getReq().size() > 0) {
                            cell.setRowspan(requerimientos.get(in).getReq().size());
                        }
                        cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                        tablereq.addCell(cell);
//
                        if (requerimientos.get(in).getReq().size() > 0) {
                            for (int req = 0; req < requerimientos.get(in).getReq().size(); req++) {
                                cell = new PdfPCell(new Paragraph(requerimientos.get(in).getReq().get(req).getReq_nombre(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                tablereq.addCell(cell);

                                double c1 = 0, c2 = 0, c3 = 0;
                                for (int cu = 0; cu < requerimientos.get(in).getReq().get(req).getCuatri().size(); cu++) {
                                    if (requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getMes_id() == 1 && requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getMes_id() != 2 && requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getMes_id() != 3) {
                                        c1 += requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getActividad_porcentaje();
                                    } else if (requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getMes_id() == 2 && requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getMes_id() != 1 && requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getMes_id() != 3) {
                                        c2 += requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getActividad_porcentaje();
                                    } else if (requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getMes_id() == 3 && requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getMes_id() != 1 && requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getMes_id() != 2) {
                                        c3 += requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getActividad_porcentaje();
                                    }
                                }

                                cell = new PdfPCell(new Paragraph(formateador.format(c1) + "%", fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablereq.addCell(cell);

                                cell = new PdfPCell(new Paragraph(formateador.format(c2) + "%", fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablereq.addCell(cell);

                                cell = new PdfPCell(new Paragraph(formateador.format(c3) + "%", fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablereq.addCell(cell);

                                cell = new PdfPCell(new Paragraph(requerimientos.get(in).getReq().get(req).getReq_cantidad().toString(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablereq.addCell(cell);

                                cell = new PdfPCell(new Paragraph("$" + formateador.format(requerimientos.get(in).getReq().get(req).getReq_costo_unitario()), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                                tablereq.addCell(cell);

                                cell = new PdfPCell(new Paragraph("$" + formateador.format(requerimientos.get(in).getReq().get(req).getReq_costo_sin_iva()), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                                tablereq.addCell(cell);

                                cell = new PdfPCell(new Paragraph("$" + formateador.format(requerimientos.get(in).getReq().get(req).getReq_costo_total()), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                                tablereq.addCell(cell);
                                mreq += requerimientos.get(in).getReq().get(req).getReq_costo_total();
                            }
                        } else {
                            cell = new PdfPCell(new Paragraph("No existe requerimientos.", fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setColspan(9);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                            tablereq.addCell(cell);
                        }
                    }
                    cell = new PdfPCell(new Paragraph("TOTAL", fuentetexto));
                    cell.setPadding(3);
                    cell.setColspan(8);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$" + formateador.format(mreq), fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(azul);
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    tablereq.addCell(cell);

                    document.add(tablereq);
                }
            }

        } catch (DocumentException de) {
            de.printStackTrace();
            System.err.println("document: " + de.getMessage());
            System.err.println("error: " + de.getMessage());
        }
// Paso: Cerramos el ‘document (el ‘outputstream’ se cierra automáticamente internamente)
        document.close();
    }

    private void reporteProyectoCompletoPlan(HttpServletRequest request, HttpServletResponse response) throws FileNotFoundException, IOException, DocumentException {
        Document document = new Document(PageSize.LETTER, 60, 45, 120, 50);
        //Document document = new Document(PageSize.LETTER, 60, 45, 140, 75);
        DecimalFormat formateador = new DecimalFormat("####,###,###.##");
        try {
            String path = getServletContext().getRealPath("/") + "img/reporte/";
            String pathimg = getServletContext().getRealPath("/") + "img/reporte/";
// Paso 2: Establecemos el ContentType y creamos una instancia del Writer
            response.setContentType("application/pdf");
            String titulo = request.getParameter("agnombrepdf");
            OutputStream file = new FileOutputStream(new File(path + "reporte_POA.pdf"));
            PdfWriter writer = PdfWriter.getInstance(document, response.getOutputStream());
            //PdfWriter writer2 = PdfWriter.getInstance(document, file);
            formatoReporteV eventos = new formatoReporteV(path, titulo, pathimg + "logo-plan.png");

            writer.setPageEvent(eventos);
            //writer2.setPageEvent(eventos);
// Paso 3
            document.open();
// Paso 4
            document.addTitle("Perfil del Proyecto");

            //Lista de presupuesto
            List<cProyecto> resultproy = new ArrayList<cProyecto>();
            adProyecto aComp = new adProyecto();
            resultproy = aComp.ListarProyectoCompleto(Integer.parseInt(request.getParameter("proyidpdf")));

            Font fuente = new Font();
            fuente.setSize(10);
            Font fuen = new Font(Font.FontFamily.TIMES_ROMAN, 12, 1);
            Font fuen1 = new Font(Font.FontFamily.TIMES_ROMAN, 11, Font.BOLD | Font.ITALIC);
            Font fuente1 = new Font(Font.FontFamily.TIMES_ROMAN, 11, 1);
            Font fuente2 = new Font(Font.FontFamily.TIMES_ROMAN, 9, 1);
            Font fuente3 = new Font(Font.FontFamily.TIMES_ROMAN, 8, 0);
            Font fuente3ne = new Font(Font.FontFamily.TIMES_ROMAN, 7, 1, BaseColor.BLACK);

            BaseColor azul = WebColors.getRGBColor("#133351");
            Chunk parteag = new Chunk(resultproy.get(0).getAg().getAg_nombre(), fuen);
            Paragraph paraag = new Paragraph();
            paraag.add(parteag);
            paraag.setAlignment(Element.ALIGN_CENTER);
            document.add(paraag);

            Chunk parte2 = new Chunk("PERFIL DEL PROYECTO", fuen);
            Paragraph para2 = new Paragraph();
            para2.add(parte2);
            para2.setAlignment(Element.ALIGN_CENTER);
            document.add(para2);
            document.add(new Paragraph(" "));

            PdfPTable tablef = new PdfPTable(4);
            tablef.setTotalWidth(new float[]{105, 155, 105, 155});
            tablef.setLockedWidth(true);
            PdfPCell cell;

            cell = new PdfPCell(new Paragraph("OBJETIVO ESTRATÈGICO:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getPer().getPerspectiva_nombre(), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            cell.setColspan(3);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("OBJETIVO OPERATIVO:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getPer().getObjetivo_nombre(), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            cell.setColspan(3);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("ACTIVIDAD PRESUPUESTARIA:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getPer().getAp_nombre(), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            cell.setColspan(3);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("NOMBRE:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getProyecto_nombre(), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            cell.setColspan(3);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("FIN DEL PROYECTO:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getProyecto_fin(), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            cell.setColspan(3);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("PROPÒSITO:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getProyecto_proposito(), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            cell.setColspan(3);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("FECHA INICIO:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getProyecto_fi(), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("FECHA FIN:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getProyecto_ff(), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("RESPONSABLE:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getProyecto_responsable(), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setColspan(3);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("INTEGRANTES:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            if (resultproy.get(0).getProyecto_integrantes() == null) {
                cell = new PdfPCell(new Paragraph("No tiene integrantes.", fuente3));
            } else {
                cell = new PdfPCell(new Paragraph(resultproy.get(0).getProyecto_integrantes(), fuente3));
            }
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setColspan(3);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("MULTIDISCIPLINARIO:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            if (resultproy.get(0).getProyecto_multi()) {
                cell = new PdfPCell(new Paragraph("SI", fuente3));
            } else {
                cell = new PdfPCell(new Paragraph("NO", fuente3));
            }
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setColspan(3);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("MONTO:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("$" + formateador.format(resultproy.get(0).getProyecto_monto()), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setColspan(3);
            cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
            tablef.addCell(cell);

            document.add(tablef);

            document.add(new Paragraph(" "));
            Chunk parte3 = new Chunk("ARTICULACIÓN CON PROCESOS DE ASEGURAMIENTO DE LA CALIDAD", fuen);
            Paragraph para3 = new Paragraph();
            para3.add(parte3);
            para3.setAlignment(Element.ALIGN_CENTER);
            document.add(para3);
            document.add(new Paragraph(" "));

            PdfPTable tableCalidad = new PdfPTable(2);
            tableCalidad.setTotalWidth(new float[]{110, 410});
            tableCalidad.setLockedWidth(true);
            int tcar = 0, tins = 0;
            for (int i = 0; i < resultproy.get(0).getProceso().size(); i++) {
                if (resultproy.get(0).getProceso().get(i).getProceso_codigo().equals("AEC1617")) {
                    tcar++;
                } else {
                    tins++;
                }
            }

            cell = new PdfPCell(new Paragraph("ACCIONES DE MEJORA CARRERA:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setRowspan(tcar);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setVerticalAlignment(Element.ALIGN_CENTER);
            tableCalidad.addCell(cell);

            for (int i = 0; i < resultproy.get(0).getProceso().size(); i++) {
                if (resultproy.get(0).getProceso().get(i).getProceso_codigo().equals("AEC1617")) {
                    cell = new PdfPCell(new Paragraph(resultproy.get(0).getProceso().get(i).getAm_nombre(), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(5);
                    cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                    tableCalidad.addCell(cell);
                }
            }

            cell = new PdfPCell(new Paragraph("ACCIONES DE MEJORA INSTITUCIONALES:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setRowspan(tins);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tableCalidad.addCell(cell);

            for (int i = 0; i < resultproy.get(0).getProceso().size(); i++) {
                if (resultproy.get(0).getProceso().get(i).getProceso_codigo().equals("AI2016")) {
                    cell = new PdfPCell(new Paragraph(resultproy.get(0).getProceso().get(i).getAm_nombre(), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(5);
                    cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                    tableCalidad.addCell(cell);
                }
            }

            document.add(tableCalidad);

            List<cComponenteMeta> componentes = new ArrayList<cComponenteMeta>();
            List<cComponenteMeta> metas = new ArrayList<cComponenteMeta>();
            List<cComponenteMeta> indicadores = new ArrayList<cComponenteMeta>();
            List<cActividadRequerimiento> actividades = new ArrayList<cActividadRequerimiento>();
            List<cActividadRequerimiento> requerimientos = new ArrayList<cActividadRequerimiento>();
            adComponenteMeta cComp = new adComponenteMeta();
            adActividadRequerimiento cAct = new adActividadRequerimiento();
            componentes = cComp.ListarComponentes(Integer.parseInt(request.getParameter("proyidpdf")));
            for (int j = 0; j < componentes.size(); j++) {
                metas = cComp.ListarMetas(componentes.get(j).getComponente_id());
                indicadores = cComp.ListarIndicador(metas.get(0).getMeta_id());
                actividades = cAct.ListarActividad(componentes.get(j).getComponente_id());
                int num = j + 1;
                Font fuentetitulo = new Font(Font.FontFamily.TIMES_ROMAN, 8, 1, BaseColor.WHITE);
                Font fuentetexto = new Font(Font.FontFamily.TIMES_ROMAN, 7, 1, BaseColor.WHITE);
                document.add(new Paragraph(" "));
                Chunk parte4 = new Chunk("COMPONENTE " + num, fuen);
                Paragraph para4 = new Paragraph();
                para4.add(parte4);
                para4.setAlignment(Element.ALIGN_CENTER);
                document.add(para4);
                document.add(new Paragraph(" "));

                Chunk parte5 = new Chunk(componentes.get(j).getComponente_nombre(), fuen1);
                Paragraph para5 = new Paragraph();
                para5.add(parte5);
                para5.setAlignment(Element.ALIGN_LEFT);
                document.add(para5);

                Paragraph parameta = new Paragraph();
                Chunk parte1 = new Chunk("Meta:", fuente2);
                Chunk partemeta = new Chunk(metas.get(0).getMeta_nombre(), fuente3);
                parameta.add(parte1);
                parameta.add(partemeta);
                parameta.setAlignment(Element.ALIGN_JUSTIFIED);
                document.add(parameta);

                document.add(new Paragraph(" "));
                PdfPTable tableind = new PdfPTable(4);
                tableind.setTotalWidth(new float[]{130, 130, 130, 130});
                tableind.setLockedWidth(true);

                cell = new PdfPCell(new Paragraph("INDICADORES", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(5);
                cell.setColspan(4);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                tableind.addCell(cell);

                cell = new PdfPCell(new Paragraph("NOMBRE", fuentetexto));
                cell.setPadding(5);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableind.addCell(cell);

                cell = new PdfPCell(new Paragraph("DESCRIPCIÓN", fuentetexto));
                cell.setPadding(5);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableind.addCell(cell);

                cell = new PdfPCell(new Paragraph("TIPO", fuentetexto));
                cell.setPadding(5);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableind.addCell(cell);

                cell = new PdfPCell(new Paragraph("FÓRMULA", fuentetexto));
                cell.setPadding(5);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(azul);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableind.addCell(cell);

                for (int in = 0; in < indicadores.size(); in++) {
                    cell = new PdfPCell(new Paragraph(indicadores.get(in).getIndicador_nombre(), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(5);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    tableind.addCell(cell);

                    cell = new PdfPCell(new Paragraph(indicadores.get(in).getIndicador_descripcion(), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(5);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    tableind.addCell(cell);

                    cell = new PdfPCell(new Paragraph(indicadores.get(in).getIndicador_tipo(), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(5);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tableind.addCell(cell);

                    String formula;
                    if (indicadores.get(in).getIndicador_ejecutado() == null) {
                        formula = "No tiene formula";
                    } else {
                        formula = indicadores.get(in).getIndicador_ejecutado() + "/" + indicadores.get(in).getIndicador_planificado();
                    }
                    cell = new PdfPCell(new Paragraph(formula, fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(5);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    tableind.addCell(cell);
                }

                document.add(tableind);

                document.add(new Paragraph(" "));

                PdfPTable tableact = new PdfPTable(6);
                tableact.setTotalWidth(new float[]{136, 133, 40, 40, 40, 131});
                tableact.setLockedWidth(true);

                cell = new PdfPCell(new Paragraph("ACTIVIDADES", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(3);
                cell.setColspan(6);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                tableact.addCell(cell);

                cell = new PdfPCell(new Paragraph("NOMBRE", fuentetexto));
                cell.setPadding(3);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setRowspan(2);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableact.addCell(cell);

                cell = new PdfPCell(new Paragraph("RESPONSABLE", fuentetexto));
                cell.setPadding(3);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setRowspan(2);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableact.addCell(cell);

                cell = new PdfPCell(new Paragraph("CUATRIMESTRE", fuentetexto));
                cell.setPadding(3);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderWidthBottom(1);
                cell.setColspan(3);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableact.addCell(cell);

                cell = new PdfPCell(new Paragraph("MONTO", fuentetexto));
                cell.setPadding(3);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setRowspan(2);
                cell.setBorderColorRight(azul);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableact.addCell(cell);

                cell = new PdfPCell(new Paragraph("I (%)", fuentetexto));
                cell.setPadding(3);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableact.addCell(cell);

                cell = new PdfPCell(new Paragraph("II (%)", fuentetexto));
                cell.setPadding(3);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableact.addCell(cell);

                cell = new PdfPCell(new Paragraph("III (%)", fuentetexto));
                cell.setPadding(3);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tableact.addCell(cell);
                double mact = 0;

                for (int in = 0; in < actividades.size(); in++) {
                    cell = new PdfPCell(new Paragraph(actividades.get(in).getActividad_nombre(), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    tableact.addCell(cell);

                    cell = new PdfPCell(new Paragraph(actividades.get(in).getActividad_responsable(), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    tableact.addCell(cell);

                    cell = new PdfPCell(new Paragraph(formateador.format(actividades.get(in).getCuatri().get(0).getC1()) + "%", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tableact.addCell(cell);

                    cell = new PdfPCell(new Paragraph(formateador.format(actividades.get(in).getCuatri().get(0).getC2()) + "%", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tableact.addCell(cell);

                    cell = new PdfPCell(new Paragraph(formateador.format(actividades.get(in).getCuatri().get(0).getC3()) + "%", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tableact.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$" + formateador.format(actividades.get(in).getActividad_monto()), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    tableact.addCell(cell);
                    mact += actividades.get(in).getActividad_monto();
                }
                cell = new PdfPCell(new Paragraph("TOTAL", fuentetexto));
                cell.setPadding(3);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setColspan(5);
                tableact.addCell(cell);

                cell = new PdfPCell(new Paragraph("$" + formateador.format(mact), fuentetexto));
                cell.setPadding(3);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(azul);
                cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                tableact.addCell(cell);

                document.add(tableact);

                document.add(new Paragraph(" "));

                requerimientos = cAct.ListarRequerimiento(componentes.get(j).getComponente_id());
                if (requerimientos.size() > 0) {
                    PdfPTable tablereq = new PdfPTable(9);
                    tablereq.setTotalWidth(new float[]{92, 92, 30, 30, 30, 55, 64, 63, 64});
                    tablereq.setLockedWidth(true);

                    cell = new PdfPCell(new Paragraph("REQUERIMIENTOS", fuentetitulo));
                    cell.setBackgroundColor(azul);
                    cell.setPadding(3);
                    cell.setColspan(10);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setBorderWidthBottom(1);
                    cell.setBorderColorBottom(BaseColor.WHITE);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("ACTIVIDAD", fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setRowspan(2);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("NOMBRE", fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setRowspan(2);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("CUATRIMESTRE", fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderWidthBottom(1);
                    cell.setColspan(3);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setBorderColorBottom(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("CANTIDAD", fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderWidthBottom(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setBorderColorBottom(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setRowspan(2);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("COSTO U", fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setRowspan(2);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("COSTO SIN IVA", fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setRowspan(2);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("COSTO TOTAL", fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(azul);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setRowspan(2);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("I (%)", fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("II (%)", fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("III (%)", fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablereq.addCell(cell);
                    double mreq = 0;

                    for (int in = 0; in < requerimientos.size(); in++) {
                        cell = new PdfPCell(new Paragraph(requerimientos.get(in).getActividad_nombre(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setBorderWidth(1);
                        if (requerimientos.get(in).getReq().size() > 0) {
                            cell.setRowspan(requerimientos.get(in).getReq().size());
                        }
                        cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                        tablereq.addCell(cell);
//
                        if (requerimientos.get(in).getReq().size() > 0) {
                            for (int req = 0; req < requerimientos.get(in).getReq().size(); req++) {
                                cell = new PdfPCell(new Paragraph(requerimientos.get(in).getReq().get(req).getReq_nombre(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                tablereq.addCell(cell);

                                double c1 = 0, c2 = 0, c3 = 0;
                                for (int cu = 0; cu < requerimientos.get(in).getReq().get(req).getCuatri().size(); cu++) {
                                    if (requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getMes_id() == 1 && requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getMes_id() != 2 && requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getMes_id() != 3) {
                                        c1 += requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getActividad_porcentaje();
                                    } else if (requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getMes_id() == 2 && requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getMes_id() != 1 && requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getMes_id() != 3) {
                                        c2 += requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getActividad_porcentaje();
                                    } else if (requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getMes_id() == 3 && requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getMes_id() != 1 && requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getMes_id() != 2) {
                                        c3 += requerimientos.get(in).getReq().get(req).getCuatri().get(cu).getActividad_porcentaje();
                                    }
                                }

                                cell = new PdfPCell(new Paragraph(formateador.format(c1) + "%", fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablereq.addCell(cell);

                                cell = new PdfPCell(new Paragraph(formateador.format(c2) + "%", fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablereq.addCell(cell);

                                cell = new PdfPCell(new Paragraph(formateador.format(c3) + "%", fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablereq.addCell(cell);

                                cell = new PdfPCell(new Paragraph(requerimientos.get(in).getReq().get(req).getReq_cantidad().toString(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablereq.addCell(cell);

                                cell = new PdfPCell(new Paragraph("$" + formateador.format(requerimientos.get(in).getReq().get(req).getReq_costo_unitario()), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                                tablereq.addCell(cell);

                                cell = new PdfPCell(new Paragraph("$" + formateador.format(requerimientos.get(in).getReq().get(req).getReq_costo_sin_iva()), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                                tablereq.addCell(cell);

                                cell = new PdfPCell(new Paragraph("$" + formateador.format(requerimientos.get(in).getReq().get(req).getReq_costo_total()), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                                tablereq.addCell(cell);
                                mreq += requerimientos.get(in).getReq().get(req).getReq_costo_total();
                            }
                        } else {
                            cell = new PdfPCell(new Paragraph("No existe requerimientos.", fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setColspan(9);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                            tablereq.addCell(cell);
                        }
                    }
                    cell = new PdfPCell(new Paragraph("TOTAL", fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setColspan(8);
                    tablereq.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$" + formateador.format(mreq), fuentetexto));
                    cell.setPadding(3);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(azul);
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    tablereq.addCell(cell);

                    document.add(tablereq);
                }
            }

        } catch (DocumentException de) {
            de.printStackTrace();
            System.err.println("document: " + de.getMessage());
            System.err.println("error: " + de.getMessage());
        }
// Paso: Cerramos el ‘document (el ‘outputstream’ se cierra automáticamente internamente)
        document.close();
    }

    private void reportePOA(HttpServletRequest request, HttpServletResponse response) throws FileNotFoundException, IOException, DocumentException {
        //Document document = new Document(PageSize.LETTER, 25, 25, 140, 50);
        Document document = new Document(PageSize.LETTER.rotate(), 39, 36, 132, 67);
        DecimalFormat formateador = new DecimalFormat("####,###,##0.00");
        try {
            String path = getServletContext().getRealPath("/") + "img/reporte/";
            String pathimg = getServletContext().getRealPath("/") + "img/reporte/";
// Paso 2: Establecemos el ContentType y creamos una instancia del Writer
            response.setContentType("application/pdf");
            String ag = request.getParameter("agidpoa");
            String titu = request.getParameter("agtitulopoa");
            String alias = request.getParameter("agaliaspoa");
            String anio = request.getParameter("anioreporte");
            String titulo = "POA " + anio + " - " + titu;
            OutputStream file = new FileOutputStream(new File(path + "POA" + anio + "-" + alias + ".pdf"));
            PdfWriter writer = PdfWriter.getInstance(document, response.getOutputStream());
            //PdfWriter writer2 = PdfWriter.getInstance(document, file);
            formatoReporteH eventos = new formatoReporteH(path, titulo, pathimg + "LOGO-PEDI.gif");

            writer.setPageEvent(eventos);
            //writer2.setPageEvent(eventos);
// Paso 3
            document.open();
// Paso 4
            document.addTitle("POA " + anio + " " + alias);

            Date date = Calendar.getInstance().getTime();
            DateFormat formatter = new SimpleDateFormat("dd/MM/yyyy, hh:mm:ss a");
            String today = formatter.format(date);

            //Lista de presupuesto
            List<cAreaGestion> resultareas = new ArrayList<cAreaGestion>();
            List<cAreaGestion> resultareashijos = new ArrayList<cAreaGestion>();
            List<cProyecto> resultproyectos = new ArrayList<cProyecto>();
            List<cProyecto> resultdeudas = new ArrayList<cProyecto>();
            adAreaGestion accAg = new adAreaGestion();
            adProyecto aComp = new adProyecto();
            resultareas = accAg.obtenerAreasGestionHijas(Integer.parseInt(ag));

            Font fuente = new Font();
            fuente.setSize(10);
            Font fuen = new Font(Font.FontFamily.TIMES_ROMAN, 14, 1);
            Font fuent = new Font(Font.FontFamily.TIMES_ROMAN, 12, 1);
            Font fuente3 = new Font(Font.FontFamily.TIMES_ROMAN, 7, 0, BaseColor.BLACK);
            Font fuentetitulo = new Font(Font.FontFamily.TIMES_ROMAN, 8, 1, BaseColor.WHITE);
            Font fuentetexto = new Font(Font.FontFamily.TIMES_ROMAN, 7, 1, BaseColor.WHITE);

            BaseColor azul = WebColors.getRGBColor("#133351");

            for (int i = 0; i < resultareas.size(); i++) {
                resultproyectos = aComp.ListaProyectoPOA(resultareas.get(i).getAg_id(), Integer.parseInt(anio));
                if (aComp.ExisteProyectos(resultareas.get(i).getAg_id(), Integer.parseInt(anio))) {
                    double totalfacultad = 0;
                    Chunk parte2 = new Chunk("Unidad Académica/Administrativa: " + resultareas.get(i).getAg_nombre(), fuen);
                    Paragraph para2 = new Paragraph();
                    para2.add(parte2);
                    para2.setAlignment(Element.ALIGN_CENTER);
                    document.add(para2);
                    document.add(new Paragraph(" "));

                    PdfPTable tablef = new PdfPTable(8);
                    tablef.setTotalWidth(new float[]{70, 230, 70, 40, 40, 40, 120, 90});
                    tablef.setLockedWidth(true);
                    PdfPCell cell;

                    cell = new PdfPCell(new Paragraph(resultareas.get(i).getAg_nombre(), fuentetitulo));
                    cell.setBackgroundColor(azul);
                    cell.setPadding(5);
                    cell.setColspan(8);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setBorderWidthBottom(1);
                    cell.setBorderColorBottom(BaseColor.WHITE);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("Código", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setRowspan(2);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("Proyecto", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setRowspan(2);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("Tipo Proyecto", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setRowspan(2);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("Programación", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderWidthBottom(1);
                    cell.setColspan(3);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setBorderColorBottom(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("Responsable", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setRowspan(2);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("Monto prespuestado '" + anio + "'", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(azul);
                    cell.setRowspan(2);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("I (%)", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("II (%)", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("III (%)", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    double totalf = 0;
                    for (int j = 0; j < resultproyectos.size(); j++) {
                        cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_codigo(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_nombre(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getTp_nombre(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getCuatri().get(0).getC1() / aComp.numActividadesProy(resultproyectos.get(j).getProyecto_id())) + "%", fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getCuatri().get(0).getC2() / aComp.numActividadesProy(resultproyectos.get(j).getProyecto_id())) + "%", fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getCuatri().get(0).getC3() / aComp.numActividadesProy(resultproyectos.get(j).getProyecto_id())) + "%", fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_responsable(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                        tablef.addCell(cell);

                        Double mpluri = 0.0;
                        if (resultproyectos.get(j).getProyecto_plurianual() == 1) {
                            mpluri = aComp.montoproyectoPluri(resultareas.get(i).getAg_id(), resultproyectos.get(j).getProyecto_id(), Integer.parseInt(anio));
                        } else {
                            mpluri = resultproyectos.get(j).getProyecto_monto();
                        }
                        cell = new PdfPCell(new Paragraph("$" + formateador.format(mpluri), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                        tablef.addCell(cell);
                        totalf += mpluri;
                        totalfacultad += mpluri;
                    }
                    cell = new PdfPCell(new Paragraph("TOTAL", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setColspan(7);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$" + formateador.format(totalf), fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(azul);
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    tablef.addCell(cell);
                    document.add(tablef);

                    if (resultareas.get(i).getTag_id() == 4) {
                        double totaldeuda = 0;
                        resultdeudas = aComp.ListarDeudasAprobadas(resultareas.get(i).getAg_id(), Integer.parseInt(anio));
                        if (resultdeudas.size() > 0) {
                            document.add(new Paragraph(" "));
                            PdfPTable tableDe = new PdfPTable(4);
                            tableDe.setTotalWidth(new float[]{100, 200, 200, 200});
                            tableDe.setLockedWidth(true);

                            cell = new PdfPCell(new Paragraph("VALORES PENDIENTES DE PAGO AÑOS ANTERIORES -" + resultareas.get(i).getAg_alias(), fuentetexto));
                            cell.setPadding(5);
                            cell.setColspan(4);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setBorderWidthBottom(1);
                            cell.setBorderColorBottom(BaseColor.WHITE);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph("OEI", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph("Nombre Proyecto", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph("Nombre Proceso", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph("Total", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderWidthBottom(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setBorderColorBottom(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tableDe.addCell(cell);

                            for (int rd = 0; rd < resultdeudas.size(); rd++) {
                                cell = new PdfPCell(new Paragraph("OEI-0" + resultdeudas.get(rd).getDeudas_oei(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph(resultdeudas.get(rd).getProyecto_nombre(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph(resultdeudas.get(rd).getDeudas_proceso(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph("$" + formateador.format(resultdeudas.get(rd).getDeuda_monto_contrato() + resultdeudas.get(rd).getDeuda_monto_iva() + resultdeudas.get(rd).getDeudas_anticipo()), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                                tableDe.addCell(cell);
                                totaldeuda += resultdeudas.get(rd).getDeuda_monto_contrato() + resultdeudas.get(rd).getDeuda_monto_iva() + resultdeudas.get(rd).getDeudas_anticipo();
                                totalfacultad += resultdeudas.get(rd).getDeuda_monto_contrato() + resultdeudas.get(rd).getDeuda_monto_iva() + resultdeudas.get(rd).getDeudas_anticipo();
                            }
                            cell = new PdfPCell(new Paragraph("TOTAL", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setColspan(3);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph("$" + formateador.format(totaldeuda), fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(azul);
                            cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                            tableDe.addCell(cell);
                            document.add(tableDe);
//
//                        if (k < (resultareashijos.size() - 1)) {
//                            document.add(new Paragraph(" "));
//                        }
                        }
                    }

                    resultareashijos = accAg.obtenerAreasGestionHijas(resultareas.get(i).getAg_id());
                    if (resultareashijos.size() > 1) {
                        document.add(new Paragraph(" "));
                    }
                    for (int k = 0; k < resultareashijos.size(); k++) {
                        document.add(new Paragraph(" "));
                        PdfPTable tablefh = new PdfPTable(8);
                        tablefh.setTotalWidth(new float[]{70, 230, 70, 40, 40, 40, 120, 90});
                        tablefh.setLockedWidth(true);

                        cell = new PdfPCell(new Paragraph(resultareashijos.get(k).getAg_nombre(), fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setColspan(8);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthBottom(1);
                        cell.setBorderColorBottom(BaseColor.WHITE);
                        tablefh.addCell(cell);

                        cell = new PdfPCell(new Paragraph("Código", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setRowspan(2);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablefh.addCell(cell);

                        cell = new PdfPCell(new Paragraph("Proyecto", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setRowspan(2);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablefh.addCell(cell);

                        cell = new PdfPCell(new Paragraph("Tipo Proyecto", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setRowspan(2);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablefh.addCell(cell);

                        cell = new PdfPCell(new Paragraph("Programación", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderWidthBottom(1);
                        cell.setColspan(3);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setBorderColorBottom(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablefh.addCell(cell);

                        cell = new PdfPCell(new Paragraph("Responsable", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setRowspan(2);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablefh.addCell(cell);

                        cell = new PdfPCell(new Paragraph("Monto", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(azul);
                        cell.setRowspan(2);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablefh.addCell(cell);

                        cell = new PdfPCell(new Paragraph("I (%)", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablefh.addCell(cell);

                        cell = new PdfPCell(new Paragraph("II (%)", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablefh.addCell(cell);

                        cell = new PdfPCell(new Paragraph("III (%)", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablefh.addCell(cell);

                        double totalfh = 0;
                        resultproyectos = aComp.ListaProyectoPOA(resultareashijos.get(k).getAg_id(), Integer.parseInt(anio));
                        for (int j = 0; j < resultproyectos.size(); j++) {
                            cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_codigo(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablefh.addCell(cell);

                            cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_nombre(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                            tablefh.addCell(cell);

                            cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getTp_nombre(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablefh.addCell(cell);

                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getCuatri().get(0).getC1() / aComp.numActividadesProy(resultproyectos.get(j).getProyecto_id())) + "%", fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablefh.addCell(cell);

                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getCuatri().get(0).getC2() / aComp.numActividadesProy(resultproyectos.get(j).getProyecto_id())) + "%", fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablefh.addCell(cell);

                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getCuatri().get(0).getC3() / aComp.numActividadesProy(resultproyectos.get(j).getProyecto_id())) + "%", fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablefh.addCell(cell);

                            cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_responsable(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                            tablefh.addCell(cell);

                            cell = new PdfPCell(new Paragraph("$" + formateador.format(resultproyectos.get(j).getProyecto_monto()), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                            tablefh.addCell(cell);
                            totalfh += resultproyectos.get(j).getProyecto_monto();
                            totalfacultad += resultproyectos.get(j).getProyecto_monto();
                        }
                        cell = new PdfPCell(new Paragraph("TOTAL", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setColspan(7);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                        tablefh.addCell(cell);

                        cell = new PdfPCell(new Paragraph("$" + formateador.format(totalfh), fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(azul);
                        cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                        tablefh.addCell(cell);
                        document.add(tablefh);

                        if (k < (resultareashijos.size() - 1)) {
                            document.add(new Paragraph(" "));
                        }

                        if (resultareas.get(i).getTag_id() == 4) {
                            double totaldeuda = 0;
                            resultdeudas = aComp.ListarDeudasAprobadas(resultareashijos.get(k).getAg_id(), Integer.parseInt(anio));
                            if (resultdeudas.size() > 0) {
                                document.add(new Paragraph(" "));
                                PdfPTable tableDe = new PdfPTable(4);
                                tableDe.setTotalWidth(new float[]{100, 200, 200, 200});
                                tableDe.setLockedWidth(true);

                                cell = new PdfPCell(new Paragraph("VALORES PENDIENTES DE PAGO AÑOS ANTERIORES -" + resultareashijos.get(k).getAg_alias(), fuentetexto));
                                cell.setPadding(5);
                                cell.setColspan(4);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setBorderWidthBottom(1);
                                cell.setBorderColorBottom(BaseColor.WHITE);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph("OEI", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph("Nombre Proyecto", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph("Nombre Proceso", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph("Total", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderWidthBottom(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setBorderColorBottom(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tableDe.addCell(cell);

                                for (int rd = 0; rd < resultdeudas.size(); rd++) {
                                    cell = new PdfPCell(new Paragraph("OEI-0" + resultdeudas.get(rd).getDeudas_oei(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tableDe.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(resultdeudas.get(rd).getProyecto_nombre(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                    tableDe.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(resultdeudas.get(rd).getDeudas_proceso(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tableDe.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("$" + formateador.format(resultdeudas.get(rd).getDeuda_monto_contrato() + resultdeudas.get(rd).getDeuda_monto_iva() + resultdeudas.get(rd).getDeudas_anticipo()), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                                    tableDe.addCell(cell);
                                    totaldeuda += resultdeudas.get(rd).getDeuda_monto_contrato() + resultdeudas.get(rd).getDeuda_monto_iva() + resultdeudas.get(rd).getDeudas_anticipo();
                                    totalfacultad += resultdeudas.get(rd).getDeuda_monto_contrato() + resultdeudas.get(rd).getDeuda_monto_iva() + resultdeudas.get(rd).getDeudas_anticipo();
                                }
                                cell = new PdfPCell(new Paragraph("TOTAL", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setColspan(3);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph("$" + formateador.format(totaldeuda), fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(azul);
                                cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                                tableDe.addCell(cell);
                                document.add(tableDe);
//
//                        if (k < (resultareashijos.size() - 1)) {
//                            document.add(new Paragraph(" "));
//                        }
                            }
                        }
                    }

                    double totaldeuda = 0;
                    if (resultareas.get(i).getTag_id() != 4) {
                        resultdeudas = aComp.ListarDeudasAprobadas(resultareas.get(i).getAg_id(), Integer.parseInt(anio));
                        if (resultdeudas.size() > 0) {
                            document.add(new Paragraph(" "));
                            PdfPTable tableDe = new PdfPTable(4);
                            tableDe.setTotalWidth(new float[]{100, 200, 200, 200});
                            tableDe.setLockedWidth(true);

                            cell = new PdfPCell(new Paragraph("VALORES PENDIENTES DE PAGO AÑOS ANTERIORES -" + resultareas.get(i).getAg_alias(), fuentetexto));
                            cell.setPadding(5);
                            cell.setColspan(4);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setBorderWidthBottom(1);
                            cell.setBorderColorBottom(BaseColor.WHITE);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph("OEI", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph("Nombre Proyecto", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph("Nombre Proceso", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph("Total", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderWidthBottom(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setBorderColorBottom(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tableDe.addCell(cell);

                            for (int rd = 0; rd < resultdeudas.size(); rd++) {
                                cell = new PdfPCell(new Paragraph("OEI-0" + resultdeudas.get(rd).getDeudas_oei(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph(resultdeudas.get(rd).getProyecto_nombre(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph(resultdeudas.get(rd).getDeudas_proceso(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph("$" + formateador.format(resultdeudas.get(rd).getDeuda_monto_contrato() + resultdeudas.get(rd).getDeuda_monto_iva() + resultdeudas.get(rd).getDeudas_anticipo()), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                                tableDe.addCell(cell);
                                totaldeuda += resultdeudas.get(rd).getDeuda_monto_contrato() + resultdeudas.get(rd).getDeuda_monto_iva() + resultdeudas.get(rd).getDeudas_anticipo();
                                totalfacultad += resultdeudas.get(rd).getDeuda_monto_contrato() + resultdeudas.get(rd).getDeuda_monto_iva() + resultdeudas.get(rd).getDeudas_anticipo();
                            }
                            cell = new PdfPCell(new Paragraph("TOTAL", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setColspan(3);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph("$" + formateador.format(totaldeuda), fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(azul);
                            cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                            tableDe.addCell(cell);
                            document.add(tableDe);
//
//                        if (k < (resultareashijos.size() - 1)) {
//                            document.add(new Paragraph(" "));
//                        }
                        }
                    }
                    BaseColor azulbajo = WebColors.getRGBColor("#819595");

                    PdfPTable tabletotal = new PdfPTable(2);
                    tabletotal.setTotalWidth(new float[]{610, 90});
                    tabletotal.setLockedWidth(true);

                    cell = new PdfPCell(new Paragraph("Total POA " + resultareas.get(i).getAg_nombre() + " :", fuent));
                    cell.setBackgroundColor(azulbajo);
                    cell.setPadding(5);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setBorderWidthBottom(1);
                    cell.setBorderColorBottom(BaseColor.WHITE);
                    tabletotal.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(totalfacultad), fuent));
                    cell.setBackgroundColor(azulbajo);
                    cell.setPadding(5);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setBorderWidthBottom(1);
                    cell.setBorderColorBottom(BaseColor.WHITE);
                    tabletotal.addCell(cell);
                    document.add(tabletotal);

//                    Chunk parte3 = new Chunk("Total POA " + resultareas.get(i).getAg_nombre() + " : $ " + formateador.format(totalfacultad), fuent);
//                    Paragraph para3 = new Paragraph();
//                    para3.add(parte3);
//                    para3.setAlignment(Element.ALIGN_CENTER);
//                    document.add(para3);
                    document.add(new Paragraph(" "));
                }
            }
        } catch (DocumentException de) {
            de.printStackTrace();
            System.err.println("document: " + de.getMessage());
            System.err.println("error: " + de.getMessage());
        }
// Paso: Cerramos el ‘document (el ‘outputstream’ se cierra automáticamente internamente)
        document.close();
    }

    private void reportePOA20(HttpServletRequest request, HttpServletResponse response) throws FileNotFoundException, IOException, DocumentException {
        //Document document = new Document(PageSize.LETTER, 25, 25, 140, 50);
        Document document = new Document(PageSize.LETTER.rotate(), 39, 36, 132, 67);
        DecimalFormat formateador = new DecimalFormat("####,###,##0.00");
        try {
            String path = getServletContext().getRealPath("/") + "img/reporte/";
            String pathimg = getServletContext().getRealPath("/") + "img/reporte/";
// Paso 2: Establecemos el ContentType y creamos una instancia del Writer
            response.setContentType("application/pdf");
            String ag = request.getParameter("agidpoa");
            String titu = request.getParameter("agtitulopoa");
            String alias = request.getParameter("agaliaspoa");
            String titulo = "POA 2020 - " + titu;
            OutputStream file = new FileOutputStream(new File(path + "POA2020-" + alias + ".pdf"));
            PdfWriter writer = PdfWriter.getInstance(document, response.getOutputStream());
            //PdfWriter writer2 = PdfWriter.getInstance(document, file);
            formatoReporteH eventos = new formatoReporteH(path, titulo, pathimg + "LOGO-PEDI.gif");

            writer.setPageEvent(eventos);
            //writer2.setPageEvent(eventos);
// Paso 3
            document.open();
// Paso 4
            document.addTitle("POA 2020 " + alias);

            Date date = Calendar.getInstance().getTime();
            DateFormat formatter = new SimpleDateFormat("dd/MM/yyyy, hh:mm:ss a");
            String today = formatter.format(date);

            //Lista de presupuesto
            List<cAreaGestion> resultareas = new ArrayList<cAreaGestion>();
            List<cAreaGestion> resultareashijos = new ArrayList<cAreaGestion>();
            List<cProyecto> resultproyectos = new ArrayList<cProyecto>();
            List<cProyecto> resultdeudas = new ArrayList<cProyecto>();
            adAreaGestion accAg = new adAreaGestion();
            adProyecto aComp = new adProyecto();
            resultareas = accAg.obtenerAreasGestionHijas(Integer.parseInt(ag));

            Font fuente = new Font();
            fuente.setSize(10);
            Font fuen = new Font(Font.FontFamily.TIMES_ROMAN, 14, 1);
            Font fuent = new Font(Font.FontFamily.TIMES_ROMAN, 12, 1);
            Font fuente3 = new Font(Font.FontFamily.TIMES_ROMAN, 7, 0, BaseColor.BLACK);
            Font fuentetitulo = new Font(Font.FontFamily.TIMES_ROMAN, 8, 1, BaseColor.WHITE);
            Font fuentetexto = new Font(Font.FontFamily.TIMES_ROMAN, 7, 1, BaseColor.WHITE);

            BaseColor azul = WebColors.getRGBColor("#133351");

            for (int i = 0; i < resultareas.size(); i++) {
                resultproyectos = aComp.ListaProyectoPOA(resultareas.get(i).getAg_id(), 2020);
                if (resultproyectos.size() > 0) {
                    double totalfacultad = 0;
                    Chunk parte2 = new Chunk("Unidad Académica/Administrativa: " + resultareas.get(i).getAg_nombre(), fuen);
                    Paragraph para2 = new Paragraph();
                    para2.add(parte2);
                    para2.setAlignment(Element.ALIGN_CENTER);
                    document.add(para2);
                    document.add(new Paragraph(" "));

                    PdfPTable tablef = new PdfPTable(8);
                    tablef.setTotalWidth(new float[]{70, 230, 70, 40, 40, 40, 120, 90});
                    tablef.setLockedWidth(true);
                    PdfPCell cell;

                    cell = new PdfPCell(new Paragraph(resultareas.get(i).getAg_nombre(), fuentetitulo));
                    cell.setBackgroundColor(azul);
                    cell.setPadding(5);
                    cell.setColspan(8);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setBorderWidthBottom(1);
                    cell.setBorderColorBottom(BaseColor.WHITE);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("Código", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setRowspan(2);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("Proyecto", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setRowspan(2);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("Tipo Proyecto", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setRowspan(2);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("Programación", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderWidthBottom(1);
                    cell.setColspan(3);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setBorderColorBottom(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("Responsable", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setRowspan(2);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("Monto prespuestado 2020", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(azul);
                    cell.setRowspan(2);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("I (%)", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("II (%)", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("III (%)", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    double totalf = 0;
                    for (int j = 0; j < resultproyectos.size(); j++) {
                        cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_codigo(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_nombre(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getTp_nombre(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getCuatri().get(0).getC1() / aComp.numActividadesProy(resultproyectos.get(j).getProyecto_id())) + "%", fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getCuatri().get(0).getC2() / aComp.numActividadesProy(resultproyectos.get(j).getProyecto_id())) + "%", fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getCuatri().get(0).getC3() / aComp.numActividadesProy(resultproyectos.get(j).getProyecto_id())) + "%", fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_responsable(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                        tablef.addCell(cell);

                        Double mpluri = 0.0;
                        if (resultproyectos.get(j).getProyecto_plurianual() == 1) {
                            mpluri = aComp.montoproyectoPluri(resultareas.get(i).getAg_id(), resultproyectos.get(j).getProyecto_id(), 2020);
                        } else {
                            mpluri = resultproyectos.get(j).getProyecto_monto();
                        }

                        cell = new PdfPCell(new Paragraph("$" + formateador.format(mpluri), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                        tablef.addCell(cell);
                        totalf += mpluri;
                        totalfacultad += mpluri;
                    }
                    cell = new PdfPCell(new Paragraph("TOTAL", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setColspan(7);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$" + formateador.format(totalf), fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(azul);
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    tablef.addCell(cell);
                    document.add(tablef);

                    if (resultareas.get(i).getTag_id() == 4) {
                        double totaldeuda = 0;
                        resultdeudas = aComp.ListarDeudasAprobadas(resultareas.get(i).getAg_id(), 2020);
                        if (resultdeudas.size() > 0) {
                            document.add(new Paragraph(" "));
                            PdfPTable tableDe = new PdfPTable(4);
                            tableDe.setTotalWidth(new float[]{100, 200, 200, 200});
                            tableDe.setLockedWidth(true);

                            cell = new PdfPCell(new Paragraph("OBLIGACIONES PENDIENTES AÑOS ANTERIORES -" + resultareas.get(i).getAg_alias(), fuentetexto));
                            cell.setPadding(5);
                            cell.setColspan(4);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setBorderWidthBottom(1);
                            cell.setBorderColorBottom(BaseColor.WHITE);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph("OEI", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph("Nombre Proyecto", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph("Nombre Proceso", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph("Total", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderWidthBottom(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setBorderColorBottom(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tableDe.addCell(cell);

                            for (int rd = 0; rd < resultdeudas.size(); rd++) {
                                cell = new PdfPCell(new Paragraph("OEI-0" + resultdeudas.get(rd).getDeudas_oei(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph(resultdeudas.get(rd).getProyecto_nombre(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph(resultdeudas.get(rd).getDeudas_proceso(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph("$" + formateador.format(resultdeudas.get(rd).getDeudas_monto_pendiente() + resultdeudas.get(rd).getDeuda_monto_iva()), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                                tableDe.addCell(cell);
                                totaldeuda += resultdeudas.get(rd).getDeudas_monto_pendiente() + resultdeudas.get(rd).getDeuda_monto_iva();
                                totalfacultad += resultdeudas.get(rd).getDeudas_monto_pendiente() + resultdeudas.get(rd).getDeuda_monto_iva();
                            }
                            cell = new PdfPCell(new Paragraph("TOTAL", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setColspan(3);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph("$" + formateador.format(totaldeuda), fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(azul);
                            cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                            tableDe.addCell(cell);
                            document.add(tableDe);
//
//                        if (k < (resultareashijos.size() - 1)) {
//                            document.add(new Paragraph(" "));
//                        }
                        }
                    }

                    resultareashijos = accAg.obtenerAreasGestionHijas(resultareas.get(i).getAg_id());
                    if (resultareashijos.size() > 1) {
                        document.add(new Paragraph(" "));
                    }
                    for (int k = 0; k < resultareashijos.size(); k++) {
                        document.add(new Paragraph(" "));
                        PdfPTable tablefh = new PdfPTable(8);
                        tablefh.setTotalWidth(new float[]{70, 230, 70, 40, 40, 40, 120, 90});
                        tablefh.setLockedWidth(true);

                        cell = new PdfPCell(new Paragraph(resultareashijos.get(k).getAg_nombre(), fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setColspan(8);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthBottom(1);
                        cell.setBorderColorBottom(BaseColor.WHITE);
                        tablefh.addCell(cell);

                        cell = new PdfPCell(new Paragraph("Código", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setRowspan(2);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablefh.addCell(cell);

                        cell = new PdfPCell(new Paragraph("Proyecto", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setRowspan(2);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablefh.addCell(cell);

                        cell = new PdfPCell(new Paragraph("Tipo Proyecto", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setRowspan(2);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablefh.addCell(cell);

                        cell = new PdfPCell(new Paragraph("Programación", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderWidthBottom(1);
                        cell.setColspan(3);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setBorderColorBottom(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablefh.addCell(cell);

                        cell = new PdfPCell(new Paragraph("Responsable", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setRowspan(2);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablefh.addCell(cell);

                        cell = new PdfPCell(new Paragraph("Monto", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(azul);
                        cell.setRowspan(2);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablefh.addCell(cell);

                        cell = new PdfPCell(new Paragraph("I (%)", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablefh.addCell(cell);

                        cell = new PdfPCell(new Paragraph("II (%)", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablefh.addCell(cell);

                        cell = new PdfPCell(new Paragraph("III (%)", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablefh.addCell(cell);

                        double totalfh = 0;
                        resultproyectos = aComp.ListaProyectoPOA(resultareashijos.get(k).getAg_id(), 2020);
                        for (int j = 0; j < resultproyectos.size(); j++) {
                            cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_codigo(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablefh.addCell(cell);

                            cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_nombre(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                            tablefh.addCell(cell);

                            cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getTp_nombre(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablefh.addCell(cell);

                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getCuatri().get(0).getC1() / aComp.numActividadesProy(resultproyectos.get(j).getProyecto_id())) + "%", fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablefh.addCell(cell);

                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getCuatri().get(0).getC2() / aComp.numActividadesProy(resultproyectos.get(j).getProyecto_id())) + "%", fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablefh.addCell(cell);

                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getCuatri().get(0).getC3() / aComp.numActividadesProy(resultproyectos.get(j).getProyecto_id())) + "%", fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablefh.addCell(cell);

                            cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_responsable(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                            tablefh.addCell(cell);

                            cell = new PdfPCell(new Paragraph("$" + formateador.format(resultproyectos.get(j).getProyecto_monto()), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                            tablefh.addCell(cell);
                            totalfh += resultproyectos.get(j).getProyecto_monto();
                            totalfacultad += resultproyectos.get(j).getProyecto_monto();
                        }
                        cell = new PdfPCell(new Paragraph("TOTAL", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setColspan(7);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                        tablefh.addCell(cell);

                        cell = new PdfPCell(new Paragraph("$" + formateador.format(totalfh), fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(azul);
                        cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                        tablefh.addCell(cell);
                        document.add(tablefh);

                        if (k < (resultareashijos.size() - 1)) {
                            document.add(new Paragraph(" "));
                        }

                        if (resultareas.get(i).getTag_id() == 4) {
                            double totaldeuda = 0;
                            resultdeudas = aComp.ListarDeudasAprobadas(resultareashijos.get(k).getAg_id(), 2020);
                            if (resultdeudas.size() > 0) {
                                document.add(new Paragraph(" "));
                                PdfPTable tableDe = new PdfPTable(4);
                                tableDe.setTotalWidth(new float[]{100, 200, 200, 200});
                                tableDe.setLockedWidth(true);

                                cell = new PdfPCell(new Paragraph("OBLIGACIONES PENDIENTES AÑOS ANTERIORES -" + resultareashijos.get(k).getAg_alias(), fuentetexto));
                                cell.setPadding(5);
                                cell.setColspan(4);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setBorderWidthBottom(1);
                                cell.setBorderColorBottom(BaseColor.WHITE);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph("OEI", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph("Nombre Proyecto", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph("Nombre Proceso", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph("Total", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderWidthBottom(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setBorderColorBottom(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tableDe.addCell(cell);

                                for (int rd = 0; rd < resultdeudas.size(); rd++) {
                                    cell = new PdfPCell(new Paragraph("OEI-0" + resultdeudas.get(rd).getDeudas_oei(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tableDe.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(resultdeudas.get(rd).getProyecto_nombre(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                    tableDe.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(resultdeudas.get(rd).getDeudas_proceso(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tableDe.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("$" + formateador.format(resultdeudas.get(rd).getDeudas_monto_pendiente() + resultdeudas.get(rd).getDeuda_monto_iva()), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                                    tableDe.addCell(cell);
                                    totaldeuda += resultdeudas.get(rd).getDeudas_monto_pendiente() + resultdeudas.get(rd).getDeuda_monto_iva();
                                    totalfacultad += resultdeudas.get(rd).getDeudas_monto_pendiente() + resultdeudas.get(rd).getDeuda_monto_iva();
                                }
                                cell = new PdfPCell(new Paragraph("TOTAL", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setColspan(3);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph("$" + formateador.format(totaldeuda), fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(azul);
                                cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                                tableDe.addCell(cell);
                                document.add(tableDe);
//
//                        if (k < (resultareashijos.size() - 1)) {
//                            document.add(new Paragraph(" "));
//                        }
                            }
                        }
                    }

                    double totaldeuda = 0;
                    if (resultareas.get(i).getTag_id() != 4) {
                        resultdeudas = aComp.ListarDeudasAprobadas(resultareas.get(i).getAg_id(), 2020);
                        if (resultdeudas.size() > 0) {
                            document.add(new Paragraph(" "));
                            PdfPTable tableDe = new PdfPTable(4);
                            tableDe.setTotalWidth(new float[]{100, 200, 200, 200});
                            tableDe.setLockedWidth(true);

                            cell = new PdfPCell(new Paragraph("OBLIGACIONES PENDIENTES AÑOS ANTERIORES -" + resultareas.get(i).getAg_alias(), fuentetexto));
                            cell.setPadding(5);
                            cell.setColspan(4);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setBorderWidthBottom(1);
                            cell.setBorderColorBottom(BaseColor.WHITE);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph("OEI", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph("Nombre Proyecto", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph("Nombre Proceso", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph("Total", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderWidthBottom(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setBorderColorBottom(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tableDe.addCell(cell);

                            for (int rd = 0; rd < resultdeudas.size(); rd++) {
                                cell = new PdfPCell(new Paragraph("OEI-0" + resultdeudas.get(rd).getDeudas_oei(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph(resultdeudas.get(rd).getProyecto_nombre(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph(resultdeudas.get(rd).getDeudas_proceso(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tableDe.addCell(cell);

                                cell = new PdfPCell(new Paragraph("$" + formateador.format(resultdeudas.get(rd).getDeudas_monto_pendiente() + resultdeudas.get(rd).getDeuda_monto_iva()), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                                tableDe.addCell(cell);
                                totaldeuda += resultdeudas.get(rd).getDeudas_monto_pendiente() + resultdeudas.get(rd).getDeuda_monto_iva();
                                totalfacultad += resultdeudas.get(rd).getDeudas_monto_pendiente() + resultdeudas.get(rd).getDeuda_monto_iva();
                            }
                            cell = new PdfPCell(new Paragraph("TOTAL", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setColspan(3);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph("$" + formateador.format(totaldeuda), fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(azul);
                            cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                            tableDe.addCell(cell);
                            document.add(tableDe);
//
//                        if (k < (resultareashijos.size() - 1)) {
//                            document.add(new Paragraph(" "));
//                        }
                        }
                    }
                    BaseColor azulbajo = WebColors.getRGBColor("#819595");

                    PdfPTable tabletotal = new PdfPTable(2);
                    tabletotal.setTotalWidth(new float[]{610, 90});
                    tabletotal.setLockedWidth(true);

                    cell = new PdfPCell(new Paragraph("Total POA " + resultareas.get(i).getAg_nombre() + " :", fuent));
                    cell.setBackgroundColor(azulbajo);
                    cell.setPadding(5);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setBorderWidthBottom(1);
                    cell.setBorderColorBottom(BaseColor.WHITE);
                    tabletotal.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(totalfacultad), fuent));
                    cell.setBackgroundColor(azulbajo);
                    cell.setPadding(5);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setBorderWidthBottom(1);
                    cell.setBorderColorBottom(BaseColor.WHITE);
                    tabletotal.addCell(cell);
                    document.add(tabletotal);

//                    Chunk parte3 = new Chunk("Total POA " + resultareas.get(i).getAg_nombre() + " : $ " + formateador.format(totalfacultad), fuent);
//                    Paragraph para3 = new Paragraph();
//                    para3.add(parte3);
//                    para3.setAlignment(Element.ALIGN_CENTER);
//                    document.add(para3);
                    document.add(new Paragraph(" "));
                }
            }
        } catch (DocumentException de) {
            de.printStackTrace();
            System.err.println("document: " + de.getMessage());
            System.err.println("error: " + de.getMessage());
        }
// Paso: Cerramos el ‘document (el ‘outputstream’ se cierra automáticamente internamente)
        document.close();
    }

    private void reportePOAUnidades(HttpServletRequest request, HttpServletResponse response) throws FileNotFoundException, IOException, DocumentException {
        //Document document = new Document(PageSize.LETTER, 25, 25, 140, 50);
        Document document = new Document(PageSize.LETTER.rotate(), 39, 36, 132, 67);
        DecimalFormat formateador = new DecimalFormat("####,###,##0.00");
        try {
            String path = getServletContext().getRealPath("/") + "img/reporte/";
            String pathimg = getServletContext().getRealPath("/") + "img/reporte/";
// Paso 2: Establecemos el ContentType y creamos una instancia del Writer
            response.setContentType("application/pdf");
            String ag = request.getParameter("agidpoa");
            String titu = request.getParameter("agtitulopoa");
            String alias = request.getParameter("agaliaspoa");
            String nombre = request.getParameter("agnombrepoa");
            String anio = request.getParameter("anioreportePOA");
            String titulo = "POA " + anio + " - " + titu;
            OutputStream file = new FileOutputStream(new File(path + "POA" + anio + "-" + alias + ".pdf"));
            PdfWriter writer = PdfWriter.getInstance(document, response.getOutputStream());
            //PdfWriter writer2 = PdfWriter.getInstance(document, file);
            formatoReporteH eventos = new formatoReporteH(path, titulo, pathimg + "LOGO-PEDI.gif");

            writer.setPageEvent(eventos);
            //writer2.setPageEvent(eventos);
// Paso 3
            document.open();
// Paso 4
            document.addTitle("POA " + anio + " " + alias);

            Date date = Calendar.getInstance().getTime();
            DateFormat formatter = new SimpleDateFormat("dd/MM/yyyy, hh:mm:ss a");
            String today = formatter.format(date);

            //Lista de presupuesto
            List<cAreaGestion> resultareas = new ArrayList<cAreaGestion>();
            List<cProyecto> resultproyectos = new ArrayList<cProyecto>();
            List<cProyecto> resultdeudas = new ArrayList<cProyecto>();
            List<cProyecto> resultPlurianual = new ArrayList<cProyecto>();
            adAreaGestion accAg = new adAreaGestion();
            adProyecto aComp = new adProyecto();
            resultareas = accAg.obtenerAreasGestionUnidades(Integer.parseInt(ag));

            Font fuente = new Font();
            fuente.setSize(10);
            Font fuen = new Font(Font.FontFamily.TIMES_ROMAN, 14, 1);
            Font fuent = new Font(Font.FontFamily.TIMES_ROMAN, 12, 1);
            Font fuente3 = new Font(Font.FontFamily.TIMES_ROMAN, 7, 0, BaseColor.BLACK);
            Font fuentetitulo = new Font(Font.FontFamily.TIMES_ROMAN, 8, 1, BaseColor.WHITE);
            Font fuentetexto = new Font(Font.FontFamily.TIMES_ROMAN, 7, 1, BaseColor.WHITE);

            BaseColor azul = WebColors.getRGBColor("#133351");
            double totalfacultad = 0, totalpluri = 0;
            int taca = 0, tinv = 0, tvin = 0, tges = 0;
            int an = Integer.parseInt(anio) + 1;
            for (int i = 0; i < resultareas.size(); i++) {
                resultproyectos = aComp.ListaProyectoPOA(resultareas.get(i).getAg_id(), Integer.parseInt(anio));
                if (resultproyectos.size() > 0) {
                    Chunk parte2 = new Chunk("Unidad Académica/Administrativa: " + resultareas.get(i).getAg_nombre(), fuen);
                    Paragraph para2 = new Paragraph();
                    para2.add(parte2);
                    para2.setAlignment(Element.ALIGN_CENTER);
                    document.add(para2);
                    document.add(new Paragraph(" "));

                    PdfPTable tablef = new PdfPTable(8);
                    tablef.setTotalWidth(new float[]{70, 230, 70, 40, 40, 40, 120, 90});
                    tablef.setLockedWidth(true);
                    PdfPCell cell;

                    cell = new PdfPCell(new Paragraph(resultareas.get(i).getAg_nombre(), fuentetitulo));
                    cell.setBackgroundColor(azul);
                    cell.setPadding(5);
                    cell.setColspan(8);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setBorderWidthBottom(1);
                    cell.setBorderColorBottom(BaseColor.WHITE);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("Código", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setRowspan(2);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("Proyecto", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setRowspan(2);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("Tipo Proyecto", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setRowspan(2);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("Programación", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderWidthBottom(1);
                    cell.setColspan(3);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setBorderColorBottom(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("Responsable", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setRowspan(2);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("Monto prespuestado " + anio, fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(azul);
                    cell.setRowspan(2);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("I (%)", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("II (%)", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("III (%)", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    double totalf = 0;
                    for (int j = 0; j < resultproyectos.size(); j++) {
                        if (null != resultproyectos.get(j).getTp_id()) {
                            switch (resultproyectos.get(j).getTp_id()) {
                                case 1:
                                    taca++;
                                    break;
                                case 2:
                                    tinv++;
                                    break;
                                case 3:
                                    tvin++;
                                    break;
                                case 4:
                                    tges++;
                                    break;
                                default:
                                    break;
                            }
                        }
                        cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_codigo(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_nombre(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getTp_nombre(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getCuatri().get(0).getC1() / aComp.numActividadesProy(resultproyectos.get(j).getProyecto_id())) + "%", fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getCuatri().get(0).getC2() / aComp.numActividadesProy(resultproyectos.get(j).getProyecto_id())) + "%", fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getCuatri().get(0).getC3() / aComp.numActividadesProy(resultproyectos.get(j).getProyecto_id())) + "%", fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_responsable(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                        tablef.addCell(cell);

                        Double mpluri = 0.0;
                        if (resultproyectos.get(j).getProyecto_plurianual() == 1) {
                            mpluri = resultproyectos.get(j).getMp_monto();
                        } else {
                            mpluri = resultproyectos.get(j).getProyecto_monto();
                        }
                        cell = new PdfPCell(new Paragraph("$" + formateador.format(mpluri), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                        tablef.addCell(cell);
                        totalfacultad += mpluri;
                        totalf += mpluri;
                    }
                    cell = new PdfPCell(new Paragraph("TOTAL", fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setColspan(7);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$" + formateador.format(totalf), fuentetexto));
                    cell.setPadding(5);
                    cell.setBackgroundColor(azul);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(azul);
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    tablef.addCell(cell);
                    document.add(tablef);

                    double totaldeuda = 0;
                    resultdeudas = aComp.ListarDeudasAprobadas(resultareas.get(i).getAg_id(), Integer.parseInt(anio));
                    if (resultdeudas.size() > 0) {
                        document.add(new Paragraph(" "));
                        PdfPTable tableDe = new PdfPTable(4);
                        tableDe.setTotalWidth(new float[]{100, 200, 200, 200});
                        tableDe.setLockedWidth(true);

                        cell = new PdfPCell(new Paragraph("VALORES PENDIENTES DE PAGO AÑOS ANTERIORES -" + resultareas.get(i).getAg_alias(), fuentetexto));
                        cell.setPadding(5);
                        cell.setColspan(4);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthBottom(1);
                        cell.setBorderColorBottom(BaseColor.WHITE);
                        tableDe.addCell(cell);

                        cell = new PdfPCell(new Paragraph("OEI", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tableDe.addCell(cell);

                        cell = new PdfPCell(new Paragraph("Nombre Proyecto", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tableDe.addCell(cell);

                        cell = new PdfPCell(new Paragraph("Nombre Proceso", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tableDe.addCell(cell);

                        cell = new PdfPCell(new Paragraph("Total", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderWidthBottom(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setBorderColorBottom(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tableDe.addCell(cell);

                        for (int rd = 0; rd < resultdeudas.size(); rd++) {
                            cell = new PdfPCell(new Paragraph("OEI-0" + resultdeudas.get(rd).getDeudas_oei(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph(resultdeudas.get(rd).getProyecto_nombre(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph(resultdeudas.get(rd).getDeudas_proceso(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tableDe.addCell(cell);

                            cell = new PdfPCell(new Paragraph("$" + formateador.format(resultdeudas.get(rd).getDeuda_monto_contrato() + resultdeudas.get(rd).getDeuda_monto_iva() + resultdeudas.get(rd).getDeudas_anticipo()), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                            tableDe.addCell(cell);
                            totaldeuda += resultdeudas.get(rd).getDeuda_monto_contrato() + resultdeudas.get(rd).getDeuda_monto_iva() + resultdeudas.get(rd).getDeudas_anticipo();
                            totalfacultad += resultdeudas.get(rd).getDeuda_monto_contrato() + resultdeudas.get(rd).getDeuda_monto_iva() + resultdeudas.get(rd).getDeudas_anticipo();
                        }
                        cell = new PdfPCell(new Paragraph("TOTAL", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setColspan(3);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                        tableDe.addCell(cell);

                        cell = new PdfPCell(new Paragraph("$" + formateador.format(totaldeuda), fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(azul);
                        cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                        tableDe.addCell(cell);
                        document.add(tableDe);
                    }
                    document.add(new Paragraph(" "));
                }
            }
            resultPlurianual = aComp.ListarPlurianuales(Integer.parseInt(ag));
            if (resultPlurianual.size() > 0) {
                document.add(new Paragraph(" "));
                PdfPTable tablePlu = new PdfPTable(4);
                tablePlu.setTotalWidth(new float[]{350, 100, 100, 150});
                tablePlu.setLockedWidth(true);
                PdfPCell cell;

                cell = new PdfPCell(new Paragraph("PLANIFICACIÓN PLURIANUAL " + an + " - " + alias, fuentetexto));
                cell.setPadding(5);
                cell.setColspan(4);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                tablePlu.addCell(cell);

                cell = new PdfPCell(new Paragraph("PROYECTO", fuentetexto));
                cell.setPadding(5);
                cell.setRowspan(2);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                tablePlu.addCell(cell);

                cell = new PdfPCell(new Paragraph("MONTO", fuentetexto));
                cell.setPadding(5);
                cell.setColspan(3);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tablePlu.addCell(cell);

                cell = new PdfPCell(new Paragraph("MONTO " + anio, fuentetexto));
                cell.setPadding(5);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tablePlu.addCell(cell);

                cell = new PdfPCell(new Paragraph("MONTO " + an, fuentetexto));
                cell.setPadding(5);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tablePlu.addCell(cell);

                cell = new PdfPCell(new Paragraph("TOTAL", fuentetexto));
                cell.setPadding(5);
                cell.setBackgroundColor(azul);
                cell.setBorderWidthRight(1);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                tablePlu.addCell(cell);

                for (int rd = 0; rd < resultPlurianual.size(); rd++) {
                    cell = new PdfPCell(new Paragraph(resultPlurianual.get(rd).getProyecto_nombre(), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablePlu.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$" + formateador.format(aComp.montoproyectoPluri(Integer.parseInt(ag), resultPlurianual.get(rd).getProyecto_id(), 2020)), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    tablePlu.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$" + formateador.format(aComp.montoproyectoPluri(Integer.parseInt(ag), resultPlurianual.get(rd).getProyecto_id(), 2021)), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    tablePlu.addCell(cell);
                    totalpluri += aComp.montoproyectoPluri(Integer.parseInt(ag), resultPlurianual.get(rd).getProyecto_id(), 2021);

                    cell = new PdfPCell(new Paragraph("$" + formateador.format(resultPlurianual.get(rd).getProyecto_monto()), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    tablePlu.addCell(cell);
                }
                document.add(tablePlu);
            }

            document.add(new Paragraph(" "));
            PdfPTable tableTot = new PdfPTable(3);
            tableTot.setTotalWidth(new float[]{225, 225, 250});
            tableTot.setLockedWidth(true);
            PdfPCell cell;

            cell = new PdfPCell(new Paragraph("TOTAL " + anio + " - " + alias, fuentetexto));
            cell.setPadding(5);
            cell.setBackgroundColor(azul);
            cell.setBorderWidthRight(1);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            tableTot.addCell(cell);

            cell = new PdfPCell(new Paragraph("TOTAL PROYECTO PLURIANUAL " + an + " - " + alias, fuentetexto));
            cell.setPadding(5);
            cell.setBackgroundColor(azul);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tableTot.addCell(cell);

            cell = new PdfPCell(new Paragraph("TOTAL POA " + anio + "-" + an + " - " + alias, fuentetexto));
            cell.setPadding(5);
            cell.setBackgroundColor(azul);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tableTot.addCell(cell);

            cell = new PdfPCell(new Paragraph("$" + formateador.format(totalfacultad), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(3);
            cell.setBorderWidth(1);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_CENTER);
            tableTot.addCell(cell);

            cell = new PdfPCell(new Paragraph("$" + formateador.format(totalpluri), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(3);
            cell.setBorderWidth(1);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_CENTER);
            tableTot.addCell(cell);

            cell = new PdfPCell(new Paragraph("$" + formateador.format(totalfacultad + totalpluri), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(3);
            cell.setBorderWidth(1);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_CENTER);
            tableTot.addCell(cell);

            document.add(tableTot);

            //Total numero de proyectos por tipo
            document.add(new Paragraph(" "));
            PdfPTable tableTotT = new PdfPTable(2);
            tableTotT.setTotalWidth(new float[]{250, 250});
            tableTotT.setLockedWidth(true);

            cell = new PdfPCell(new Paragraph("TOTAL NÚMERO DE PROYECTOS POR TIPOS - " + alias, fuentetexto));
            cell.setPadding(5);
            cell.setColspan(2);
            cell.setBackgroundColor(azul);
            cell.setBorderWidthRight(1);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            tableTotT.addCell(cell);

            cell = new PdfPCell(new Paragraph("TIPO PROYECTOS", fuentetexto));
            cell.setPadding(5);
            cell.setBackgroundColor(azul);
            cell.setBorderWidthRight(1);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            tableTotT.addCell(cell);

            cell = new PdfPCell(new Paragraph("# PROYECTOS", fuentetexto));
            cell.setPadding(5);
            cell.setBackgroundColor(azul);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tableTotT.addCell(cell);

            cell = new PdfPCell(new Paragraph("ACADÉMICOS", fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(3);
            cell.setBorderWidth(1);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_CENTER);
            tableTotT.addCell(cell);

            cell = new PdfPCell(new Paragraph(String.valueOf(taca), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(3);
            cell.setBorderWidth(1);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_CENTER);
            tableTotT.addCell(cell);

            cell = new PdfPCell(new Paragraph("INVESTIGACIÓN", fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(3);
            cell.setBorderWidth(1);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_CENTER);
            tableTotT.addCell(cell);

            cell = new PdfPCell(new Paragraph(String.valueOf(tinv), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(3);
            cell.setBorderWidth(1);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_CENTER);
            tableTotT.addCell(cell);

            cell = new PdfPCell(new Paragraph("VINCULACIÓN", fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(3);
            cell.setBorderWidth(1);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_CENTER);
            tableTotT.addCell(cell);

            cell = new PdfPCell(new Paragraph(String.valueOf(tvin), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(3);
            cell.setBorderWidth(1);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_CENTER);
            tableTotT.addCell(cell);

            cell = new PdfPCell(new Paragraph("GESTIÓN", fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(3);
            cell.setBorderWidth(1);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_CENTER);
            tableTotT.addCell(cell);

            cell = new PdfPCell(new Paragraph(String.valueOf(tges), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(3);
            cell.setBorderWidth(1);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_CENTER);
            tableTotT.addCell(cell);

            cell = new PdfPCell(new Paragraph("TOTAL", fuentetexto));
            cell.setPadding(5);
            cell.setBackgroundColor(azul);
            cell.setBorderWidthRight(1);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            tableTotT.addCell(cell);

            cell = new PdfPCell(new Paragraph(String.valueOf(taca + tinv + tvin + tges), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPadding(3);
            cell.setBorderWidth(1);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_CENTER);
            tableTotT.addCell(cell);

            document.add(tableTotT);
        } catch (DocumentException de) {
            de.printStackTrace();
            System.err.println("document: " + de.getMessage());
            System.err.println("error: " + de.getMessage());
        }
// Paso: Cerramos el ‘document (el ‘outputstream’ se cierra automáticamente internamente)
        document.close();
    }

    private void reportePOAEvalUnidades(HttpServletRequest request, HttpServletResponse response) throws FileNotFoundException, IOException, DocumentException {
        //Document document = new Document(PageSize.LETTER, 25, 25, 140, 50);
        Document document = new Document(PageSize.LETTER.rotate(), 39, 36, 132, 67);
        DecimalFormat formateador = new DecimalFormat("####,###,##0.00");
        try {
            String path = getServletContext().getRealPath("/") + "img/reporte/";
            String pathimg = getServletContext().getRealPath("/") + "img/reporte/";
// Paso 2: Establecemos el ContentType y creamos una instancia del Writer
            response.setContentType("application/pdf");
            String ag = request.getParameter("agidpoa");
            String titu = request.getParameter("agtitulopoa");
            String alias = request.getParameter("agaliaspoa");
            String nombre = request.getParameter("agnombrepoa");
            String sarea = request.getParameter("selectareas");
            String tipo = request.getParameter("selecttipo");
            String tipousu = request.getParameter("tipusuarioeval");
            String cuatrimestre = request.getParameter("cuatrim");
            String anio = request.getParameter("selectanio");
            String tit, tipnombre;
            if (cuatrimestre.equals("0")) {
                tit = "FINAL ";
            } else {
                tit = cuatrimestre + " CUATRIMESTRE ";
            }
            if (tipo.equals("1")) {
                tipnombre = "OEI-01 ";
            } else if (tipo.equals("2")) {
                tipnombre = "OEI-02 ";
            } else if (tipo.equals("3")) {
                tipnombre = "OEI-03 ";
            } else if (tipo.equals("4")) {
                tipnombre = "OEI-04 ";
            } else {
                tipnombre = "";
            }
            String titulo = "EVALUACIÓN " + tit + tipnombre + anio + " - " + titu;
            OutputStream file = new FileOutputStream(new File(path + "POAEVALUACION" + anio + "-" + alias + ".pdf"));
            PdfWriter writer = PdfWriter.getInstance(document, response.getOutputStream());
            //PdfWriter writer2 = PdfWriter.getInstance(document, file);
            formatoReporteH eventos = new formatoReporteH(path, titulo, pathimg + "LOGO-PEDI.gif");

            writer.setPageEvent(eventos);
            //writer2.setPageEvent(eventos);
// Paso 3
            document.open();
// Paso 4
            document.addTitle("EVALUACIÓN " + tit + " CUATRIMESTRE " + alias);

            Date date = Calendar.getInstance().getTime();
            DateFormat formatter = new SimpleDateFormat("dd/MM/yyyy, hh:mm:ss a");
            String today = formatter.format(date);

            //Lista de presupuesto
            List<cAreaGestion> resultareas = new ArrayList<cAreaGestion>();
            List<cProyecto> resultunidades = new ArrayList<cProyecto>();
            List<cProyecto> resultproyectos = new ArrayList<cProyecto>();
            adAreaGestion accAg = new adAreaGestion();
            adProyecto aComp = new adProyecto();

            Font fuente = new Font();
            fuente.setSize(10);
            Font fuen = new Font(Font.FontFamily.TIMES_ROMAN, 14, 1);
            Font fuent = new Font(Font.FontFamily.TIMES_ROMAN, 12, 1);
            Font fuente3 = new Font(Font.FontFamily.TIMES_ROMAN, 7, 0, BaseColor.BLACK);
            Font fuentetitulo = new Font(Font.FontFamily.TIMES_ROMAN, 8, 1, BaseColor.WHITE);
            Font fuentetexto = new Font(Font.FontFamily.TIMES_ROMAN, 7, 1, BaseColor.WHITE);

            BaseColor azul = WebColors.getRGBColor("#133351");

            int oeii, oeif;
            if (tipo.equals("0")) {
                oeii = 1;
                oeif = 4;
            } else {
                oeii = Integer.parseInt(tipo);
                oeif = Integer.parseInt(tipo);
            }

            double tefioe1 = 0, teficoe1 = 0, tefecoe1 = 0, tplan1 = 0, teje1 = 0;
            int tpplan1 = 0, tpcua1 = 0, tpeval1 = 0;
            double tefioe2 = 0, teficoe2 = 0, tefecoe2 = 0, tplan2 = 0, teje2 = 0;
            int tpplan2 = 0, tpcua2 = 0, tpeval2 = 0;
            double tefioe3 = 0, teficoe3 = 0, tefecoe3 = 0, tplan3 = 0, teje3 = 0;
            int tpplan3 = 0, tpcua3 = 0, tpeval3 = 0;
            double tefioe4 = 0, teficoe4 = 0, tefecoe4 = 0, tplan4 = 0, teje4 = 0;
            int tpplan4 = 0, tpcua4 = 0, tpeval4 = 0;
            if (anio.equals("2020")) {
                if (cuatrimestre.equals("0")) {
                    if (sarea.equals("0")) {
                        resultunidades = aComp.ListaProyectoPOAEvalAdminComp(Integer.parseInt(ag), Integer.parseInt(tipo), Integer.parseInt(anio));
                        resultareas = accAg.obtenerAreasGestionUnidades(Integer.parseInt(ag));
                    } else {
                        resultunidades = aComp.ListaProyectoPOAEvalAdminComp(Integer.parseInt(sarea), Integer.parseInt(tipo), Integer.parseInt(anio));
                        resultareas = accAg.obtenerAreasGestionUnidades(Integer.parseInt(sarea));
                    }
                } else {
                    if (sarea.equals("0")) {
                        resultunidades = aComp.ListaProyectoPOAEval(Integer.parseInt(ag), Integer.parseInt(tipo), Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                        resultareas = accAg.obtenerAreasGestionUnidades(Integer.parseInt(ag));
                    } else {
                        resultunidades = aComp.ListaProyectoPOAEval(Integer.parseInt(sarea), Integer.parseInt(tipo), Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                        resultareas = accAg.obtenerAreasGestionUnidades(Integer.parseInt(sarea));
                    }
                }

                if (resultunidades.size() > 0) {
                    Chunk parte2;
                    if (resultunidades.size() < 2) {
                        parte2 = new Chunk("EVALUACIÓN " + tit + resultunidades.get(0).getProyecto_nombre(), fuen);
                    } else {
                        parte2 = new Chunk("EVALUACIÓN " + tit + nombre, fuen);
                    }
                    Paragraph para2 = new Paragraph();
                    para2.add(parte2);
                    para2.setAlignment(Element.ALIGN_CENTER);
                    document.add(para2);
                    document.add(new Paragraph(" "));

                    PdfPTable tablef;
                    if ((cuatrimestre.equals("3") && anio.equals("2020")) || anio.equals("2021")) {
                        tablef = new PdfPTable(9);
                        tablef.setTotalWidth(new float[]{140, 70, 70, 70, 70, 70, 70, 70, 70});
                        tablef.setLockedWidth(true);
                    } else if (cuatrimestre.equals("0")) {
                        tablef = new PdfPTable(8);
                        tablef.setTotalWidth(new float[]{180, 80, 70, 70, 70, 70, 80, 80});
                        tablef.setLockedWidth(true);
                    } else {
                        tablef = new PdfPTable(5);
                        tablef.setTotalWidth(new float[]{230, 115, 115, 120, 120});
                        tablef.setLockedWidth(true);
                    }

                    PdfPCell cell;
                    cell = new PdfPCell(new Paragraph("UNIDAD", fuentetitulo));
                    cell.setBackgroundColor(azul);
                    cell.setPadding(5);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setBorderWidthBottom(1);
                    cell.setBorderColorBottom(BaseColor.WHITE);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("#PROYECTOS PLANIFICADOS", fuentetitulo));
                    cell.setBackgroundColor(azul);
                    cell.setPadding(5);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("#EJECUTADO CUATRIMESTRE", fuentetitulo));
                    cell.setBackgroundColor(azul);
                    cell.setPadding(5);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    tablef.addCell(cell);

                    if (!cuatrimestre.equals("0")) {
                        cell = new PdfPCell(new Paragraph("#PROYECTOS EVALUADOS", fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        tablef.addCell(cell);
                    }

                    cell = new PdfPCell(new Paragraph("EFICACIA", fuentetitulo));
                    cell.setBackgroundColor(azul);
                    cell.setPadding(5);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setBorderWidthBottom(1);
                    cell.setBorderColorBottom(BaseColor.WHITE);
                    tablef.addCell(cell);

                    if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                        cell = new PdfPCell(new Paragraph("EFICIENCIA", fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthBottom(1);
                        cell.setBorderColorBottom(BaseColor.WHITE);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph("EFECTIVIDAD", fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthBottom(1);
                        cell.setBorderColorBottom(BaseColor.WHITE);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph("PLANIFICADO", fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthBottom(1);
                        cell.setBorderColorBottom(BaseColor.WHITE);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph("EJECUCIÓN", fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthBottom(1);
                        cell.setBorderColorBottom(BaseColor.WHITE);
                        tablef.addCell(cell);
                    }

                    double tefi = 0, tefic = 0, tefe = 0, teje = 0, tmplan = 0;
                    int tplan = 0, tcuat = 0, teval = 0, sum = 0;
                    if (sarea.equals("0")) {
                        for (int j = 0; j < resultunidades.size(); j++) {
                            if (resultunidades.get(j).getProyecto_planificados() > 0) {
                                cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_nombre(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_planificados().toString(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tplan += resultunidades.get(j).getProyecto_planificados();

                                if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                    sum++;
                                }
                                cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_plurianual().toString(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tcuat += resultunidades.get(j).getProyecto_plurianual();

                                if (!cuatrimestre.equals("0")) {
                                    cell = new PdfPCell(new Paragraph(resultunidades.get(j).getPp_id().toString(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    teval += resultunidades.get(j).getPp_id();
                                }

                                if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficacia()) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph("--", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tefi += resultunidades.get(j).getPe_eficacia();

                                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                                    if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficiencia()) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph("--", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tefic += resultunidades.get(j).getPe_eficiencia();

                                    if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_efectividad()) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph("--", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tefe += resultunidades.get(j).getPe_efectividad();

                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getProyecto_monto()), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tmplan += resultunidades.get(j).getProyecto_monto();

                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_ejecucion()), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    teje += resultunidades.get(j).getPe_ejecucion();
                                }
                            }
                        }
                    } else if (sarea.equals(ag)) {
                        for (int j = 0; j < resultunidades.size(); j++) {
                            if (resultunidades.get(j).getProyecto_nombre().equals(nombre)) {
                                cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_nombre(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_planificados().toString(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tplan += resultunidades.get(j).getProyecto_planificados();

                                if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                    sum++;
                                }
                                cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_plurianual().toString(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tcuat += resultunidades.get(j).getProyecto_plurianual();

                                if (!cuatrimestre.equals("0")) {
                                    cell = new PdfPCell(new Paragraph(resultunidades.get(j).getPp_id().toString(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    teval += resultunidades.get(j).getPp_id();
                                }

                                if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficacia()) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph("--", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tefi += resultunidades.get(j).getPe_eficacia();

                                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                                    if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficiencia()) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph("--", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tefic += resultunidades.get(j).getPe_eficiencia();

                                    if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_efectividad()) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph("--", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tefe += resultunidades.get(j).getPe_efectividad();

                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getProyecto_monto()), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tmplan += resultunidades.get(j).getProyecto_monto();

                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_ejecucion()), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    teje += resultunidades.get(j).getPe_ejecucion();
                                }
                            }
                        }
                    } else {
                        for (int j = 0; j < resultunidades.size(); j++) {
                            cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_nombre(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_planificados().toString(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);
                            tplan += resultunidades.get(j).getProyecto_planificados();

                            if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                sum++;
                            }
                            cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_plurianual().toString(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);
                            tcuat += resultunidades.get(j).getProyecto_plurianual();

                            if (!cuatrimestre.equals("0")) {
                                cell = new PdfPCell(new Paragraph(resultunidades.get(j).getPp_id().toString(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                teval += resultunidades.get(j).getPp_id();
                            }

                            if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficacia()) + "%", fuente3));
                            } else {
                                cell = new PdfPCell(new Paragraph("--", fuente3));
                            }
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);
                            tefi += resultunidades.get(j).getPe_eficacia();

                            if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                                if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficiencia()) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph("--", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tefic += resultunidades.get(j).getPe_eficiencia();

                                if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_efectividad()) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph("--", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tefe += resultunidades.get(j).getPe_efectividad();

                                cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getProyecto_monto()), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tmplan += resultunidades.get(j).getProyecto_monto();

                                cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_ejecucion()), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                teje += resultunidades.get(j).getPe_ejecucion();
                            }
                        }
                    }
                    cell = new PdfPCell(new Paragraph("TOTAL", fuentetitulo));
                    cell.setBackgroundColor(azul);
                    cell.setPadding(5);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph(tplan + "", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph(tcuat + "", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    if (!cuatrimestre.equals("0")) {
                        cell = new PdfPCell(new Paragraph(teval + "", fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);
                    }

                    double tot, totefi, totefec;
                    if (sum == 0) {
                        tot = tefi;
                        totefi = tefic;
                    } else {
                        tot = tefi / sum;
                        totefi = tefic / sum;
                    }
                    BigDecimal efit = BigDecimal.valueOf(tot);
                    BigDecimal efict = BigDecimal.valueOf(totefi);
                    efit = efit.setScale(2, RoundingMode.HALF_UP);
                    efict = efict.setScale(2, RoundingMode.HALF_UP);
                    totefec = (efict.doubleValue() + efit.doubleValue());
                    BigDecimal efec = BigDecimal.valueOf(totefec);
                    efec = efec.setScale(2, RoundingMode.HALF_UP);
                    cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue()) + "%", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                        cell = new PdfPCell(new Paragraph(formateador.format(efict.doubleValue()) + "%", fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(formateador.format(efec.doubleValue() / 2) + "%", fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(formateador.format(tmplan), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(formateador.format(teje), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);
                    }

                    document.add(tablef);
                    document.add(new Paragraph(" "));
                }
            } else {
                for (int oe = oeii; oe <= oeif; oe++) {
                    if (cuatrimestre.equals("0")) {
                        if (sarea.equals("0")) {
                            resultunidades = aComp.ListaProyectoPOAEvalAdminComp(Integer.parseInt(ag), oe, Integer.parseInt(anio));
                            resultareas = accAg.obtenerAreasGestionUnidades(Integer.parseInt(ag));
                        } else {
                            resultunidades = aComp.ListaProyectoPOAEvalAdminComp(Integer.parseInt(sarea), oe, Integer.parseInt(anio));
                            resultareas = accAg.obtenerAreasGestionUnidades(Integer.parseInt(sarea));
                        }
                    } else {
                        if (sarea.equals("0")) {
                            resultunidades = aComp.ListaProyectoPOAEval(Integer.parseInt(ag), oe, Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                            resultareas = accAg.obtenerAreasGestionUnidades(Integer.parseInt(ag));
                        } else {
                            resultunidades = aComp.ListaProyectoPOAEval(Integer.parseInt(sarea), oe, Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                            resultareas = accAg.obtenerAreasGestionUnidades(Integer.parseInt(sarea));
                        }
                    }

                    String oenombre;
                    if (oe == 1) {
                        oenombre = " ACADÉMICO ";
                    } else if (oe == 2) {
                        oenombre = " INVESTIGACIÓN ";
                    } else if (oe == 3) {
                        oenombre = " VINCULACIÓN ";
                    } else {
                        oenombre = " GESTIÓN ";
                    }
                    int contador = 0;
                    for (int j = 0; j < resultunidades.size(); j++) {
                        if (resultunidades.get(j).getProyecto_planificados() > 0) {
                            contador++;
                        }
                    }

                    if (resultunidades.size() > 0 && contador > 0) {
                        Chunk parte2;
                        if (resultunidades.size() < 2) {
                            parte2 = new Chunk("EVALUACIÓN " + tit + oenombre + resultunidades.get(0).getProyecto_nombre(), fuen);
                        } else {
                            parte2 = new Chunk("EVALUACIÓN " + tit + oenombre + nombre, fuen);
                        }
                        Paragraph para2 = new Paragraph();
                        para2.add(parte2);
                        para2.setAlignment(Element.ALIGN_CENTER);
                        document.add(para2);
                        document.add(new Paragraph(" "));

                        PdfPTable tablef;
                        if ((cuatrimestre.equals("3") && anio.equals("2020")) || (anio.equals("2021") && !cuatrimestre.equals("0"))) {
                            tablef = new PdfPTable(9);
                            tablef.setTotalWidth(new float[]{140, 70, 70, 70, 70, 70, 70, 70, 70});
                            tablef.setLockedWidth(true);
                        } else if (cuatrimestre.equals("0")) {
                            tablef = new PdfPTable(8);
                            tablef.setTotalWidth(new float[]{170, 80, 70, 70, 70, 70, 80, 80});
                            tablef.setLockedWidth(true);
                        } else {
                            tablef = new PdfPTable(5);
                            tablef.setTotalWidth(new float[]{230, 115, 115, 120, 120});
                            tablef.setLockedWidth(true);
                        }

                        PdfPCell cell;
                        cell = new PdfPCell(new Paragraph("UNIDAD", fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthBottom(1);
                        cell.setBorderColorBottom(BaseColor.WHITE);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph("#PROYECTOS PLANIFICADOS", fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph("#EJECUTADO CUATRIMESTRE", fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        tablef.addCell(cell);

                        if (!cuatrimestre.equals("0")) {
                            cell = new PdfPCell(new Paragraph("#PROYECTOS EVALUADOS", fuentetitulo));
                            cell.setBackgroundColor(azul);
                            cell.setPadding(5);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            tablef.addCell(cell);
                        }

                        cell = new PdfPCell(new Paragraph("EFICACIA", fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthBottom(1);
                        cell.setBorderColorBottom(BaseColor.WHITE);
                        tablef.addCell(cell);

                        if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                            cell = new PdfPCell(new Paragraph("EFICIENCIA", fuentetitulo));
                            cell.setBackgroundColor(azul);
                            cell.setPadding(5);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setBorderWidthBottom(1);
                            cell.setBorderColorBottom(BaseColor.WHITE);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("EFECTIVIDAD", fuentetitulo));
                            cell.setBackgroundColor(azul);
                            cell.setPadding(5);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setBorderWidthBottom(1);
                            cell.setBorderColorBottom(BaseColor.WHITE);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("PLANIFICADO", fuentetitulo));
                            cell.setBackgroundColor(azul);
                            cell.setPadding(5);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setBorderWidthBottom(1);
                            cell.setBorderColorBottom(BaseColor.WHITE);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("EJECUCIÓN", fuentetitulo));
                            cell.setBackgroundColor(azul);
                            cell.setPadding(5);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setBorderWidthBottom(1);
                            cell.setBorderColorBottom(BaseColor.WHITE);
                            tablef.addCell(cell);
                        }

                        double tefi = 0, tefic = 0, tefe = 0, teje = 0, tmplan = 0;
                        int tplan = 0, tcuat = 0, teval = 0, sum = 0;
                        if (sarea.equals("0")) {
                            for (int j = 0; j < resultunidades.size(); j++) {
                                if (resultunidades.get(j).getProyecto_planificados() > 0) {
                                    cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_nombre(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_planificados().toString(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tplan += resultunidades.get(j).getProyecto_planificados();

                                    if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                        sum++;
                                    }
                                    cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_plurianual().toString(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tcuat += resultunidades.get(j).getProyecto_plurianual();

                                    if (!cuatrimestre.equals("0")) {
                                        cell = new PdfPCell(new Paragraph(resultunidades.get(j).getPp_id().toString(), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);
                                        teval += resultunidades.get(j).getPp_id();
                                    }

                                    if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficacia()) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph("---", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tefi += resultunidades.get(j).getPe_eficacia();

                                    if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                                        if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficiencia()) + "%", fuente3));
                                        } else {
                                            cell = new PdfPCell(new Paragraph("---", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);
                                        tefic += resultunidades.get(j).getPe_eficiencia();

                                        if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_efectividad()) + "%", fuente3));
                                        } else {
                                            cell = new PdfPCell(new Paragraph("---", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);
                                        tefe += resultunidades.get(j).getPe_efectividad();

                                        cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getProyecto_monto()), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);
                                        tmplan += resultunidades.get(j).getProyecto_monto();

                                        cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_ejecucion()), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);
                                        teje += resultunidades.get(j).getPe_ejecucion();
                                    }
                                }
                            }
                        } else if (sarea.equals(ag)) {
                            for (int j = 0; j < resultunidades.size(); j++) {
                                if (resultunidades.get(j).getProyecto_nombre().equals(nombre)) {
                                    cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_nombre(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_planificados().toString(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tplan += resultunidades.get(j).getProyecto_planificados();

                                    if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                        sum++;
                                    }
                                    cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_plurianual().toString(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tcuat += resultunidades.get(j).getProyecto_plurianual();

                                    if (!cuatrimestre.equals("0")) {
                                        cell = new PdfPCell(new Paragraph(resultunidades.get(j).getPp_id().toString(), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);
                                        teval += resultunidades.get(j).getPp_id();
                                    }

                                    if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficacia()) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph("---", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tefi += resultunidades.get(j).getPe_eficacia();

                                    if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                                        if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficiencia()) + "%", fuente3));
                                        } else {
                                            cell = new PdfPCell(new Paragraph("---", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);
                                        tefic += resultunidades.get(j).getPe_eficiencia();

                                        if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_efectividad()) + "%", fuente3));
                                        } else {
                                            cell = new PdfPCell(new Paragraph("---", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);
                                        tefe += resultunidades.get(j).getPe_efectividad();

                                        cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getProyecto_monto()), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);
                                        tmplan += resultunidades.get(j).getProyecto_monto();

                                        cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_ejecucion()), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);
                                        teje += resultunidades.get(j).getPe_ejecucion();
                                    }
                                }
                            }
                        } else {
                            for (int j = 0; j < resultunidades.size(); j++) {
                                cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_nombre(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_planificados().toString(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tplan += resultunidades.get(j).getProyecto_planificados();

                                if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                    sum++;
                                }
                                cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_plurianual().toString(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tcuat += resultunidades.get(j).getProyecto_plurianual();

                                if (!cuatrimestre.equals("0")) {
                                    cell = new PdfPCell(new Paragraph(resultunidades.get(j).getPp_id().toString(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    teval += resultunidades.get(j).getPp_id();
                                }

                                if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficacia()) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph("---", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tefi += resultunidades.get(j).getPe_eficacia();

                                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                                    if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficiencia()) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph("---", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tefic += resultunidades.get(j).getPe_eficiencia();

                                    if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_efectividad()) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph("---", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tefe += resultunidades.get(j).getPe_efectividad();

                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getProyecto_monto()), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tmplan += resultunidades.get(j).getProyecto_monto();

                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_ejecucion()), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    teje += resultunidades.get(j).getPe_ejecucion();
                                }
                            }
                        }
                        cell = new PdfPCell(new Paragraph("TOTAL", fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(tplan + "", fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(tcuat + "", fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        if (!cuatrimestre.equals("0")) {
                            cell = new PdfPCell(new Paragraph(teval + "", fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);
                        }

                        double tot, totefi, totefec;
                        if (sum == 0) {
                            tot = tefi;
                            totefi = tefic;
                        } else {
                            tot = tefi / sum;
                            totefi = tefic / sum;
                        }
                        BigDecimal efit = BigDecimal.valueOf(tot);
                        BigDecimal efict = BigDecimal.valueOf(totefi);
                        efit = efit.setScale(2, RoundingMode.HALF_UP);
                        efict = efict.setScale(2, RoundingMode.HALF_UP);
                        totefec = (efict.doubleValue() + efit.doubleValue());
                        BigDecimal efec = BigDecimal.valueOf(totefec);
                        efec = efec.setScale(2, RoundingMode.HALF_UP);
                        cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue()) + "%", fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                            cell = new PdfPCell(new Paragraph(formateador.format(efict.doubleValue()) + "%", fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph(formateador.format(efec.doubleValue() / 2) + "%", fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph(formateador.format(tmplan), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph(formateador.format(teje), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);
                        }

                        if (oe == 1) {
                            tpplan1 = tplan;
                            tpcua1 = tcuat;
                            tpeval1 = teval;
                            tefioe1 = efit.doubleValue();
                            teficoe1 = efict.doubleValue();
                            tefecoe1 = efec.doubleValue() / 2;
                            tplan1 = tmplan;
                            teje1 = teje;
                        } else if (oe == 2) {
                            tpplan2 = tplan;
                            tpcua2 = tcuat;
                            tpeval2 = teval;
                            tefioe2 = efit.doubleValue();
                            teficoe2 = efict.doubleValue();
                            tefecoe2 = efec.doubleValue() / 2;
                            tplan2 = tmplan;
                            teje2 = teje;
                        } else if (oe == 3) {
                            tpplan3 = tplan;
                            tpcua3 = tcuat;
                            tpeval3 = teval;
                            tefioe3 = efit.doubleValue();
                            teficoe3 = efict.doubleValue();
                            tefecoe3 = efec.doubleValue() / 2;
                            tplan3 = tmplan;
                            teje3 = teje;
                        } else {
                            tpplan4 = tplan;
                            tpcua4 = tcuat;
                            tpeval4 = teval;
                            tefioe4 = efit.doubleValue();
                            teficoe4 = efict.doubleValue();
                            tefecoe4 = efec.doubleValue() / 2;
                            tplan4 = tmplan;
                            teje4 = teje;
                        }

                        document.add(tablef);
                        document.add(new Paragraph(" "));
                    }
                }
            }

            if (tipo.equals("0") && !anio.equals("2020")) {
                Chunk parte2;
                if (resultunidades.size() > 0) {
                    parte2 = new Chunk("RESUMEN GENERAL " + tit + resultunidades.get(0).getProyecto_nombre(), fuen);
                } else {
                    parte2 = new Chunk("RESUMEN GENERAL " + tit + nombre, fuen);
                }
                Paragraph para2 = new Paragraph();
                para2.add(parte2);
                para2.setAlignment(Element.ALIGN_CENTER);
                document.add(para2);
                document.add(new Paragraph(" "));

                PdfPTable tablef;
                if (cuatrimestre.equals("0")) {
                    tablef = new PdfPTable(8);
                    tablef.setTotalWidth(new float[]{180, 80, 70, 70, 70, 70, 80, 80});
                    tablef.setLockedWidth(true);
                } else {

                    tablef = new PdfPTable(9);
                    tablef.setTotalWidth(new float[]{140, 70, 70, 70, 70, 70, 70, 70, 70});
                    tablef.setLockedWidth(true);
                }

                PdfPCell cell;
                cell = new PdfPCell(new Paragraph("OEI", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("#PROYECTOS PLANIFICADOS", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("#EJECUTADO CUATRIMESTRE", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                tablef.addCell(cell);

                if (!cuatrimestre.equals("0")) {
                    cell = new PdfPCell(new Paragraph("#PROYECTOS EVALUADOS", fuentetitulo));
                    cell.setBackgroundColor(azul);
                    cell.setPadding(5);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    tablef.addCell(cell);
                }

                cell = new PdfPCell(new Paragraph("EFICACIA", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("EFICIENCIA", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("EFECTIVIDAD", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("PLANIFICADO", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("EJECUCIÓN", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                tablef.addCell(cell);

                double tefi = 0, tefic = 0, tefe = 0, teje = 0, tmplan = 0;
                int tplan = 0, tcuat = 0, teval = 0, sum = 0;
                if (tpplan1 > 0) {
                    cell = new PdfPCell(new Paragraph("OEI-1 ", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph(String.valueOf(tpplan1), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tplan += tpplan1;

                    cell = new PdfPCell(new Paragraph(String.valueOf(tpcua1), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tcuat += tpcua1;

                    if (!cuatrimestre.equals("0")) {
                        cell = new PdfPCell(new Paragraph(String.valueOf(tpeval1), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);
                        teval += tpeval1;
                    }

                    if (tpcua1 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(tefioe1) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefi += tefioe1;

                    if (tpcua1 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(teficoe1) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefic += teficoe1;

                    if (tpcua1 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(tefecoe1) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefe += tefecoe1;

                    cell = new PdfPCell(new Paragraph(formateador.format(tplan1), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tmplan += tplan1;

                    cell = new PdfPCell(new Paragraph(formateador.format(teje1), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    teje += teje1;
                    if (tpcua1 > 0) {
                        sum++;
                    }
                }

                if (tpplan2 > 0) {
                    cell = new PdfPCell(new Paragraph("OEI-2 ", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph(String.valueOf(tpplan2), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tplan += tpplan2;

                    cell = new PdfPCell(new Paragraph(String.valueOf(tpcua2), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tcuat += tpcua2;

                    if (!cuatrimestre.equals("0")) {
                        cell = new PdfPCell(new Paragraph(String.valueOf(tpeval2), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);
                        teval += tpeval2;
                    }

                    if (tpcua2 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(tefioe2) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefi += tefioe2;

                    if (tpcua2 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(teficoe2) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefic += teficoe2;

                    if (tpcua2 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(tefecoe2) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefe += tefecoe2;

                    cell = new PdfPCell(new Paragraph(formateador.format(tplan2), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tmplan += tplan2;

                    cell = new PdfPCell(new Paragraph(formateador.format(teje2), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    teje += teje2;
                    if (tpcua2 > 0) {
                        sum++;
                    }
                }

                if (tpplan3 > 0) {
                    cell = new PdfPCell(new Paragraph("OEI-3 ", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph(String.valueOf(tpplan3), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tplan += tpplan3;

                    cell = new PdfPCell(new Paragraph(String.valueOf(tpcua3), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tcuat += tpcua3;

                    if (!cuatrimestre.equals("0")) {
                        cell = new PdfPCell(new Paragraph(String.valueOf(tpeval3), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);
                        teval += tpeval3;
                    }

                    if (tpcua3 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(tefioe3) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefi += tefioe3;

                    if (tpcua3 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(teficoe3) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefic += teficoe3;

                    if (tpcua3 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(tefecoe3) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefe += tefecoe3;

                    cell = new PdfPCell(new Paragraph(formateador.format(tplan3), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tmplan += tplan3;

                    cell = new PdfPCell(new Paragraph(formateador.format(teje3), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    teje += teje3;
                    if (tpcua3 > 0) {
                        sum++;
                    }
                }

                if (tpplan4 > 0) {
                    cell = new PdfPCell(new Paragraph("OEI-4 ", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph(String.valueOf(tpplan4), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tplan += tpplan4;

                    cell = new PdfPCell(new Paragraph(String.valueOf(tpcua4), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tcuat += tpcua4;

                    if (!cuatrimestre.equals("0")) {
                        cell = new PdfPCell(new Paragraph(String.valueOf(tpeval4), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);
                        teval += tpeval4;
                    }

                    if (tpcua4 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(tefioe4) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefi += tefioe4;

                    if (tpcua4 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(teficoe4) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefic += teficoe4;

                    if (tpcua4 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(tefecoe4) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefe += tefecoe4;

                    cell = new PdfPCell(new Paragraph(formateador.format(tplan4), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tmplan += tplan4;

                    cell = new PdfPCell(new Paragraph(formateador.format(teje4), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    teje += teje4;
                    if (tpcua4 > 0) {
                        sum++;
                    }
                }

                cell = new PdfPCell(new Paragraph("TOTAL", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph(tplan + "", fuente3));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(3);
                cell.setBorderWidth(1);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph(tcuat + "", fuente3));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(3);
                cell.setBorderWidth(1);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                tablef.addCell(cell);

                if (!cuatrimestre.equals("0")) {
                    cell = new PdfPCell(new Paragraph(teval + "", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                }

                double tot, totefi, totefec;
                if (sum == 0) {
                    tot = tefi;
                    totefi = tefic;
                } else {
                    tot = tefi / sum;
                    totefi = tefic / sum;
                }
                BigDecimal efit = BigDecimal.valueOf(tot);
                BigDecimal efict = BigDecimal.valueOf(totefi);
                efit = efit.setScale(2, RoundingMode.HALF_UP);
                efict = efict.setScale(2, RoundingMode.HALF_UP);
                totefec = (efict.doubleValue() + efit.doubleValue());
                BigDecimal efec = BigDecimal.valueOf(totefec);
                efec = efec.setScale(2, RoundingMode.HALF_UP);
                cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue()) + "%", fuente3));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(3);
                cell.setBorderWidth(1);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                tablef.addCell(cell);

                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                    cell = new PdfPCell(new Paragraph(formateador.format(efict.doubleValue()) + "%", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph(formateador.format(efec.doubleValue() / 2) + "%", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph(formateador.format(tmplan), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph(formateador.format(teje), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                }

                document.add(tablef);
                document.add(new Paragraph(" "));
            }

            if (sarea.equals("0")) {
                for (int i = 0; i < resultareas.size(); i++) {
                    if (anio.equals("2020")) {
                        if (cuatrimestre.equals("0")) {
                            resultproyectos = aComp.ListaProyectoPOAEvalProyComp(resultareas.get(i).getAg_id(), Integer.parseInt(tipo), Integer.parseInt(anio));
                        } else {
                            resultproyectos = aComp.ListaProyectoPOAEvalProy(resultareas.get(i).getAg_id(), Integer.parseInt(tipo), Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                        }
                        if (resultproyectos.size() > 0) {
                            Chunk parte2 = new Chunk("Unidad Académica/Administrativa: " + resultareas.get(i).getAg_nombre(), fuen);
                            Paragraph para2 = new Paragraph();
                            para2.add(parte2);
                            para2.setAlignment(Element.ALIGN_CENTER);
                            document.add(para2);
                            document.add(new Paragraph(" "));

                            PdfPTable tablef;
                            if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                                tablef = new PdfPTable(9);
                                tablef.setTotalWidth(new float[]{80, 120, 70, 70, 70, 70, 70, 70, 70});
                                tablef.setLockedWidth(true);
                            } else {
                                tablef = new PdfPTable(5);
                                tablef.setTotalWidth(new float[]{170, 235, 100, 100, 85});
                                tablef.setLockedWidth(true);
                            }
                            PdfPCell cell;

                            cell = new PdfPCell(new Paragraph("CÓDIGO", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("PROYECTO", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("TIPO PROYECTO", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("EFICACIA", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                                cell = new PdfPCell(new Paragraph("EFICIENCIA", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph("EFECTIVIDAD", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph("PLANIFICADO", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph("EJECUCIÓN", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                            }

                            cell = new PdfPCell(new Paragraph("OBSERVACIÓN", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);
                            double totalf = 0, totalefi = 0, totalefe = 0, totaleje = 0, tmplan = 0;
                            int tot = 0;
                            for (int j = 0; j < resultproyectos.size(); j++) {
                                cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_codigo(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_nombre(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getTp_nombre(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                tablef.addCell(cell);

                                if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficacia()) + "%", fuente3));
                                    totalf += resultproyectos.get(j).getPe_eficacia();
                                    tot++;
                                } else {
                                    cell = new PdfPCell(new Paragraph("---", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                tablef.addCell(cell);

                                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                                    if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficiencia()) + "%", fuente3));
                                        totalefi += resultproyectos.get(j).getPe_eficiencia();
                                    } else {
                                        cell = new PdfPCell(new Paragraph("---", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);

                                    if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_efectividad()) + "%", fuente3));
                                        //totalefe += resultproyectos.get(j).getPe_efectividad();
                                    } else {
                                        cell = new PdfPCell(new Paragraph("---", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getProyecto_monto()), fuente3));
                                    tmplan += resultproyectos.get(j).getProyecto_monto();
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);

                                    if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_ejecucion()), fuente3));
                                        totaleje += resultproyectos.get(j).getPe_ejecucion();
                                    } else {
                                        cell = new PdfPCell(new Paragraph("---", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);
                                }

                                if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                    cell = new PdfPCell(new Paragraph("--", fuente3));
                                } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() < 0) {
                                    cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación", fuente3));
                                } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() == 0) {
                                    cell = new PdfPCell(new Paragraph("Proyecto no evaluado", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación en este periodo", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                tablef.addCell(cell);
                            }
                            cell = new PdfPCell(new Paragraph("TOTAL", fuentetitulo));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setColspan(3);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            BigDecimal efit = BigDecimal.valueOf(totalf);
                            BigDecimal efict = BigDecimal.valueOf(totalefi);
                            efit = efit.setScale(2, RoundingMode.HALF_UP);
                            efict = efict.setScale(2, RoundingMode.HALF_UP);
                            if (tot == 0) {
                                totalefe = ((efict.doubleValue()) + (efit.doubleValue()));
                            } else {
                                totalefe = ((efict.doubleValue() / tot) + (efit.doubleValue() / tot));
                            }
                            BigDecimal efec = BigDecimal.valueOf(totalefe);
                            efec = efec.setScale(2, RoundingMode.HALF_UP);

                            if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                                if (tot == 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                cell.setPadding(3);
                                tablef.addCell(cell);

                                if (tot == 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efict) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efict.doubleValue() / tot) + "%", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                cell.setPadding(3);
                                tablef.addCell(cell);

                                if (tot == 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efec) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efec.doubleValue() / 2) + "%", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                cell.setPadding(3);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph(formateador.format(tmplan), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                cell.setPadding(3);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph(formateador.format(totaleje), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                cell.setPadding(3);
                                cell.setColspan(2);
                                tablef.addCell(cell);
                            } else {
                                if (tot == 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setBorderWidth(1);
                                cell.setColspan(2);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                cell.setPadding(3);
                                tablef.addCell(cell);
                            }
                            document.add(tablef);
                            document.add(new Paragraph(" "));
                        }
                    } else {
                        if (tipo.equals("0")) {
                            oeii = 1;
                            oeif = 4;
                        } else {
                            oeii = Integer.parseInt(tipo);
                            oeif = Integer.parseInt(tipo);
                        }

                        String oenombre;
                        for (int oe = oeii; oe <= oeif; oe++) {
                            if (oe == 1) {
                                oenombre = "ACADÉMICO";
                            } else if (oe == 2) {
                                oenombre = "INVESTIGACIÓN";
                            } else if (oe == 3) {
                                oenombre = "VINCULACIÓN";
                            } else {
                                oenombre = "GESTIÓN";
                            }
                            if (cuatrimestre.equals("0")) {
                                resultproyectos = aComp.ListaProyectoPOAEvalProyComp(resultareas.get(i).getAg_id(), oe, Integer.parseInt(anio));
                            } else {
                                resultproyectos = aComp.ListaProyectoPOAEvalProy(resultareas.get(i).getAg_id(), oe, Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                            }
                            if (resultproyectos.size() > 0) {
                                Chunk parte2 = new Chunk("Unidad Académica/Administrativa: " + resultareas.get(i).getAg_nombre() + " - " + oenombre, fuen);
                                Paragraph para2 = new Paragraph();
                                para2.add(parte2);
                                para2.setAlignment(Element.ALIGN_CENTER);
                                document.add(para2);
                                document.add(new Paragraph(" "));

                                PdfPTable tablef;
                                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                                    tablef = new PdfPTable(9);
                                    tablef.setTotalWidth(new float[]{80, 120, 70, 70, 70, 70, 70, 70, 70});
                                    tablef.setLockedWidth(true);
                                } else {
                                    tablef = new PdfPTable(5);
                                    tablef.setTotalWidth(new float[]{170, 235, 100, 100, 85});
                                    tablef.setLockedWidth(true);
                                }
                                PdfPCell cell;

                                cell = new PdfPCell(new Paragraph("CÓDIGO", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph("PROYECTO", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph("TIPO PROYECTO", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph("EFICACIA", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                                    cell = new PdfPCell(new Paragraph("EFICIENCIA", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("EFECTIVIDAD", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("PLANIFICADO", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("EJECUCIÓN", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                }

                                cell = new PdfPCell(new Paragraph("OBSERVACIÓN", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                double totalf = 0, totalefi = 0, totalefe = 0, totaleje = 0, tmplan = 0;
                                int tot = 0;
                                for (int j = 0; j < resultproyectos.size(); j++) {
                                    cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_codigo(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_nombre(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getTp_nombre(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);

                                    if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficacia()) + "%", fuente3));
                                        totalf += resultproyectos.get(j).getPe_eficacia();
                                        tot++;
                                    } else {
                                        cell = new PdfPCell(new Paragraph("---", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);

                                    if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                                        if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficiencia()) + "%", fuente3));
                                            totalefi += resultproyectos.get(j).getPe_eficiencia();
                                        } else {
                                            cell = new PdfPCell(new Paragraph("---", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);

                                        if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_efectividad()) + "%", fuente3));
                                            //totalefe += resultproyectos.get(j).getPe_efectividad();
                                        } else {
                                            cell = new PdfPCell(new Paragraph("---", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getProyecto_monto()), fuente3));
                                        tmplan += resultproyectos.get(j).getProyecto_monto();
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);

                                        if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_ejecucion()), fuente3));
                                            totaleje += resultproyectos.get(j).getPe_ejecucion();
                                        } else {
                                            cell = new PdfPCell(new Paragraph("---", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);
                                    }

                                    if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                        cell = new PdfPCell(new Paragraph("--", fuente3));
                                    } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() < 0) {
                                        cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación", fuente3));
                                    } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() == 0) {
                                        cell = new PdfPCell(new Paragraph("Proyecto no evaluado", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación en este periodo", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);
                                }
                                cell = new PdfPCell(new Paragraph("TOTAL", fuentetitulo));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setColspan(3);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                BigDecimal efit = BigDecimal.valueOf(totalf);
                                BigDecimal efict = BigDecimal.valueOf(totalefi);
                                efit = efit.setScale(2, RoundingMode.HALF_UP);
                                efict = efict.setScale(2, RoundingMode.HALF_UP);
                                if (tot == 0) {
                                    totalefe = ((efict.doubleValue()) + (efit.doubleValue()));
                                } else {
                                    totalefe = ((efict.doubleValue() / tot) + (efit.doubleValue() / tot));
                                }
                                BigDecimal efec = BigDecimal.valueOf(totalefe);
                                efec = efec.setScale(2, RoundingMode.HALF_UP);

                                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                                    if (tot == 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);

                                    if (tot == 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efict) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efict.doubleValue() / tot) + "%", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);

                                    if (tot == 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efec) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efec.doubleValue() / 2) + "%", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(formateador.format(tmplan), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(formateador.format(totaleje), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    cell.setColspan(2);
                                    tablef.addCell(cell);
                                } else {
                                    if (tot == 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setColspan(2);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);
                                }
                                document.add(tablef);
                                document.add(new Paragraph(" "));
                            }
                        }
                    }
                }
            } else {
                if (anio.equals("2020")) {
                    if (cuatrimestre.equals("0")) {
                        resultproyectos = aComp.ListaProyectoPOAEvalProyComp(Integer.parseInt(sarea), Integer.parseInt(tipo), Integer.parseInt(anio));
                    } else {
                        resultproyectos = aComp.ListaProyectoPOAEvalProy(Integer.parseInt(sarea), Integer.parseInt(tipo), Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                    }
                    if (resultproyectos.size() > 0) {
                        Chunk parte2 = new Chunk("DETALLE POR PROYECTOS", fuen);
                        Paragraph para2 = new Paragraph();
                        para2.add(parte2);
                        para2.setAlignment(Element.ALIGN_CENTER);
                        document.add(para2);
                        document.add(new Paragraph(" "));

                        PdfPTable tablef;
                        if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                            tablef = new PdfPTable(9);
                            tablef.setTotalWidth(new float[]{80, 120, 70, 70, 70, 70, 70, 70, 70});
                            tablef.setLockedWidth(true);
                        } else {
                            tablef = new PdfPTable(5);
                            tablef.setTotalWidth(new float[]{170, 235, 100, 100, 85});
                            tablef.setLockedWidth(true);
                        }
                        PdfPCell cell;

                        cell = new PdfPCell(new Paragraph("CÓDIGO", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph("PROYECTO", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph("TIPO PROYECTO", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph("EFICACIA", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                            cell = new PdfPCell(new Paragraph("EFICIENCIA", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("EFECTIVIDAD", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("PLANIFICADO", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("EJECUCIÓN", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);
                        }

                        cell = new PdfPCell(new Paragraph("OBSERVACIÓN", fuentetexto));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);
                        double totalf = 0, totalefi = 0, totalefe = 0, totaleje = 0, tmplan = 0;
                        int tot = 0;
                        for (int j = 0; j < resultproyectos.size(); j++) {
                            cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_codigo(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_nombre(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getTp_nombre(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                            tablef.addCell(cell);

                            if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficacia()) + "%", fuente3));
                                totalf += resultproyectos.get(j).getPe_eficacia();
                                tot++;
                            } else {
                                cell = new PdfPCell(new Paragraph("---", fuente3));
                            }
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                            tablef.addCell(cell);

                            if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                                if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficiencia()) + "%", fuente3));
                                    totalefi += resultproyectos.get(j).getPe_eficiencia();
                                } else {
                                    cell = new PdfPCell(new Paragraph("---", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                tablef.addCell(cell);

                                if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_efectividad()) + "%", fuente3));
                                    // totalefe += resultproyectos.get(j).getPe_efectividad();
                                } else {
                                    cell = new PdfPCell(new Paragraph("---", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getProyecto_monto()), fuente3));
                                tmplan += resultproyectos.get(j).getProyecto_monto();
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                tablef.addCell(cell);

                                if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_ejecucion()), fuente3));
                                    totaleje += resultproyectos.get(j).getPe_ejecucion();
                                } else {
                                    cell = new PdfPCell(new Paragraph("---", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                tablef.addCell(cell);
                            }

                            if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                cell = new PdfPCell(new Paragraph("--", fuente3));
                            } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() < 0) {
                                cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación", fuente3));
                            } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() == 0) {
                                cell = new PdfPCell(new Paragraph("Proyecto no evaluado", fuente3));
                            } else {
                                cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación en este periodo", fuente3));
                            }
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                            tablef.addCell(cell);
                        }
                        cell = new PdfPCell(new Paragraph("TOTAL", fuentetitulo));
                        cell.setPadding(5);
                        cell.setBackgroundColor(azul);
                        cell.setBorderWidthRight(1);
                        cell.setColspan(3);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        BigDecimal efit = BigDecimal.valueOf(totalf);
                        BigDecimal efict = BigDecimal.valueOf(totalefi);
                        efit = efit.setScale(2, RoundingMode.HALF_UP);
                        efict = efict.setScale(2, RoundingMode.HALF_UP);
                        if (tot == 0) {
                            totalefe = ((efict.doubleValue()) + (efit.doubleValue()));
                        } else {
                            totalefe = ((efict.doubleValue() / tot) + (efit.doubleValue() / tot));
                        }
                        BigDecimal efec = BigDecimal.valueOf(totalefe);
                        efec = efec.setScale(2, RoundingMode.HALF_UP);

                        if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                            if (tot == 0) {
                                cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                            } else {
                                cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                            }
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            cell.setPadding(3);
                            tablef.addCell(cell);

                            if (tot == 0) {
                                cell = new PdfPCell(new Paragraph(formateador.format(efict) + "%", fuente3));
                            } else {
                                cell = new PdfPCell(new Paragraph(formateador.format(efict.doubleValue() / tot) + "%", fuente3));
                            }
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            cell.setPadding(3);
                            tablef.addCell(cell);

                            if (tot == 0) {
                                cell = new PdfPCell(new Paragraph(formateador.format(efec) + "%", fuente3));
                            } else {
                                cell = new PdfPCell(new Paragraph(formateador.format(efec.doubleValue() / 2) + "%", fuente3));
                            }
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            cell.setPadding(3);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph(formateador.format(tmplan), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            cell.setPadding(3);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph(formateador.format(totaleje), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            cell.setPadding(3);
                            cell.setColspan(2);
                            tablef.addCell(cell);
                        } else {
                            if (tot == 0) {
                                cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                            } else {
                                cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                            }
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setBorderWidth(1);
                            cell.setColspan(2);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            cell.setPadding(3);
                            tablef.addCell(cell);
                        }
                        document.add(tablef);
                        document.add(new Paragraph(" "));
                    }
                } else {
                    if (tipo.equals("0")) {
                        oeii = 1;
                        oeif = 4;
                    } else {
                        oeii = Integer.parseInt(tipo);
                        oeif = Integer.parseInt(tipo);
                    }

                    String oenombre;
                    for (int oe = oeii; oe <= oeif; oe++) {
                        if (cuatrimestre.equals("0")) {
                            resultproyectos = aComp.ListaProyectoPOAEvalProyComp(Integer.parseInt(sarea), oe, Integer.parseInt(anio));
                        } else {
                            resultproyectos = aComp.ListaProyectoPOAEvalProy(Integer.parseInt(sarea), oe, Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                        }
                        if (oe == 1) {
                            oenombre = "ACADÉMICO";
                        } else if (oe == 2) {
                            oenombre = "INVESTIGACIÓN";
                        } else if (oe == 3) {
                            oenombre = "VINCULACIÓN";
                        } else {
                            oenombre = "GESTIÓN";
                        }
                        if (resultproyectos.size() > 0) {
                            Chunk parte2 = new Chunk("DETALLE POR PROYECTOS - " + oenombre, fuen);
                            Paragraph para2 = new Paragraph();
                            para2.add(parte2);
                            para2.setAlignment(Element.ALIGN_CENTER);
                            document.add(para2);
                            document.add(new Paragraph(" "));

                            PdfPTable tablef;
                            tablef = new PdfPTable(9);
                            tablef.setTotalWidth(new float[]{80, 120, 70, 70, 70, 70, 70, 70, 70});
                            tablef.setLockedWidth(true);
                            PdfPCell cell;

                            cell = new PdfPCell(new Paragraph("CÓDIGO", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("PROYECTO", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("TIPO PROYECTO", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("EFICACIA", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("EFICIENCIA", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("EFECTIVIDAD", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("PLANIFICADO", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("EJECUCIÓN", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("OBSERVACIÓN", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);
                            double totalf = 0, totalefi = 0, totalefe = 0, totaleje = 0, tmplan = 0;
                            int tot = 0;
                            for (int j = 0; j < resultproyectos.size(); j++) {
                                cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_codigo(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_nombre(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getTp_nombre(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                tablef.addCell(cell);

                                if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficacia()) + "%", fuente3));
                                    totalf += resultproyectos.get(j).getPe_eficacia();
                                    tot++;
                                } else {
                                    cell = new PdfPCell(new Paragraph("---", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                tablef.addCell(cell);

                                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                                    if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficiencia()) + "%", fuente3));
                                        totalefi += resultproyectos.get(j).getPe_eficiencia();
                                    } else {
                                        cell = new PdfPCell(new Paragraph("---", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);

                                    if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_efectividad()) + "%", fuente3));
                                        // totalefe += resultproyectos.get(j).getPe_efectividad();
                                    } else {
                                        cell = new PdfPCell(new Paragraph("---", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getProyecto_monto()), fuente3));
                                    tmplan += resultproyectos.get(j).getProyecto_monto();
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);

                                    if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_ejecucion()), fuente3));
                                        totaleje += resultproyectos.get(j).getPe_ejecucion();
                                    } else {
                                        cell = new PdfPCell(new Paragraph("---", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);
                                }

                                if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                    cell = new PdfPCell(new Paragraph("--", fuente3));
                                } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() < 0) {
                                    cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación", fuente3));
                                } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() == 0) {
                                    cell = new PdfPCell(new Paragraph("Proyecto no evaluado", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación en este periodo", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                tablef.addCell(cell);
                            }
                            cell = new PdfPCell(new Paragraph("TOTAL", fuentetitulo));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setColspan(3);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            BigDecimal efit = BigDecimal.valueOf(totalf);
                            BigDecimal efict = BigDecimal.valueOf(totalefi);
                            efit = efit.setScale(2, RoundingMode.HALF_UP);
                            efict = efict.setScale(2, RoundingMode.HALF_UP);
                            if (tot == 0) {
                                totalefe = ((efict.doubleValue()) + (efit.doubleValue()));
                            } else {
                                totalefe = ((efict.doubleValue() / tot) + (efit.doubleValue() / tot));
                            }
                            BigDecimal efec = BigDecimal.valueOf(totalefe);
                            efec = efec.setScale(2, RoundingMode.HALF_UP);

                            if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || anio.equals("2021")) {
                                if (tot == 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                cell.setPadding(3);
                                tablef.addCell(cell);

                                if (tot == 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efict) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efict.doubleValue() / tot) + "%", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                cell.setPadding(3);
                                tablef.addCell(cell);

                                if (tot == 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efec) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efec.doubleValue() / 2) + "%", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                cell.setPadding(3);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph(formateador.format(tmplan), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                cell.setPadding(3);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph(formateador.format(totaleje), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                cell.setPadding(3);
                                cell.setColspan(2);
                                tablef.addCell(cell);
                            } else {
                                if (tot == 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setBorderWidth(1);
                                cell.setColspan(2);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                cell.setPadding(3);
                                tablef.addCell(cell);
                            }
                            document.add(tablef);
                            document.add(new Paragraph(" "));
                        }
                    }
                }
            }
            if (tipousu.equals("2") || tipousu.equals("4") || tipousu.equals("5") || tipousu.equals("7") || tipousu.equals("8") || tipousu.equals("19")) {
                document.add(new Paragraph(" "));
                document.add(new Paragraph(" "));
                List<cProyecto> resul = new ArrayList<cProyecto>();
                resul = accAg.listaDirectores(Integer.parseInt(ag));
                PdfPTable tablef2 = new PdfPTable(1);
                tablef2.setTotalWidth(new float[]{500});
                tablef2.setLockedWidth(true);
                PdfPCell cell;

                cell = new PdfPCell(new Paragraph("____________________________", fuent));
                cell.setPadding(5);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthLeft(1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthTop(1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                tablef2.addCell(cell);

                cell = new PdfPCell(new Paragraph(resul.get(0).getProyecto_codigo() + " " + resul.get(0).getProyecto_nombre(), fuent));
                cell.setPadding(5);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthLeft(1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthTop(1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                tablef2.addCell(cell);

                try {
                    if (resul.get(0).getProyecto_integrantes().isEmpty()) {
                        cell = new PdfPCell(new Paragraph(resul.get(0).getProyecto_doc(), fuent));
                    } else {
                        cell = new PdfPCell(new Paragraph(resul.get(0).getProyecto_integrantes(), fuent));
                    }
                } catch (Exception e) {
                    cell = new PdfPCell(new Paragraph(resul.get(0).getProyecto_doc(), fuent));
                }
                cell.setPadding(5);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthLeft(1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthTop(1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                tablef2.addCell(cell);

                document.add(tablef2);
            }
        } catch (DocumentException de) {
            de.printStackTrace();
            System.err.println("document: " + de.getMessage());
            System.err.println("error: " + de.getMessage());
        }
// Paso: Cerramos el ‘document (el ‘outputstream’ se cierra automáticamente internamente)
        document.close();
    }

    private void reportePOAEvalAdmin(HttpServletRequest request, HttpServletResponse response) throws FileNotFoundException, IOException, DocumentException {
        //Document document = new Document(PageSize.LETTER, 25, 25, 140, 50);
        Document document = new Document(PageSize.LETTER.rotate(), 39, 36, 132, 67);
        DecimalFormat formateador = new DecimalFormat("####,###,##0.00");
        try {
            String path = getServletContext().getRealPath("/") + "img/reporte/";
            String pathimg = getServletContext().getRealPath("/") + "img/reporte/";
// Paso 2: Establecemos el ContentType y creamos una instancia del Writer
            response.setContentType("application/pdf");
            String ag = request.getParameter("agidpoa");
            String titu = request.getParameter("agtitulopoa");
            String alias = request.getParameter("agaliaspoa");
            String tipousu = request.getParameter("tipusuarioeval");
            String nombre;
            String sarea = request.getParameter("selectareas");
            String tipo = request.getParameter("selecttipo");
            String cuatrimestre = request.getParameter("cuatrim");
            String anio = request.getParameter("selectanio");
            List<cAreaGestion> resultareas = new ArrayList<cAreaGestion>();
            //Lista de presupuesto
            List<cAreaGestion> resultunidadespadre = new ArrayList<cAreaGestion>();
            List<cProyecto> resultunidades = new ArrayList<cProyecto>();
            List<cProyecto> resultproyectos = new ArrayList<cProyecto>();
            adAreaGestion accAg = new adAreaGestion();
            adProyecto aComp = new adProyecto();
            if (sarea.equals("0")) {
                nombre = request.getParameter("agnombrepoa");
            } else {
                resultareas = accAg.obtenerAreasGestionUnidades(Integer.parseInt(sarea));
                nombre = resultareas.get(0).getAg_nombre();
            }
            String titulo;
            if (cuatrimestre.equals("0")) {
                titulo = "EVALUACIÓN FINAL " + anio + " - " + titu;
            } else {
                titulo = "EVALUACIÓN " + cuatrimestre + " CUATRIMESTRE " + anio + " - " + titu;
            }
            OutputStream file = new FileOutputStream(new File(path + "POAEVALUACION" + anio + "-" + alias + ".pdf"));
            PdfWriter writer = PdfWriter.getInstance(document, response.getOutputStream());
            //PdfWriter writer2 = PdfWriter.getInstance(document, file);
            formatoReporteH eventos = new formatoReporteH(path, titulo, pathimg + "LOGO-PEDI.gif");

            writer.setPageEvent(eventos);
            //writer2.setPageEvent(eventos);
// Paso 3
            document.open();
// Paso 4
            if (cuatrimestre.equals("0")) {
                document.addTitle("EVALUACIÓN FINAL " + alias);
            } else {
                document.addTitle("EVALUACIÓN " + cuatrimestre + " CUATRIMESTRE " + alias);
            }

            Date date = Calendar.getInstance().getTime();
            DateFormat formatter = new SimpleDateFormat("dd/MM/yyyy, hh:mm:ss a");
            String today = formatter.format(date);

            Font fuente = new Font();
            fuente.setSize(10);
            Font fuen = new Font(Font.FontFamily.TIMES_ROMAN, 14, 1);
            Font fuent = new Font(Font.FontFamily.TIMES_ROMAN, 12, 1);
            Font fuente3 = new Font(Font.FontFamily.TIMES_ROMAN, 7, 0, BaseColor.BLACK);
            Font fuentetitulo = new Font(Font.FontFamily.TIMES_ROMAN, 8, 1, BaseColor.WHITE);
            Font fuentetexto = new Font(Font.FontFamily.TIMES_ROMAN, 7, 1, BaseColor.WHITE);

            int oeii, oeif;
            if (tipo.equals("0")) {
                oeii = 1;
                oeif = 4;
            } else {
                oeii = Integer.parseInt(tipo);
                oeif = Integer.parseInt(tipo);
            }

            double tefioe1 = 0, teficoe1 = 0, tefecoe1 = 0, tplan1 = 0, teje1 = 0;
            int tpplan1 = 0, tpcua1 = 0, tpeval1 = 0;
            double tefioe2 = 0, teficoe2 = 0, tefecoe2 = 0, tplan2 = 0, teje2 = 0;
            int tpplan2 = 0, tpcua2 = 0, tpeval2 = 0;
            double tefioe3 = 0, teficoe3 = 0, tefecoe3 = 0, tplan3 = 0, teje3 = 0;
            int tpplan3 = 0, tpcua3 = 0, tpeval3 = 0;
            double tefioe4 = 0, teficoe4 = 0, tefecoe4 = 0, tplan4 = 0, teje4 = 0;
            int tpplan4 = 0, tpcua4 = 0, tpeval4 = 0;

            BaseColor azul = WebColors.getRGBColor("#133351");
            if (anio.equals("2020")) {
                if (sarea.equals("0") && !tipousu.equals("16") && !tipousu.equals("17") && !cuatrimestre.equals("0")) {
                    resultunidades = aComp.ListaProyectoPOAEvalAdmin(Integer.parseInt(ag), Integer.parseInt(tipo), Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                    resultareas = accAg.obtenerAreasGestionUnidadesEval();
                } else if (sarea.equals("0") && !tipousu.equals("16") && !tipousu.equals("17") && cuatrimestre.equals("0")) {
                    resultunidades = aComp.ListaProyectoPOAEvalAdminComp(Integer.parseInt(ag), Integer.parseInt(tipo), Integer.parseInt(anio));
                    resultareas = accAg.obtenerAreasGestionUnidadesEval();
                } else if (sarea.equals("0") && (tipousu.equals("16") || tipousu.equals("17")) && !cuatrimestre.equals("0")) {
                    resultunidades = aComp.ListaProyectoPOAEvalAdmin(0, Integer.parseInt(tipo), Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                    if (tipousu.equals("16")) {
                        resultareas = accAg.obtenerAreasGestionUnidadesEvalIV(47);
                    } else {
                        resultareas = accAg.obtenerAreasGestionUnidadesEvalIV(48);
                    }
                } else if (sarea.equals("0") && (tipousu.equals("16") || tipousu.equals("17")) && cuatrimestre.equals("0")) {
                    resultunidades = aComp.ListaProyectoPOAEvalAdminComp(0, Integer.parseInt(tipo), Integer.parseInt(anio));
                    if (tipousu.equals("16")) {
                        resultareas = accAg.obtenerAreasGestionUnidadesEvalIV(47);
                    } else {
                        resultareas = accAg.obtenerAreasGestionUnidadesEvalIV(48);
                    }
                } else if (cuatrimestre.equals("0")) {
                    resultunidades = aComp.ListaProyectoPOAEvalAdminComp(Integer.parseInt(sarea), Integer.parseInt(tipo), Integer.parseInt(anio));
                    resultareas = accAg.obtenerAreasGestionUnidades(Integer.parseInt(sarea));
                } else {
                    resultunidades = aComp.ListaProyectoPOAEvalAdmin(Integer.parseInt(sarea), Integer.parseInt(tipo), Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                    resultareas = accAg.obtenerAreasGestionUnidades(Integer.parseInt(sarea));
                }

                String tnombre;
                if (tipo.equals("1")) {
                    tnombre = "OEI-01 ";
                } else if (tipo.equals("2")) {
                    tnombre = "OEI-02 ";
                } else if (tipo.equals("3")) {
                    tnombre = "OEI-03 ";
                } else if (tipo.equals("4")) {
                    tnombre = "OEI-04 ";
                } else {
                    tnombre = "";
                }
                if (resultunidades.size() > 0) {
                    Chunk parte2;
                    if (cuatrimestre.equals("0")) {
                        if (resultunidades.size() < 2) {

                            parte2 = new Chunk("EVALUACIÓN FINAL " + tnombre + resultunidades.get(0).getProyecto_nombre(), fuen);
                        } else {
                            parte2 = new Chunk("EVALUACIÓN FINAL " + tnombre + nombre, fuen);
                        }
                    } else {
                        if (resultunidades.size() < 2) {
                            parte2 = new Chunk("EVALUACIÓN " + cuatrimestre + " CUATRIMESTRE " + tnombre + resultunidades.get(0).getProyecto_nombre(), fuen);
                        } else {
                            parte2 = new Chunk("EVALUACIÓN " + cuatrimestre + " CUATRIMESTRE " + tnombre + nombre, fuen);
                        }
                    }
                    Paragraph para2 = new Paragraph();
                    para2.add(parte2);
                    para2.setAlignment(Element.ALIGN_CENTER);
                    document.add(para2);
                    document.add(new Paragraph(" "));

                    PdfPTable tablef;
                    if (cuatrimestre.equals("0")) {
                        tablef = new PdfPTable(8);
                        tablef.setTotalWidth(new float[]{180, 80, 70, 70, 70, 70, 80, 80});
                        tablef.setLockedWidth(true);
                    } else if (cuatrimestre.equals("3") || !anio.equals("2020")) {
                        tablef = new PdfPTable(9);
                        tablef.setTotalWidth(new float[]{140, 70, 70, 70, 70, 70, 70, 70, 70});
                        tablef.setLockedWidth(true);
                    } else {
                        tablef = new PdfPTable(5);
                        tablef.setTotalWidth(new float[]{230, 115, 115, 120, 120});
                        tablef.setLockedWidth(true);
                    }

                    PdfPCell cell;
                    cell = new PdfPCell(new Paragraph("UNIDAD", fuentetitulo));
                    cell.setBackgroundColor(azul);
                    cell.setPadding(5);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setBorderWidthBottom(1);
                    cell.setBorderColorBottom(BaseColor.WHITE);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("#PROYECTOS PLANIFICADOS", fuentetitulo));
                    cell.setBackgroundColor(azul);
                    cell.setPadding(5);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph("#EJECUTADO CUATRIMESTRE", fuentetitulo));
                    cell.setBackgroundColor(azul);
                    cell.setPadding(5);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    tablef.addCell(cell);

                    if (!cuatrimestre.equals("0")) {
                        cell = new PdfPCell(new Paragraph("#PROYECTOS EVALUADOS", fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        tablef.addCell(cell);
                    }

                    cell = new PdfPCell(new Paragraph("EFICACIA", fuentetitulo));
                    cell.setBackgroundColor(azul);
                    cell.setPadding(5);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setBorderWidthBottom(1);
                    cell.setBorderColorBottom(BaseColor.WHITE);
                    tablef.addCell(cell);

                    if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                        cell = new PdfPCell(new Paragraph("EFICIENCIA", fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthBottom(1);
                        cell.setBorderColorBottom(BaseColor.WHITE);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph("EFECTIVIDAD", fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthBottom(1);
                        cell.setBorderColorBottom(BaseColor.WHITE);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph("PLANIFICADO", fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthBottom(1);
                        cell.setBorderColorBottom(BaseColor.WHITE);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph("EJECUCIÓN", fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthBottom(1);
                        cell.setBorderColorBottom(BaseColor.WHITE);
                        tablef.addCell(cell);
                    }

                    double tefi = 0, tefic = 0, tefe = 0, teje = 0, tmplan = 0;
                    int tplan = 0, tcuat = 0, teval = 0, sum = 0;
                    if (sarea.equals("0")) {
                        for (int j = 0; j < resultunidades.size(); j++) {
                            cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_nombre(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_planificados().toString(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);
                            tplan += resultunidades.get(j).getProyecto_planificados();

                            if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                sum++;
                            }
                            cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_plurianual().toString(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);
                            tcuat += resultunidades.get(j).getProyecto_plurianual();

                            if (!cuatrimestre.equals("0")) {
                                cell = new PdfPCell(new Paragraph(resultunidades.get(j).getPp_id().toString(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                teval += resultunidades.get(j).getPp_id();
                            }

                            if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficacia()) + "%", fuente3));
                            } else {
                                cell = new PdfPCell(new Paragraph("--", fuente3));
                            }
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);
                            tefi += resultunidades.get(j).getPe_eficacia();

                            if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficiencia()) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph("--", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tefic += resultunidades.get(j).getPe_eficiencia();

                                if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_efectividad()) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph("--", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tefe += resultunidades.get(j).getPe_efectividad();

                                cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getProyecto_monto()), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tmplan += resultunidades.get(j).getProyecto_monto();

                                cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_ejecucion()), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                teje += resultunidades.get(j).getPe_ejecucion();
                            }
                        }
                    } else if (sarea.equals(ag)) {
                        for (int j = 0; j < resultunidades.size(); j++) {
                            if (resultunidades.get(j).getProyecto_nombre().equals(nombre)) {
                                cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_nombre(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_planificados().toString(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tplan += resultunidades.get(j).getProyecto_planificados();

                                if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                    sum++;
                                }
                                cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_plurianual().toString(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tcuat += resultunidades.get(j).getProyecto_plurianual();

                                if (!cuatrimestre.equals("0")) {
                                    cell = new PdfPCell(new Paragraph(resultunidades.get(j).getPp_id().toString(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    teval += resultunidades.get(j).getPp_id();
                                }

                                if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficacia()) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph("--", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tefi += resultunidades.get(j).getPe_eficacia();

                                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                    if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficiencia()) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph("--", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tefic += resultunidades.get(j).getPe_eficiencia();

                                    if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_efectividad()) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph("--", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tefe += resultunidades.get(j).getPe_efectividad();

                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getProyecto_monto()), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tmplan += resultunidades.get(j).getProyecto_monto();

                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_ejecucion()), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    teje += resultunidades.get(j).getPe_ejecucion();
                                }
                            }
                        }
                    } else {
                        for (int j = 0; j < resultunidades.size(); j++) {
                            cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_nombre(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_planificados().toString(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);
                            tplan += resultunidades.get(j).getProyecto_planificados();

                            if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                sum++;
                            }
                            cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_plurianual().toString(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);
                            tcuat += resultunidades.get(j).getProyecto_plurianual();

                            if (!cuatrimestre.equals("0")) {
                                cell = new PdfPCell(new Paragraph(resultunidades.get(j).getPp_id().toString(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                teval += resultunidades.get(j).getPp_id();
                            }

                            if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficacia()) + "%", fuente3));
                            } else {
                                cell = new PdfPCell(new Paragraph("--", fuente3));
                            }
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);
                            tefi += resultunidades.get(j).getPe_eficacia();

                            if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficiencia()) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph("--", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tefic += resultunidades.get(j).getPe_eficiencia();

                                if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_efectividad()) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph("--", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tefe += resultunidades.get(j).getPe_efectividad();

                                cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getProyecto_monto()), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tmplan += resultunidades.get(j).getProyecto_monto();

                                cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_ejecucion()), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                teje += resultunidades.get(j).getPe_ejecucion();
                            }
                        }
                    }
                    cell = new PdfPCell(new Paragraph("TOTAL", fuentetitulo));
                    cell.setBackgroundColor(azul);
                    cell.setPadding(5);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph(tplan + "", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph(tcuat + "", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    if (!cuatrimestre.equals("0")) {
                        cell = new PdfPCell(new Paragraph(teval + "", fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);
                    }

                    double tot, totefi, totefec;
                    if (sum == 0) {
                        tot = tefi;
                        totefi = tefic;
                    } else {
                        tot = tefi / sum;
                        totefi = tefic / sum;
                    }
                    BigDecimal efit = BigDecimal.valueOf(tot);
                    BigDecimal efict = BigDecimal.valueOf(totefi);
                    efit = efit.setScale(2, RoundingMode.HALF_UP);
                    efict = efict.setScale(2, RoundingMode.HALF_UP);
                    totefec = (efict.doubleValue() + efit.doubleValue());
                    BigDecimal efec = BigDecimal.valueOf(totefec);
                    efec = efec.setScale(2, RoundingMode.HALF_UP);

                    cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue()) + "%", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                        cell = new PdfPCell(new Paragraph(formateador.format(efict.doubleValue()) + "%", fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(formateador.format(efec.doubleValue() / 2) + "%", fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(formateador.format(tmplan), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(formateador.format(teje), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);
                    }

                    document.add(tablef);
                    document.add(new Paragraph(" "));
                }
            } else {
                for (int i = oeii; i <= oeif; i++) {
                    if (sarea.equals("0") && !tipousu.equals("16") && !tipousu.equals("17") && !cuatrimestre.equals("0")) {
                        resultunidades = aComp.ListaProyectoPOAEvalAdmin(Integer.parseInt(ag), i, Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                        resultareas = accAg.obtenerAreasGestionUnidadesEval();
                    } else if (sarea.equals("0") && !tipousu.equals("16") && !tipousu.equals("17") && cuatrimestre.equals("0")) {
                        resultunidades = aComp.ListaProyectoPOAEvalAdminComp(Integer.parseInt(ag), i, Integer.parseInt(anio));
                        resultareas = accAg.obtenerAreasGestionUnidadesEval();
                    } else if (sarea.equals("0") && (tipousu.equals("16") || tipousu.equals("17")) && !cuatrimestre.equals("0")) {
                        resultunidades = aComp.ListaProyectoPOAEvalAdmin(0, i, Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                        if (tipousu.equals("16")) {
                            resultareas = accAg.obtenerAreasGestionUnidadesEvalIV(47);
                        } else {
                            resultareas = accAg.obtenerAreasGestionUnidadesEvalIV(48);
                        }
                    } else if (sarea.equals("0") && (tipousu.equals("16") || tipousu.equals("17")) && cuatrimestre.equals("0")) {
                        resultunidades = aComp.ListaProyectoPOAEvalAdminComp(0, i, Integer.parseInt(anio));
                        if (tipousu.equals("16")) {
                            resultareas = accAg.obtenerAreasGestionUnidadesEvalIV(47);
                        } else {
                            resultareas = accAg.obtenerAreasGestionUnidadesEvalIV(48);
                        }
                    } else if (cuatrimestre.equals("0")) {
                        resultunidades = aComp.ListaProyectoPOAEvalAdminComp(Integer.parseInt(sarea), i, Integer.parseInt(anio));
                        resultareas = accAg.obtenerAreasGestionUnidades(Integer.parseInt(sarea));
                    } else {
                        resultunidades = aComp.ListaProyectoPOAEvalAdmin(Integer.parseInt(sarea), i, Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                        resultareas = accAg.obtenerAreasGestionUnidades(Integer.parseInt(sarea));
                    }

                    String tnombre;
                    switch (i) {
                        case 1:
                            tnombre = "OEI-01 ";
                            break;
                        case 2:
                            tnombre = "OEI-02 ";
                            break;
                        case 3:
                            tnombre = "OEI-03 ";
                            break;
                        case 4:
                            tnombre = "OEI-04 ";
                            break;
                        default:
                            tnombre = "";
                            break;
                    }
                    if (resultunidades.size() > 0) {
                        Chunk parte2;
                        if (cuatrimestre.equals("0")) {
                            if (resultunidades.size() < 2) {
                                parte2 = new Chunk("EVALUACIÓN FINAL " + tnombre + resultunidades.get(0).getProyecto_nombre(), fuen);
                            } else {
                                parte2 = new Chunk("EVALUACIÓN FINAL " + tnombre + nombre, fuen);
                            }
                        } else {
                            if (resultunidades.size() < 2) {
                                parte2 = new Chunk("EVALUACIÓN " + cuatrimestre + " CUATRIMESTRE " + tnombre + resultunidades.get(0).getProyecto_nombre(), fuen);
                            } else {
                                parte2 = new Chunk("EVALUACIÓN " + cuatrimestre + " CUATRIMESTRE " + tnombre + nombre, fuen);
                            }
                        }
                        Paragraph para2 = new Paragraph();
                        para2.add(parte2);
                        para2.setAlignment(Element.ALIGN_CENTER);
                        document.add(para2);
                        document.add(new Paragraph(" "));

                        PdfPTable tablef;
                        if (cuatrimestre.equals("0")) {
                            tablef = new PdfPTable(8);
                            tablef.setTotalWidth(new float[]{180, 80, 70, 70, 70, 70, 80, 80});
                            tablef.setLockedWidth(true);
                        } else if (cuatrimestre.equals("3") || !anio.equals("2020")) {
                            tablef = new PdfPTable(9);
                            tablef.setTotalWidth(new float[]{140, 70, 70, 70, 70, 70, 70, 70, 70});
                            tablef.setLockedWidth(true);
                        } else {
                            tablef = new PdfPTable(5);
                            tablef.setTotalWidth(new float[]{230, 115, 115, 120, 120});
                            tablef.setLockedWidth(true);
                        }

                        PdfPCell cell;
                        cell = new PdfPCell(new Paragraph("UNIDAD", fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthBottom(1);
                        cell.setBorderColorBottom(BaseColor.WHITE);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph("#PROYECTOS PLANIFICADOS", fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph("#EJECUTADO CUATRIMESTRE", fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        tablef.addCell(cell);

                        if (!cuatrimestre.equals("0")) {
                            cell = new PdfPCell(new Paragraph("#PROYECTOS EVALUADOS", fuentetitulo));
                            cell.setBackgroundColor(azul);
                            cell.setPadding(5);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            tablef.addCell(cell);
                        }

                        cell = new PdfPCell(new Paragraph("EFICACIA", fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthBottom(1);
                        cell.setBorderColorBottom(BaseColor.WHITE);
                        tablef.addCell(cell);

                        if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                            cell = new PdfPCell(new Paragraph("EFICIENCIA", fuentetitulo));
                            cell.setBackgroundColor(azul);
                            cell.setPadding(5);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setBorderWidthBottom(1);
                            cell.setBorderColorBottom(BaseColor.WHITE);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("EFECTIVIDAD", fuentetitulo));
                            cell.setBackgroundColor(azul);
                            cell.setPadding(5);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setBorderWidthBottom(1);
                            cell.setBorderColorBottom(BaseColor.WHITE);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("PLANIFICADO", fuentetitulo));
                            cell.setBackgroundColor(azul);
                            cell.setPadding(5);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setBorderWidthBottom(1);
                            cell.setBorderColorBottom(BaseColor.WHITE);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("EJECUCIÓN", fuentetitulo));
                            cell.setBackgroundColor(azul);
                            cell.setPadding(5);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setBorderWidthBottom(1);
                            cell.setBorderColorBottom(BaseColor.WHITE);
                            tablef.addCell(cell);
                        }

                        double tefi = 0, tefic = 0, tefe = 0, teje = 0, tmplan = 0;
                        int tplan = 0, tcuat = 0, teval = 0, sum = 0;
                        if (sarea.equals("0")) {
                            for (int j = 0; j < resultunidades.size(); j++) {
                                cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_nombre(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_planificados().toString(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tplan += resultunidades.get(j).getProyecto_planificados();

                                if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                    sum++;
                                }
                                cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_plurianual().toString(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tcuat += resultunidades.get(j).getProyecto_plurianual();

                                if (!cuatrimestre.equals("0")) {
                                    cell = new PdfPCell(new Paragraph(resultunidades.get(j).getPp_id().toString(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    teval += resultunidades.get(j).getPp_id();
                                }

                                if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficacia()) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph("--", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tefi += resultunidades.get(j).getPe_eficacia();

                                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                    if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficiencia()) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph("--", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tefic += resultunidades.get(j).getPe_eficiencia();

                                    if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_efectividad()) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph("--", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tefe += resultunidades.get(j).getPe_efectividad();

                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getProyecto_monto()), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tmplan += resultunidades.get(j).getProyecto_monto();

                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_ejecucion()), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    teje += resultunidades.get(j).getPe_ejecucion();
                                }
                            }
                        } else if (sarea.equals(ag)) {
                            for (int j = 0; j < resultunidades.size(); j++) {
                                if (resultunidades.get(j).getProyecto_nombre().equals(nombre)) {
                                    cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_nombre(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_planificados().toString(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tplan += resultunidades.get(j).getProyecto_planificados();

                                    if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                        sum++;
                                    }
                                    cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_plurianual().toString(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tcuat += resultunidades.get(j).getProyecto_plurianual();

                                    if (!cuatrimestre.equals("0")) {
                                        cell = new PdfPCell(new Paragraph(resultunidades.get(j).getPp_id().toString(), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);
                                        teval += resultunidades.get(j).getPp_id();
                                    }

                                    if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficacia()) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph("--", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tefi += resultunidades.get(j).getPe_eficacia();

                                    if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                        if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficiencia()) + "%", fuente3));
                                        } else {
                                            cell = new PdfPCell(new Paragraph("--", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);
                                        tefic += resultunidades.get(j).getPe_eficiencia();

                                        if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_efectividad()) + "%", fuente3));
                                        } else {
                                            cell = new PdfPCell(new Paragraph("--", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);
                                        tefe += resultunidades.get(j).getPe_efectividad();

                                        cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getProyecto_monto()), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);
                                        tmplan += resultunidades.get(j).getProyecto_monto();

                                        cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_ejecucion()), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);
                                        teje += resultunidades.get(j).getPe_ejecucion();
                                    }
                                }
                            }
                        } else {
                            for (int j = 0; j < resultunidades.size(); j++) {
                                cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_nombre(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_planificados().toString(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tplan += resultunidades.get(j).getProyecto_planificados();

                                if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                    sum++;
                                }
                                cell = new PdfPCell(new Paragraph(resultunidades.get(j).getProyecto_plurianual().toString(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tcuat += resultunidades.get(j).getProyecto_plurianual();

                                if (!cuatrimestre.equals("0")) {
                                    cell = new PdfPCell(new Paragraph(resultunidades.get(j).getPp_id().toString(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    teval += resultunidades.get(j).getPp_id();
                                }

                                if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficacia()) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph("--", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                tefi += resultunidades.get(j).getPe_eficacia();

                                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                    if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_eficiencia()) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph("--", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tefic += resultunidades.get(j).getPe_eficiencia();

                                    if (resultunidades.get(j).getProyecto_plurianual() > 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_efectividad()) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph("--", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tefe += resultunidades.get(j).getPe_efectividad();

                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getProyecto_monto()), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    tmplan += resultunidades.get(j).getProyecto_monto();

                                    cell = new PdfPCell(new Paragraph(formateador.format(resultunidades.get(j).getPe_ejecucion()), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    teje += resultunidades.get(j).getPe_ejecucion();
                                }
                            }
                        }
                        cell = new PdfPCell(new Paragraph("TOTAL", fuentetitulo));
                        cell.setBackgroundColor(azul);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setBorderWidthRight(1);
                        cell.setBorderColorRight(BaseColor.WHITE);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(tplan + "", fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(tcuat + "", fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        if (!cuatrimestre.equals("0")) {
                            cell = new PdfPCell(new Paragraph(teval + "", fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);
                        }

                        double tot, totefi, totefec;
                        if (sum == 0) {
                            tot = tefi;
                            totefi = tefic;
                        } else {
                            tot = tefi / sum;
                            totefi = tefic / sum;
                        }
                        BigDecimal efit = BigDecimal.valueOf(tot);
                        BigDecimal efict = BigDecimal.valueOf(totefi);
                        efit = efit.setScale(2, RoundingMode.HALF_UP);
                        efict = efict.setScale(2, RoundingMode.HALF_UP);
                        totefec = (efict.doubleValue() + efit.doubleValue());
                        BigDecimal efec = BigDecimal.valueOf(totefec);
                        efec = efec.setScale(2, RoundingMode.HALF_UP);

                        cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue()) + "%", fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);

                        if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                            cell = new PdfPCell(new Paragraph(formateador.format(efict.doubleValue()) + "%", fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph(formateador.format(efec.doubleValue() / 2) + "%", fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph(formateador.format(tmplan), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph(formateador.format(teje), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(3);
                            cell.setBorderWidth(1);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);
                        }

                        if (i == 1) {
                            tpplan1 = tplan;
                            tpcua1 = tcuat;
                            tpeval1 = teval;
                            tefioe1 = efit.doubleValue();
                            teficoe1 = efict.doubleValue();
                            tefecoe1 = efec.doubleValue() / 2;
                            tplan1 = tmplan;
                            teje1 = teje;
                        } else if (i == 2) {
                            tpplan2 = tplan;
                            tpcua2 = tcuat;
                            tpeval2 = teval;
                            tefioe2 = efit.doubleValue();
                            teficoe2 = efict.doubleValue();
                            tefecoe2 = efec.doubleValue() / 2;
                            tplan2 = tmplan;
                            teje2 = teje;
                        } else if (i == 3) {
                            tpplan3 = tplan;
                            tpcua3 = tcuat;
                            tpeval3 = teval;
                            tefioe3 = efit.doubleValue();
                            teficoe3 = efict.doubleValue();
                            tefecoe3 = efec.doubleValue() / 2;
                            tplan3 = tmplan;
                            teje3 = teje;
                        } else {
                            tpplan4 = tplan;
                            tpcua4 = tcuat;
                            tpeval4 = teval;
                            tefioe4 = efit.doubleValue();
                            teficoe4 = efict.doubleValue();
                            tefecoe4 = efec.doubleValue() / 2;
                            tplan4 = tmplan;
                            teje4 = teje;
                        }

                        document.add(tablef);
                        document.add(new Paragraph(" "));
                    }
                }
            }

            if (tipo.equals("0") && !anio.equals("2020")) {
                Chunk parte2;
                if (resultareas.size() < 2) {
                    parte2 = new Chunk("RESUMEN GENERAL " + resultareas.get(0).getAg_nombre(), fuen);
                } else {
                    parte2 = new Chunk("RESUMEN GENERAL " + nombre, fuen);
                }
                Paragraph para2 = new Paragraph();
                para2.add(parte2);
                para2.setAlignment(Element.ALIGN_CENTER);
                document.add(para2);
                document.add(new Paragraph(" "));

                PdfPTable tablef;
                if (cuatrimestre.equals("0")) {
                    tablef = new PdfPTable(8);
                    tablef.setTotalWidth(new float[]{180, 80, 70, 70, 70, 70, 80, 80});
                    tablef.setLockedWidth(true);
                } else {
                    tablef = new PdfPTable(9);
                    tablef.setTotalWidth(new float[]{140, 70, 70, 70, 70, 70, 70, 70, 70});
                    tablef.setLockedWidth(true);
                }

                PdfPCell cell;
                cell = new PdfPCell(new Paragraph("OEI", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("#PROYECTOS PLANIFICADOS", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("#EJECUTADO CUATRIMESTRE", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                tablef.addCell(cell);

                if (!cuatrimestre.equals("0")) {
                    cell = new PdfPCell(new Paragraph("#PROYECTOS EVALUADOS", fuentetitulo));
                    cell.setBackgroundColor(azul);
                    cell.setPadding(5);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setBorderWidthRight(1);
                    cell.setBorderColorRight(BaseColor.WHITE);
                    tablef.addCell(cell);
                }

                cell = new PdfPCell(new Paragraph("EFICACIA", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("EFICIENCIA", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("EFECTIVIDAD", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("PLANIFICADO", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("EJECUCIÓN", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthBottom(1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                tablef.addCell(cell);

                double tefi = 0, tefic = 0, tefe = 0, teje = 0, tmplan = 0;
                int tplan = 0, tcuat = 0, teval = 0, sum = 0;
                if (tpplan1 > 0) {
                    cell = new PdfPCell(new Paragraph("OEI-1 ", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph(String.valueOf(tpplan1), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tplan += tpplan1;

                    cell = new PdfPCell(new Paragraph(String.valueOf(tpcua1), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tcuat += tpcua1;

                    if (!cuatrimestre.equals("0")) {
                        cell = new PdfPCell(new Paragraph(String.valueOf(tpeval1), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);
                        teval += tpeval1;
                    }

                    if (tpcua1 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(tefioe1) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefi += tefioe1;

                    if (tpcua1 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(teficoe1) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefic += teficoe1;

                    if (tpcua1 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(tefecoe1) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefe += tefecoe1;

                    cell = new PdfPCell(new Paragraph(formateador.format(tplan1), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tmplan += tplan1;

                    cell = new PdfPCell(new Paragraph(formateador.format(teje1), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    teje += teje1;
                    if (tpcua1 > 0) {
                        sum++;
                    }
                }

                if (tpplan2 > 0) {
                    cell = new PdfPCell(new Paragraph("OEI-2 ", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph(String.valueOf(tpplan2), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tplan += tpplan2;

                    cell = new PdfPCell(new Paragraph(String.valueOf(tpcua2), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tcuat += tpcua2;

                    if (!cuatrimestre.equals("0")) {
                        cell = new PdfPCell(new Paragraph(String.valueOf(tpeval2), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);
                        teval += tpeval2;
                    }

                    if (tpcua2 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(tefioe2) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefi += tefioe2;

                    if (tpcua2 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(teficoe2) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefic += teficoe2;

                    if (tpcua2 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(tefecoe2) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefe += tefecoe2;

                    cell = new PdfPCell(new Paragraph(formateador.format(tplan2), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tmplan += tplan2;

                    cell = new PdfPCell(new Paragraph(formateador.format(teje2), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    teje += teje2;
                    if (tpcua2 > 0) {
                        sum++;
                    }
                }

                if (tpplan3 > 0) {
                    cell = new PdfPCell(new Paragraph("OEI-3 ", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph(String.valueOf(tpplan3), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tplan += tpplan3;

                    cell = new PdfPCell(new Paragraph(String.valueOf(tpcua3), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tcuat += tpcua3;

                    if (!cuatrimestre.equals("0")) {
                        cell = new PdfPCell(new Paragraph(String.valueOf(tpeval3), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);
                        teval += tpeval3;
                    }

                    if (tpcua3 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(tefioe3) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefi += tefioe3;

                    if (tpcua3 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(teficoe3) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefic += teficoe3;

                    if (tpcua3 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(tefecoe3) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefe += tefecoe3;

                    cell = new PdfPCell(new Paragraph(formateador.format(tplan3), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tmplan += tplan3;

                    cell = new PdfPCell(new Paragraph(formateador.format(teje3), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    teje += teje3;
                    if (tpcua3 > 0) {
                        sum++;
                    }
                }

                if (tpplan4 > 0) {
                    cell = new PdfPCell(new Paragraph("OEI-4 ", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph(String.valueOf(tpplan4), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tplan += tpplan4;

                    cell = new PdfPCell(new Paragraph(String.valueOf(tpcua4), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tcuat += tpcua4;

                    if (!cuatrimestre.equals("0")) {
                        cell = new PdfPCell(new Paragraph(String.valueOf(tpeval4), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(3);
                        cell.setBorderWidth(1);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                        tablef.addCell(cell);
                        teval += tpeval4;
                    }

                    if (tpcua4 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(tefioe4) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefi += tefioe4;

                    if (tpcua4 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(teficoe4) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefic += teficoe4;

                    if (tpcua4 > 0) {
                        cell = new PdfPCell(new Paragraph(formateador.format(tefecoe4) + "%", fuente3));
                    } else {
                        cell = new PdfPCell(new Paragraph("---", fuente3));
                    }
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tefe += tefecoe4;

                    cell = new PdfPCell(new Paragraph(formateador.format(tplan4), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    tmplan += tplan4;

                    cell = new PdfPCell(new Paragraph(formateador.format(teje4), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                    teje += teje4;
                    if (tpcua4 > 0) {
                        sum++;
                    }
                }

                cell = new PdfPCell(new Paragraph("TOTAL", fuentetitulo));
                cell.setBackgroundColor(azul);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidthRight(1);
                cell.setBorderColorRight(BaseColor.WHITE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph(tplan + "", fuente3));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(3);
                cell.setBorderWidth(1);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph(tcuat + "", fuente3));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(3);
                cell.setBorderWidth(1);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                tablef.addCell(cell);

                if (!cuatrimestre.equals("0")) {
                    cell = new PdfPCell(new Paragraph(teval + "", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                }

                double tot, totefi, totefec;
                if (sum == 0) {
                    tot = tefi;
                    totefi = tefic;
                } else {
                    tot = tefi / sum;
                    totefi = tefic / sum;
                }
                BigDecimal efit = BigDecimal.valueOf(tot);
                BigDecimal efict = BigDecimal.valueOf(totefi);
                efit = efit.setScale(2, RoundingMode.HALF_UP);
                efict = efict.setScale(2, RoundingMode.HALF_UP);
                totefec = (efict.doubleValue() + efit.doubleValue());
                BigDecimal efec = BigDecimal.valueOf(totefec);
                efec = efec.setScale(2, RoundingMode.HALF_UP);
                cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue()) + "%", fuente3));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(3);
                cell.setBorderWidth(1);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                tablef.addCell(cell);

                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                    cell = new PdfPCell(new Paragraph(formateador.format(efict.doubleValue()) + "%", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph(formateador.format(efec.doubleValue() / 2) + "%", fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph(formateador.format(tmplan), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);

                    cell = new PdfPCell(new Paragraph(formateador.format(teje), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(3);
                    cell.setBorderWidth(1);
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                    tablef.addCell(cell);
                }

                document.add(tablef);
                document.add(new Paragraph(" "));
            }

            if (sarea.equals("0")) {
                for (int i = 0; i < resultareas.size(); i++) {
                    resultunidadespadre = accAg.obtenerAreasGestionUnidades(resultareas.get(i).getAg_id());
                    if (anio.equals("2020")) {
                        if (resultareas.get(i).getTag_id() != 4) {
                            Chunk parte2 = new Chunk("Unidad Académica/Administrativa: " + resultareas.get(i).getAg_nombre(), fuen);
                            Paragraph para2 = new Paragraph();
                            para2.add(parte2);
                            para2.setAlignment(Element.ALIGN_CENTER);
                            document.add(para2);
                            document.add(new Paragraph(" "));
                            for (int k = 0; k < resultunidadespadre.size(); k++) {
                                if (cuatrimestre.equals("0")) {
                                    resultproyectos = aComp.ListaProyectoPOAEvalProyComp(resultunidadespadre.get(k).getAg_id(), Integer.parseInt(tipo), Integer.parseInt(anio));
                                } else {
                                    resultproyectos = aComp.ListaProyectoPOAEvalProy(resultunidadespadre.get(k).getAg_id(), Integer.parseInt(tipo), Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                                }
                                if (resultproyectos.size() > 0) {
                                    PdfPTable tablef;
                                    if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                        tablef = new PdfPTable(9);
                                        tablef.setTotalWidth(new float[]{90, 120, 70, 70, 70, 70, 70, 70, 70});
                                        tablef.setLockedWidth(true);
                                    } else {
                                        tablef = new PdfPTable(5);
                                        tablef.setTotalWidth(new float[]{170, 235, 100, 100, 85});
                                        tablef.setLockedWidth(true);
                                    }
                                    PdfPCell cell;

                                    cell = new PdfPCell(new Paragraph(resultunidadespadre.get(k).getAg_nombre(), fuentetexto));
                                    cell.setPadding(5);
                                    if (cuatrimestre.equals("0") || cuatrimestre.equals("3") || !anio.equals("2020")) {
                                        cell.setColspan(9);
                                    } else {
                                        cell.setColspan(5);
                                    }
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("CÓDIGO", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("PROYECTO", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("TIPO PROYECTO", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("EFICACIA", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                        cell = new PdfPCell(new Paragraph("EFICIENCIA", fuentetexto));
                                        cell.setPadding(5);
                                        cell.setBackgroundColor(azul);
                                        cell.setBorderWidthRight(1);
                                        cell.setBorderColorRight(BaseColor.WHITE);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph("EFECTIVIDAD", fuentetexto));
                                        cell.setPadding(5);
                                        cell.setBackgroundColor(azul);
                                        cell.setBorderWidthRight(1);
                                        cell.setBorderColorRight(BaseColor.WHITE);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph("PLANIFICADO", fuentetexto));
                                        cell.setPadding(5);
                                        cell.setBackgroundColor(azul);
                                        cell.setBorderWidthRight(1);
                                        cell.setBorderColorRight(BaseColor.WHITE);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph("EJECUCIÓN", fuentetexto));
                                        cell.setPadding(5);
                                        cell.setBackgroundColor(azul);
                                        cell.setBorderWidthRight(1);
                                        cell.setBorderColorRight(BaseColor.WHITE);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);
                                    }

                                    cell = new PdfPCell(new Paragraph("OBSERVACIÓN", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    double totalf = 0, totalefi = 0, totalefe = 0, totaleje = 0, tmplan = 0;
                                    int tot = 0;
                                    for (int j = 0; j < resultproyectos.size(); j++) {
                                        cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_codigo(), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_nombre(), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getTp_nombre(), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);

                                        if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficacia()) + "%", fuente3));
                                            totalf += resultproyectos.get(j).getPe_eficacia();
                                            tot++;
                                        } else {
                                            cell = new PdfPCell(new Paragraph("---", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);

                                        if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                            if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                                cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficiencia()) + "%", fuente3));
                                                totalefi += resultproyectos.get(j).getPe_eficiencia();
                                            } else {
                                                cell = new PdfPCell(new Paragraph("---", fuente3));
                                            }
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setPadding(3);
                                            cell.setBorderWidth(1);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                            tablef.addCell(cell);

                                            if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                                cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_efectividad()) + "%", fuente3));
                                                totalefe += resultproyectos.get(j).getPe_efectividad();
                                            } else {
                                                cell = new PdfPCell(new Paragraph("---", fuente3));
                                            }
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setPadding(3);
                                            cell.setBorderWidth(1);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                            tablef.addCell(cell);

                                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getProyecto_monto()), fuente3));
                                            tmplan += resultproyectos.get(j).getProyecto_monto();
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setPadding(3);
                                            cell.setBorderWidth(1);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                            tablef.addCell(cell);

                                            if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                                cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_ejecucion()), fuente3));
                                                totaleje += resultproyectos.get(j).getPe_ejecucion();
                                            } else {
                                                cell = new PdfPCell(new Paragraph("---", fuente3));
                                            }
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setPadding(3);
                                            cell.setBorderWidth(1);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                            tablef.addCell(cell);
                                        }
                                        if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                            cell = new PdfPCell(new Paragraph("--", fuente3));
                                        } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() < 0) {
                                            cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación", fuente3));
                                        } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() == 0) {
                                            cell = new PdfPCell(new Paragraph("Proyecto no evaluado", fuente3));
                                        } else if (resultproyectos.get(j).getPe_eficacia() == -2) {
                                            cell = new PdfPCell(new Paragraph("Proyecto no enviado para evaluación", fuente3));
                                        } else {
                                            cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación en este periodo", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);
                                    }
                                    cell = new PdfPCell(new Paragraph("TOTAL", fuentetitulo));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setColspan(3);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    BigDecimal efit = BigDecimal.valueOf(totalf);
                                    BigDecimal efict = BigDecimal.valueOf(totalefi);
                                    efit = efit.setScale(2, RoundingMode.HALF_UP);
                                    efict = efict.setScale(2, RoundingMode.HALF_UP);
                                    if (tot == 0) {
                                        totalefe = ((efict.doubleValue()) + (efit.doubleValue()));
                                    } else {
                                        totalefe = ((efict.doubleValue() / tot) + (efit.doubleValue() / tot));
                                    }
                                    BigDecimal efec = BigDecimal.valueOf(totalefe);
                                    efec = efec.setScale(2, RoundingMode.HALF_UP);

                                    if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                        if (tot == 0) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                        } else {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        cell.setPadding(3);
                                        tablef.addCell(cell);

                                        if (tot == 0) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efict) + "%", fuente3));
                                        } else {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efict.doubleValue() / tot) + "%", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        cell.setPadding(3);
                                        tablef.addCell(cell);

                                        if (tot == 0) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efec) + "%", fuente3));
                                        } else {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efec.doubleValue() / 2) + "%", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        cell.setPadding(3);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph(formateador.format(tmplan), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        cell.setPadding(3);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph(formateador.format(totaleje), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setBorderWidth(1);
                                        cell.setColspan(2);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        cell.setPadding(3);
                                        tablef.addCell(cell);
                                    } else {
                                        if (tot == 0) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                        } else {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setBorderWidth(1);
                                        cell.setColspan(2);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        cell.setPadding(3);
                                        tablef.addCell(cell);
                                    }
                                    document.add(tablef);
                                    document.add(new Paragraph(" "));
                                }
                            }
                        } else {
                            if (cuatrimestre.equals("0")) {
                                resultproyectos = aComp.ListaProyectoPOAEvalProyComp(resultareas.get(i).getAg_id(), Integer.parseInt(tipo), Integer.parseInt(anio));
                            } else {
                                resultproyectos = aComp.ListaProyectoPOAEvalProy(resultareas.get(i).getAg_id(), Integer.parseInt(tipo), Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                            }
                            if (resultproyectos.size() > 0) {
                                Chunk parte2 = new Chunk("Unidad Académica/Administrativa: " + resultareas.get(i).getAg_nombre(), fuen);
                                Paragraph para2 = new Paragraph();
                                para2.add(parte2);
                                para2.setAlignment(Element.ALIGN_CENTER);
                                document.add(para2);
                                document.add(new Paragraph(" "));

                                PdfPTable tablef;
                                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                    tablef = new PdfPTable(9);
                                    tablef.setTotalWidth(new float[]{80, 120, 70, 70, 70, 70, 70, 70, 70});
                                    tablef.setLockedWidth(true);
                                } else {
                                    tablef = new PdfPTable(5);
                                    tablef.setTotalWidth(new float[]{170, 235, 100, 100, 85});
                                    tablef.setLockedWidth(true);
                                }
                                PdfPCell cell;

                                cell = new PdfPCell(new Paragraph("CÓDIGO", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph("PROYECTO", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph("TIPO PROYECTO", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph("EFICACIA", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                    cell = new PdfPCell(new Paragraph("EFICIENCIA", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("EFECTIVIDAD", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("PLANIFICADO", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("EJECUCIÓN", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                }

                                cell = new PdfPCell(new Paragraph("OBSERVACIÓN", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                double totalf = 0, totalefi = 0, totalefe = 0, totaleje = 0, tmplan = 0;
                                int tot = 0;
                                for (int j = 0; j < resultproyectos.size(); j++) {
                                    cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_codigo(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_nombre(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getTp_nombre(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);

                                    if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficacia()) + "%", fuente3));
                                        totalf += resultproyectos.get(j).getPe_eficacia();
                                        tot++;
                                    } else {
                                        cell = new PdfPCell(new Paragraph("---", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);

                                    if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                        if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficiencia()) + "%", fuente3));
                                            totalefi += resultproyectos.get(j).getPe_eficiencia();
                                        } else {
                                            cell = new PdfPCell(new Paragraph("---", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);

                                        if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_efectividad()) + "%", fuente3));
                                            totalefe += resultproyectos.get(j).getPe_efectividad();
                                        } else {
                                            cell = new PdfPCell(new Paragraph("---", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getProyecto_monto()), fuente3));
                                        tmplan += resultproyectos.get(j).getProyecto_monto();
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);

                                        if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_ejecucion()), fuente3));
                                            totaleje += resultproyectos.get(j).getPe_ejecucion();
                                        } else {
                                            cell = new PdfPCell(new Paragraph("---", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);
                                    }

                                    if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                        cell = new PdfPCell(new Paragraph("--", fuente3));
                                    } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() < 0) {
                                        cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación", fuente3));
                                    } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() == 0) {
                                        cell = new PdfPCell(new Paragraph("Proyecto no evaluado", fuente3));
                                    } else if (resultproyectos.get(j).getPe_eficacia() == -2) {
                                        cell = new PdfPCell(new Paragraph("Proyecto no enviado para evaluación", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación en este periodo", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);
                                }
                                cell = new PdfPCell(new Paragraph("TOTAL", fuentetitulo));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setColspan(3);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                BigDecimal efit = BigDecimal.valueOf(totalf);
                                BigDecimal efict = BigDecimal.valueOf(totalefi);
                                efit = efit.setScale(2, RoundingMode.HALF_UP);
                                efict = efict.setScale(2, RoundingMode.HALF_UP);
                                if (tot == 0) {
                                    totalefe = ((efict.doubleValue()) + (efit.doubleValue()));
                                } else {
                                    totalefe = ((efict.doubleValue() / tot) + (efit.doubleValue() / tot));
                                }
                                BigDecimal efec = BigDecimal.valueOf(totalefe);
                                efec = efec.setScale(2, RoundingMode.HALF_UP);

                                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                    if (tot == 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);

                                    if (tot == 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efict) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efict.doubleValue() / tot) + "%", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);

                                    if (tot == 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efec) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efec.doubleValue() / 2) + "%", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(formateador.format(tmplan), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(formateador.format(totaleje), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    cell.setColspan(2);
                                    tablef.addCell(cell);
                                } else {
                                    if (tot == 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setColspan(2);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);
                                }
                                document.add(tablef);
                                document.add(new Paragraph(" "));
                            }
                        }
                    } else {
                        if (tipo.equals("0")) {
                            oeii = 1;
                            oeif = 4;
                        } else {
                            oeii = Integer.parseInt(tipo);
                            oeif = Integer.parseInt(tipo);
                        }

                        String oenombre;

                        for (int oe = oeii; oe <= oeif; oe++) {
                            if (oe == 1) {
                                oenombre = "ACADÉMICO";
                            } else if (oe == 2) {
                                oenombre = "INVESTIGACIÓN";
                            } else if (oe == 3) {
                                oenombre = "VINCULACIÓN";
                            } else {
                                oenombre = "GESTIÓN";
                            }
                            if (resultareas.get(i).getTag_id() != 4) {
                                for (int k = 0; k < resultunidadespadre.size(); k++) {
                                    if (cuatrimestre.equals("0")) {
                                        resultproyectos = aComp.ListaProyectoPOAEvalProyComp(resultunidadespadre.get(k).getAg_id(), oe, Integer.parseInt(anio));
                                    } else {
                                        resultproyectos = aComp.ListaProyectoPOAEvalProy(resultunidadespadre.get(k).getAg_id(), oe, Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                                    }
                                    if (resultproyectos.size() > 0) {
                                        if (resultunidadespadre.get(k).getTag_id() == 2) {
                                            Chunk parte2 = new Chunk("Unidad Académica/Administrativa: " + resultareas.get(i).getAg_nombre() + " - " + oenombre, fuen);
                                            Paragraph para2 = new Paragraph();
                                            para2.add(parte2);
                                            para2.setAlignment(Element.ALIGN_CENTER);
                                            document.add(para2);
                                        }
                                        document.add(new Paragraph(" "));
                                        PdfPTable tablef;
                                        tablef = new PdfPTable(9);
                                        tablef.setTotalWidth(new float[]{90, 120, 70, 70, 70, 70, 70, 70, 70});
                                        tablef.setLockedWidth(true);
                                        PdfPCell cell;

                                        cell = new PdfPCell(new Paragraph(resultunidadespadre.get(k).getAg_nombre(), fuentetexto));
                                        cell.setPadding(5);
                                        cell.setColspan(9);
                                        cell.setBackgroundColor(azul);
                                        cell.setBorderWidthRight(1);
                                        cell.setBorderColorRight(BaseColor.WHITE);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph("CÓDIGO", fuentetexto));
                                        cell.setPadding(5);
                                        cell.setBackgroundColor(azul);
                                        cell.setBorderWidthRight(1);
                                        cell.setBorderColorRight(BaseColor.WHITE);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph("PROYECTO", fuentetexto));
                                        cell.setPadding(5);
                                        cell.setBackgroundColor(azul);
                                        cell.setBorderWidthRight(1);
                                        cell.setBorderColorRight(BaseColor.WHITE);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph("TIPO PROYECTO", fuentetexto));
                                        cell.setPadding(5);
                                        cell.setBackgroundColor(azul);
                                        cell.setBorderWidthRight(1);
                                        cell.setBorderColorRight(BaseColor.WHITE);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph("EFICACIA", fuentetexto));
                                        cell.setPadding(5);
                                        cell.setBackgroundColor(azul);
                                        cell.setBorderWidthRight(1);
                                        cell.setBorderColorRight(BaseColor.WHITE);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph("EFICIENCIA", fuentetexto));
                                        cell.setPadding(5);
                                        cell.setBackgroundColor(azul);
                                        cell.setBorderWidthRight(1);
                                        cell.setBorderColorRight(BaseColor.WHITE);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph("EFECTIVIDAD", fuentetexto));
                                        cell.setPadding(5);
                                        cell.setBackgroundColor(azul);
                                        cell.setBorderWidthRight(1);
                                        cell.setBorderColorRight(BaseColor.WHITE);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph("PLANIFICADO", fuentetexto));
                                        cell.setPadding(5);
                                        cell.setBackgroundColor(azul);
                                        cell.setBorderWidthRight(1);
                                        cell.setBorderColorRight(BaseColor.WHITE);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph("EJECUCIÓN", fuentetexto));
                                        cell.setPadding(5);
                                        cell.setBackgroundColor(azul);
                                        cell.setBorderWidthRight(1);
                                        cell.setBorderColorRight(BaseColor.WHITE);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph("OBSERVACIÓN", fuentetexto));
                                        cell.setPadding(5);
                                        cell.setBackgroundColor(azul);
                                        cell.setBorderWidthRight(1);
                                        cell.setBorderColorRight(BaseColor.WHITE);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);
                                        double totalf = 0, totalefi = 0, totalefe = 0, totaleje = 0, tmplan = 0;
                                        int tot = 0;
                                        for (int j = 0; j < resultproyectos.size(); j++) {
                                            cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_codigo(), fuente3));
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setPadding(3);
                                            cell.setBorderWidth(1);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                            tablef.addCell(cell);

                                            cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_nombre(), fuente3));
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setPadding(3);
                                            cell.setBorderWidth(1);
                                            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                            tablef.addCell(cell);

                                            cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getTp_nombre(), fuente3));
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setPadding(3);
                                            cell.setBorderWidth(1);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                            tablef.addCell(cell);

                                            if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                                cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficacia()) + "%", fuente3));
                                                totalf += resultproyectos.get(j).getPe_eficacia();
                                                tot++;
                                            } else {
                                                cell = new PdfPCell(new Paragraph("---", fuente3));
                                            }
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setPadding(3);
                                            cell.setBorderWidth(1);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                            tablef.addCell(cell);

                                            if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                                if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                                    cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficiencia()) + "%", fuente3));
                                                    totalefi += resultproyectos.get(j).getPe_eficiencia();
                                                } else {
                                                    cell = new PdfPCell(new Paragraph("---", fuente3));
                                                }
                                                cell.setBackgroundColor(BaseColor.WHITE);
                                                cell.setPadding(3);
                                                cell.setBorderWidth(1);
                                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                                tablef.addCell(cell);

                                                if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                                    cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_efectividad()) + "%", fuente3));
                                                    totalefe += resultproyectos.get(j).getPe_efectividad();
                                                } else {
                                                    cell = new PdfPCell(new Paragraph("---", fuente3));
                                                }
                                                cell.setBackgroundColor(BaseColor.WHITE);
                                                cell.setPadding(3);
                                                cell.setBorderWidth(1);
                                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                                tablef.addCell(cell);

                                                cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getProyecto_monto()), fuente3));
                                                tmplan += resultproyectos.get(j).getProyecto_monto();
                                                cell.setBackgroundColor(BaseColor.WHITE);
                                                cell.setPadding(3);
                                                cell.setBorderWidth(1);
                                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                                tablef.addCell(cell);

                                                if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                                    cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_ejecucion()), fuente3));
                                                    totaleje += resultproyectos.get(j).getPe_ejecucion();
                                                } else {
                                                    cell = new PdfPCell(new Paragraph("---", fuente3));
                                                }
                                                cell.setBackgroundColor(BaseColor.WHITE);
                                                cell.setPadding(3);
                                                cell.setBorderWidth(1);
                                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                                tablef.addCell(cell);
                                            }
                                            if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                                cell = new PdfPCell(new Paragraph("--", fuente3));
                                            } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() < 0) {
                                                cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación", fuente3));
                                            } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() == 0) {
                                                cell = new PdfPCell(new Paragraph("Proyecto no evaluado", fuente3));
                                            } else if (resultproyectos.get(j).getPe_eficacia() == -2) {
                                                cell = new PdfPCell(new Paragraph("Proyecto no enviado para evaluación", fuente3));
                                            } else {
                                                cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación en este periodo", fuente3));
                                            }
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setPadding(3);
                                            cell.setBorderWidth(1);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                            tablef.addCell(cell);
                                        }
                                        cell = new PdfPCell(new Paragraph("TOTAL", fuentetitulo));
                                        cell.setPadding(5);
                                        cell.setBackgroundColor(azul);
                                        cell.setBorderWidthRight(1);
                                        cell.setColspan(3);
                                        cell.setBorderColorRight(BaseColor.WHITE);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);

                                        BigDecimal efit = BigDecimal.valueOf(totalf);
                                        BigDecimal efict = BigDecimal.valueOf(totalefi);
                                        efit = efit.setScale(2, RoundingMode.HALF_UP);
                                        efict = efict.setScale(2, RoundingMode.HALF_UP);
                                        if (tot == 0) {
                                            totalefe = ((efict.doubleValue()) + (efit.doubleValue()));
                                        } else {
                                            totalefe = ((efict.doubleValue() / tot) + (efit.doubleValue() / tot));
                                        }
                                        BigDecimal efec = BigDecimal.valueOf(totalefe);
                                        efec = efec.setScale(2, RoundingMode.HALF_UP);

                                        if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                            if (tot == 0) {
                                                cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                            } else {
                                                cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                            }
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setBorderWidth(1);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                            cell.setPadding(3);
                                            tablef.addCell(cell);

                                            if (tot == 0) {
                                                cell = new PdfPCell(new Paragraph(formateador.format(efict) + "%", fuente3));
                                            } else {
                                                cell = new PdfPCell(new Paragraph(formateador.format(efict.doubleValue() / tot) + "%", fuente3));
                                            }
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setBorderWidth(1);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                            cell.setPadding(3);
                                            tablef.addCell(cell);

                                            if (tot == 0) {
                                                cell = new PdfPCell(new Paragraph(formateador.format(efec) + "%", fuente3));
                                            } else {
                                                cell = new PdfPCell(new Paragraph(formateador.format(efec.doubleValue() / 2) + "%", fuente3));
                                            }
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setBorderWidth(1);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                            cell.setPadding(3);
                                            tablef.addCell(cell);

                                            cell = new PdfPCell(new Paragraph(formateador.format(tmplan), fuente3));
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setBorderWidth(1);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                            cell.setPadding(3);
                                            tablef.addCell(cell);

                                            cell = new PdfPCell(new Paragraph(formateador.format(totaleje), fuente3));
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setBorderWidth(1);
                                            cell.setColspan(2);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                            cell.setPadding(3);
                                            tablef.addCell(cell);
                                        } else {
                                            if (tot == 0) {
                                                cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                            } else {
                                                cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                            }
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setBorderWidth(1);
                                            cell.setColspan(2);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                            cell.setPadding(3);
                                            tablef.addCell(cell);
                                        }
                                        document.add(tablef);
                                        document.add(new Paragraph(" "));
                                    }
                                }
                            } else {
                                if (cuatrimestre.equals("0")) {
                                    resultproyectos = aComp.ListaProyectoPOAEvalProyComp(resultareas.get(i).getAg_id(), oe, Integer.parseInt(anio));
                                } else {
                                    resultproyectos = aComp.ListaProyectoPOAEvalProy(resultareas.get(i).getAg_id(), oe, Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                                }
                                if (resultproyectos.size() > 0) {
                                    Chunk parte2 = new Chunk("Unidad Académica/Administrativa: " + resultareas.get(i).getAg_nombre() + " - " + oenombre, fuen);
                                    Paragraph para2 = new Paragraph();
                                    para2.add(parte2);
                                    para2.setAlignment(Element.ALIGN_CENTER);
                                    document.add(para2);
                                    document.add(new Paragraph(" "));

                                    PdfPTable tablef;
                                    tablef = new PdfPTable(9);
                                    tablef.setTotalWidth(new float[]{80, 120, 70, 70, 70, 70, 70, 70, 70});
                                    tablef.setLockedWidth(true);
                                    PdfPCell cell;

                                    cell = new PdfPCell(new Paragraph("CÓDIGO", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("PROYECTO", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("TIPO PROYECTO", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("EFICACIA", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                        cell = new PdfPCell(new Paragraph("EFICIENCIA", fuentetexto));
                                        cell.setPadding(5);
                                        cell.setBackgroundColor(azul);
                                        cell.setBorderWidthRight(1);
                                        cell.setBorderColorRight(BaseColor.WHITE);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph("EFECTIVIDAD", fuentetexto));
                                        cell.setPadding(5);
                                        cell.setBackgroundColor(azul);
                                        cell.setBorderWidthRight(1);
                                        cell.setBorderColorRight(BaseColor.WHITE);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph("PLANIFICADO", fuentetexto));
                                        cell.setPadding(5);
                                        cell.setBackgroundColor(azul);
                                        cell.setBorderWidthRight(1);
                                        cell.setBorderColorRight(BaseColor.WHITE);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph("EJECUCIÓN", fuentetexto));
                                        cell.setPadding(5);
                                        cell.setBackgroundColor(azul);
                                        cell.setBorderWidthRight(1);
                                        cell.setBorderColorRight(BaseColor.WHITE);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        tablef.addCell(cell);
                                    }

                                    cell = new PdfPCell(new Paragraph("OBSERVACIÓN", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    double totalf = 0, totalefi = 0, totalefe = 0, totaleje = 0, tmplan = 0;
                                    int tot = 0;
                                    for (int j = 0; j < resultproyectos.size(); j++) {
                                        cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_codigo(), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_nombre(), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getTp_nombre(), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);

                                        if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficacia()) + "%", fuente3));
                                            totalf += resultproyectos.get(j).getPe_eficacia();
                                            tot++;
                                        } else {
                                            cell = new PdfPCell(new Paragraph("---", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);

                                        if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                            if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                                cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficiencia()) + "%", fuente3));
                                                totalefi += resultproyectos.get(j).getPe_eficiencia();
                                            } else {
                                                cell = new PdfPCell(new Paragraph("---", fuente3));
                                            }
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setPadding(3);
                                            cell.setBorderWidth(1);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                            tablef.addCell(cell);

                                            if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                                cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_efectividad()) + "%", fuente3));
                                                totalefe += resultproyectos.get(j).getPe_efectividad();
                                            } else {
                                                cell = new PdfPCell(new Paragraph("---", fuente3));
                                            }
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setPadding(3);
                                            cell.setBorderWidth(1);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                            tablef.addCell(cell);

                                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getProyecto_monto()), fuente3));
                                            tmplan += resultproyectos.get(j).getProyecto_monto();
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setPadding(3);
                                            cell.setBorderWidth(1);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                            tablef.addCell(cell);

                                            if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                                cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_ejecucion()), fuente3));
                                                totaleje += resultproyectos.get(j).getPe_ejecucion();
                                            } else {
                                                cell = new PdfPCell(new Paragraph("---", fuente3));
                                            }
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setPadding(3);
                                            cell.setBorderWidth(1);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                            tablef.addCell(cell);
                                        }

                                        if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                            cell = new PdfPCell(new Paragraph("--", fuente3));
                                        } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() < 0) {
                                            cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación", fuente3));
                                        } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() == 0) {
                                            cell = new PdfPCell(new Paragraph("Proyecto no evaluado", fuente3));
                                        } else if (resultproyectos.get(j).getPe_eficacia() == -2) {
                                            cell = new PdfPCell(new Paragraph("Proyecto no enviado para evaluación", fuente3));
                                        } else {
                                            cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación en este periodo", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);
                                    }
                                    cell = new PdfPCell(new Paragraph("TOTAL", fuentetitulo));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setColspan(3);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    BigDecimal efit = BigDecimal.valueOf(totalf);
                                    BigDecimal efict = BigDecimal.valueOf(totalefi);
                                    efit = efit.setScale(2, RoundingMode.HALF_UP);
                                    efict = efict.setScale(2, RoundingMode.HALF_UP);
                                    if (tot == 0) {
                                        totalefe = ((efict.doubleValue()) + (efit.doubleValue()));
                                    } else {
                                        totalefe = ((efict.doubleValue() / tot) + (efit.doubleValue() / tot));
                                    }
                                    BigDecimal efec = BigDecimal.valueOf(totalefe);
                                    efec = efec.setScale(2, RoundingMode.HALF_UP);

                                    if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                        if (tot == 0) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                        } else {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        cell.setPadding(3);
                                        tablef.addCell(cell);

                                        if (tot == 0) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efict) + "%", fuente3));
                                        } else {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efict.doubleValue() / tot) + "%", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        cell.setPadding(3);
                                        tablef.addCell(cell);

                                        if (tot == 0) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efec) + "%", fuente3));
                                        } else {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efec.doubleValue() / 2) + "%", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        cell.setPadding(3);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph(formateador.format(tmplan), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        cell.setPadding(3);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph(formateador.format(totaleje), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        cell.setPadding(3);
                                        cell.setColspan(2);
                                        tablef.addCell(cell);
                                    } else {
                                        if (tot == 0) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                        } else {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setBorderWidth(1);
                                        cell.setColspan(2);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        cell.setPadding(3);
                                        tablef.addCell(cell);
                                    }
                                    document.add(tablef);
                                    document.add(new Paragraph(" "));
                                }
                            }
                        }
                    }
                }
            } else {
                resultunidadespadre = accAg.obtenerAreasGestionUnidades(Integer.parseInt(sarea));
                if (anio.equals("2020")) {
                    if (resultunidadespadre.get(0).getTag_id() != 4) {
                        for (int k = 0; k < resultunidadespadre.size(); k++) {
                            if (cuatrimestre.equals("0")) {
                                resultproyectos = aComp.ListaProyectoPOAEvalProyComp(resultunidadespadre.get(k).getAg_id(), Integer.parseInt(tipo), Integer.parseInt(anio));
                            } else {
                                resultproyectos = aComp.ListaProyectoPOAEvalProy(resultunidadespadre.get(k).getAg_id(), Integer.parseInt(tipo), Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                            }
                            if (resultproyectos.size() > 0) {
                                Chunk parte3 = new Chunk(resultunidadespadre.get(k).getAg_nombre(), fuen);
                                Paragraph para3 = new Paragraph();
                                para3.add(parte3);
                                para3.setAlignment(Element.ALIGN_CENTER);
                                document.add(para3);
                                document.add(new Paragraph(" "));

                                PdfPTable tablef;
                                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                    tablef = new PdfPTable(9);
                                    tablef.setTotalWidth(new float[]{80, 120, 70, 70, 70, 70, 70, 70, 70});
                                    tablef.setLockedWidth(true);
                                } else {
                                    tablef = new PdfPTable(5);
                                    tablef.setTotalWidth(new float[]{170, 235, 100, 100, 85});
                                    tablef.setLockedWidth(true);
                                }
                                PdfPCell cell;

                                cell = new PdfPCell(new Paragraph("CÓDIGO", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph("PROYECTO", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph("TIPO PROYECTO", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph("EFICACIA", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                    cell = new PdfPCell(new Paragraph("EFICIENCIA", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("EFECTIVIDAD", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("PLANIFICADO", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("EJECUCIÓN", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                }

                                cell = new PdfPCell(new Paragraph("OBSERVACIÓN", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                double totalf = 0, totalefi = 0, totalefe = 0, totaleje = 0, tmplan = 0;
                                int tot = 0;
                                for (int j = 0; j < resultproyectos.size(); j++) {
                                    cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_codigo(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_nombre(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getTp_nombre(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);

                                    if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficacia()) + "%", fuente3));
                                        totalf += resultproyectos.get(j).getPe_eficacia();
                                        tot++;
                                    } else {
                                        cell = new PdfPCell(new Paragraph("---", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);

                                    if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                        if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficiencia()) + "%", fuente3));
                                            totalefi += resultproyectos.get(j).getPe_eficiencia();
                                        } else {
                                            cell = new PdfPCell(new Paragraph("---", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);

                                        if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_efectividad()) + "%", fuente3));
                                            totalefe += resultproyectos.get(j).getPe_efectividad();
                                        } else {
                                            cell = new PdfPCell(new Paragraph("---", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getProyecto_monto()), fuente3));
                                        tmplan += resultproyectos.get(j).getProyecto_monto();
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);

                                        if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_ejecucion()), fuente3));
                                            totaleje += resultproyectos.get(j).getPe_ejecucion();
                                        } else {
                                            cell = new PdfPCell(new Paragraph("---", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);
                                    }

                                    if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                        cell = new PdfPCell(new Paragraph("--", fuente3));
                                    } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() < 0) {
                                        cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación", fuente3));
                                    } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() == 0) {
                                        cell = new PdfPCell(new Paragraph("Proyecto no evaluado", fuente3));
                                    } else if (resultproyectos.get(j).getPe_eficacia() == -2) {
                                        cell = new PdfPCell(new Paragraph("Proyecto no enviado para evaluación", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación en este periodo", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);
                                }
                                cell = new PdfPCell(new Paragraph("TOTAL", fuentetitulo));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setColspan(3);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                BigDecimal efit = BigDecimal.valueOf(totalf);
                                BigDecimal efict = BigDecimal.valueOf(totalefi);
                                efit = efit.setScale(2, RoundingMode.HALF_UP);
                                efict = efict.setScale(2, RoundingMode.HALF_UP);
                                if (tot == 0) {
                                    totalefe = ((efict.doubleValue()) + (efit.doubleValue()));
                                } else {
                                    totalefe = ((efict.doubleValue() / tot) + (efit.doubleValue() / tot));
                                }
                                BigDecimal efec = BigDecimal.valueOf(totalefe);
                                efec = efec.setScale(2, RoundingMode.HALF_UP);

                                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                    if (tot == 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);

                                    if (tot == 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efict) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efict.doubleValue() / tot) + "%", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);

                                    if (tot == 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efec) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efec.doubleValue() / 2) + "%", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(formateador.format(tmplan), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(formateador.format(totaleje), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setColspan(2);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);
                                } else {
                                    if (tot == 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setColspan(2);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);
                                }
                                document.add(tablef);
                                document.add(new Paragraph(" "));
                            }
                        }
                    } else {
                        if (cuatrimestre.equals("0")) {
                            resultproyectos = aComp.ListaProyectoPOAEvalProyComp(Integer.parseInt(sarea), Integer.parseInt(tipo), Integer.parseInt(anio));
                        } else {
                            resultproyectos = aComp.ListaProyectoPOAEvalProy(Integer.parseInt(sarea), Integer.parseInt(tipo), Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                        }
                        if (resultproyectos.size() > 0) {
                            Chunk parte3 = new Chunk("DETALLE POR PROYECTOS", fuen);
                            Paragraph para3 = new Paragraph();
                            para3.add(parte3);
                            para3.setAlignment(Element.ALIGN_CENTER);
                            document.add(para3);
                            document.add(new Paragraph(" "));

                            PdfPTable tablef;
                            if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                tablef = new PdfPTable(9);
                                tablef.setTotalWidth(new float[]{80, 120, 70, 70, 70, 70, 70, 70, 70});
                                tablef.setLockedWidth(true);
                            } else {
                                tablef = new PdfPTable(5);
                                tablef.setTotalWidth(new float[]{170, 235, 100, 100, 85});
                                tablef.setLockedWidth(true);
                            }
                            PdfPCell cell;

                            cell = new PdfPCell(new Paragraph("CÓDIGO", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("PROYECTO", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("TIPO PROYECTO", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph("EFICACIA", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                cell = new PdfPCell(new Paragraph("EFICIENCIA", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph("EFECTIVIDAD", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph("PLANIFICADO", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph("EJECUCIÓN", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                            }

                            cell = new PdfPCell(new Paragraph("OBSERVACIÓN", fuentetexto));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);
                            double totalf = 0, totalefi = 0, totalefe = 0, totaleje = 0, tmplan = 0;
                            int tot = 0;

                            for (int j = 0; j < resultproyectos.size(); j++) {
                                cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_codigo(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_nombre(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getTp_nombre(), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                tablef.addCell(cell);

                                if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficacia()) + "%", fuente3));
                                    totalf += resultproyectos.get(j).getPe_eficacia();
                                    tot++;
                                } else {
                                    cell = new PdfPCell(new Paragraph("---", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                tablef.addCell(cell);

                                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                    if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficiencia()) + "%", fuente3));
                                        totalefi += resultproyectos.get(j).getPe_eficiencia();
                                    } else {
                                        cell = new PdfPCell(new Paragraph("---", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);

                                    if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_efectividad()) + "%", fuente3));
                                        totalefe += resultproyectos.get(j).getPe_efectividad();
                                    } else {
                                        cell = new PdfPCell(new Paragraph("---", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getProyecto_monto()), fuente3));
                                    tmplan += resultproyectos.get(j).getProyecto_monto();
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);

                                    if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_ejecucion()), fuente3));
                                        totaleje += resultproyectos.get(j).getPe_ejecucion();
                                    } else {
                                        cell = new PdfPCell(new Paragraph("---", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);
                                }

                                if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                    cell = new PdfPCell(new Paragraph("--", fuente3));
                                } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() < 0) {
                                    cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación", fuente3));
                                } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() == 0) {
                                    cell = new PdfPCell(new Paragraph("Proyecto no evaluado", fuente3));
                                } else if (resultproyectos.get(j).getPe_eficacia() == -2) {
                                    cell = new PdfPCell(new Paragraph("Proyecto no enviado para evaluación", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación en este periodo", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setPadding(3);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                tablef.addCell(cell);
                            }
                            cell = new PdfPCell(new Paragraph("TOTAL", fuentetitulo));
                            cell.setPadding(5);
                            cell.setBackgroundColor(azul);
                            cell.setBorderWidthRight(1);
                            cell.setColspan(3);
                            cell.setBorderColorRight(BaseColor.WHITE);
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            tablef.addCell(cell);

                            BigDecimal efit = BigDecimal.valueOf(totalf);
                            BigDecimal efict = BigDecimal.valueOf(totalefi);
                            efit = efit.setScale(2, RoundingMode.HALF_UP);
                            efict = efict.setScale(2, RoundingMode.HALF_UP);
                            if (tot == 0) {
                                totalefe = ((efict.doubleValue()) + (efit.doubleValue()));
                            } else {
                                totalefe = ((efict.doubleValue() / tot) + (efit.doubleValue() / tot));
                            }
                            BigDecimal efec = BigDecimal.valueOf(totalefe);
                            efec = efec.setScale(2, RoundingMode.HALF_UP);

                            if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                if (tot == 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                cell.setPadding(3);
                                tablef.addCell(cell);

                                if (tot == 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efict) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efict.doubleValue() / tot) + "%", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                cell.setPadding(3);
                                tablef.addCell(cell);

                                if (tot == 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efec) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efec.doubleValue() / 2) + "%", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                cell.setPadding(3);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph(formateador.format(tmplan), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setBorderWidth(1);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                cell.setPadding(3);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph(formateador.format(totaleje), fuente3));
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setBorderWidth(1);
                                cell.setColspan(2);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                cell.setPadding(3);
                                tablef.addCell(cell);
                            } else {
                                if (tot == 0) {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                } else {
                                    cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                }
                                cell.setBackgroundColor(BaseColor.WHITE);
                                cell.setBorderWidth(1);
                                cell.setColspan(2);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                cell.setPadding(3);
                                tablef.addCell(cell);
                            }
                            document.add(tablef);
                            document.add(new Paragraph(" "));
                        }
                    }
                } else {
                    if (tipo.equals("0")) {
                        oeii = 1;
                        oeif = 4;
                    } else {
                        oeii = Integer.parseInt(tipo);
                        oeif = Integer.parseInt(tipo);
                    }
                    String oenombre;

                    for (int oe = oeii; oe <= oeif; oe++) {
                        if (oe == 1) {
                            oenombre = "ACADÉMICO";
                        } else if (oe == 2) {
                            oenombre = "INVESTIGACIÓN";
                        } else if (oe == 3) {
                            oenombre = "VINCULACIÓN";
                        } else {
                            oenombre = "GESTIÓN";
                        }

                        if (resultunidadespadre.get(0).getTag_id() != 4) {
                            for (int k = 0; k < resultunidadespadre.size(); k++) {
                                if (cuatrimestre.equals("0")) {
                                    resultproyectos = aComp.ListaProyectoPOAEvalProyComp(resultunidadespadre.get(k).getAg_id(), oe, Integer.parseInt(anio));
                                } else {
                                    resultproyectos = aComp.ListaProyectoPOAEvalProy(resultunidadespadre.get(k).getAg_id(), oe, Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                                }
                                if (resultproyectos.size() > 0) {
                                    Chunk parte3 = new Chunk(resultunidadespadre.get(k).getAg_nombre() + " - " + oenombre, fuen);
                                    Paragraph para3 = new Paragraph();
                                    para3.add(parte3);
                                    para3.setAlignment(Element.ALIGN_CENTER);
                                    document.add(para3);
                                    document.add(new Paragraph(" "));

                                    PdfPTable tablef;
                                    tablef = new PdfPTable(9);
                                    tablef.setTotalWidth(new float[]{80, 120, 70, 70, 70, 70, 70, 70, 70});
                                    tablef.setLockedWidth(true);
                                    PdfPCell cell;

                                    cell = new PdfPCell(new Paragraph("CÓDIGO", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("PROYECTO", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("TIPO PROYECTO", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("EFICACIA", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("EFICIENCIA", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("EFECTIVIDAD", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("PLANIFICADO", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("EJECUCIÓN", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("OBSERVACIÓN", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                    double totalf = 0, totalefi = 0, totalefe = 0, totaleje = 0, tmplan = 0;
                                    int tot = 0;
                                    for (int j = 0; j < resultproyectos.size(); j++) {
                                        cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_codigo(), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_nombre(), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getTp_nombre(), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);

                                        if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficacia()) + "%", fuente3));
                                            totalf += resultproyectos.get(j).getPe_eficacia();
                                            tot++;
                                        } else {
                                            cell = new PdfPCell(new Paragraph("---", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);

                                        if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                            if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                                cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficiencia()) + "%", fuente3));
                                                totalefi += resultproyectos.get(j).getPe_eficiencia();
                                            } else {
                                                cell = new PdfPCell(new Paragraph("---", fuente3));
                                            }
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setPadding(3);
                                            cell.setBorderWidth(1);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                            tablef.addCell(cell);

                                            if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                                cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_efectividad()) + "%", fuente3));
                                                totalefe += resultproyectos.get(j).getPe_efectividad();
                                            } else {
                                                cell = new PdfPCell(new Paragraph("---", fuente3));
                                            }
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setPadding(3);
                                            cell.setBorderWidth(1);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                            tablef.addCell(cell);

                                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getProyecto_monto()), fuente3));
                                            tmplan += resultproyectos.get(j).getProyecto_monto();
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setPadding(3);
                                            cell.setBorderWidth(1);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                            tablef.addCell(cell);

                                            if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                                cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_ejecucion()), fuente3));
                                                totaleje += resultproyectos.get(j).getPe_ejecucion();
                                            } else {
                                                cell = new PdfPCell(new Paragraph("---", fuente3));
                                            }
                                            cell.setBackgroundColor(BaseColor.WHITE);
                                            cell.setPadding(3);
                                            cell.setBorderWidth(1);
                                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                            tablef.addCell(cell);
                                        }

                                        if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                            cell = new PdfPCell(new Paragraph("--", fuente3));
                                        } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() < 0) {
                                            cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación", fuente3));
                                        } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() == 0) {
                                            cell = new PdfPCell(new Paragraph("Proyecto no evaluado", fuente3));
                                        } else if (resultproyectos.get(j).getPe_eficacia() == -2) {
                                            cell = new PdfPCell(new Paragraph("Proyecto no enviado para evaluación", fuente3));
                                        } else {
                                            cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación en este periodo", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);
                                    }
                                    cell = new PdfPCell(new Paragraph("TOTAL", fuentetitulo));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setColspan(3);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    BigDecimal efit = BigDecimal.valueOf(totalf);
                                    BigDecimal efict = BigDecimal.valueOf(totalefi);
                                    efit = efit.setScale(2, RoundingMode.HALF_UP);
                                    efict = efict.setScale(2, RoundingMode.HALF_UP);
                                    if (tot == 0) {
                                        totalefe = ((efict.doubleValue()) + (efit.doubleValue()));
                                    } else {
                                        totalefe = ((efict.doubleValue() / tot) + (efit.doubleValue() / tot));
                                    }
                                    BigDecimal efec = BigDecimal.valueOf(totalefe);
                                    efec = efec.setScale(2, RoundingMode.HALF_UP);

                                    if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                        if (tot == 0) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                        } else {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        cell.setPadding(3);
                                        tablef.addCell(cell);

                                        if (tot == 0) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efict) + "%", fuente3));
                                        } else {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efict.doubleValue() / tot) + "%", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        cell.setPadding(3);
                                        tablef.addCell(cell);

                                        if (tot == 0) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efec) + "%", fuente3));
                                        } else {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efec.doubleValue() / 2) + "%", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        cell.setPadding(3);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph(formateador.format(tmplan), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        cell.setPadding(3);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph(formateador.format(totaleje), fuente3));
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setBorderWidth(1);
                                        cell.setColspan(2);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        cell.setPadding(3);
                                        tablef.addCell(cell);
                                    } else {
                                        if (tot == 0) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                        } else {
                                            cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setBorderWidth(1);
                                        cell.setColspan(2);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                        cell.setPadding(3);
                                        tablef.addCell(cell);
                                    }
                                    document.add(tablef);
                                    document.add(new Paragraph(" "));
                                }
                            }
                        } else {
                            if (cuatrimestre.equals("0")) {
                                resultproyectos = aComp.ListaProyectoPOAEvalProyComp(Integer.parseInt(sarea), oe, Integer.parseInt(anio));
                            } else {
                                resultproyectos = aComp.ListaProyectoPOAEvalProy(Integer.parseInt(sarea), oe, Integer.parseInt(cuatrimestre), Integer.parseInt(anio));
                            }
                            if (resultproyectos.size() > 0) {
                                Chunk parte3 = new Chunk("DETALLE POR PROYECTOS" + " - " + oenombre, fuen);
                                Paragraph para3 = new Paragraph();
                                para3.add(parte3);
                                para3.setAlignment(Element.ALIGN_CENTER);
                                document.add(para3);
                                document.add(new Paragraph(" "));

                                PdfPTable tablef;
                                tablef = new PdfPTable(9);
                                tablef.setTotalWidth(new float[]{80, 120, 70, 70, 70, 70, 70, 70, 70});
                                tablef.setLockedWidth(true);
                                PdfPCell cell;

                                cell = new PdfPCell(new Paragraph("CÓDIGO", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph("PROYECTO", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph("TIPO PROYECTO", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                cell = new PdfPCell(new Paragraph("EFICACIA", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                    cell = new PdfPCell(new Paragraph("EFICIENCIA", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("EFECTIVIDAD", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("PLANIFICADO", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph("EJECUCIÓN", fuentetexto));
                                    cell.setPadding(5);
                                    cell.setBackgroundColor(azul);
                                    cell.setBorderWidthRight(1);
                                    cell.setBorderColorRight(BaseColor.WHITE);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    tablef.addCell(cell);
                                }

                                cell = new PdfPCell(new Paragraph("OBSERVACIÓN", fuentetexto));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);
                                double totalf = 0, totalefi = 0, totalefe = 0, totaleje = 0, tmplan = 0;
                                int tot = 0;

                                for (int j = 0; j < resultproyectos.size(); j++) {
                                    cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_codigo(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getProyecto_nombre(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(resultproyectos.get(j).getTp_nombre(), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);

                                    if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficacia()) + "%", fuente3));
                                        totalf += resultproyectos.get(j).getPe_eficacia();
                                        tot++;
                                    } else {
                                        cell = new PdfPCell(new Paragraph("---", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);

                                    if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                        if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_eficiencia()) + "%", fuente3));
                                            totalefi += resultproyectos.get(j).getPe_eficiencia();
                                        } else {
                                            cell = new PdfPCell(new Paragraph("---", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);

                                        if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_efectividad()) + "%", fuente3));
                                            totalefe += resultproyectos.get(j).getPe_efectividad();
                                        } else {
                                            cell = new PdfPCell(new Paragraph("---", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);

                                        cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getProyecto_monto()), fuente3));
                                        tmplan += resultproyectos.get(j).getProyecto_monto();
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);

                                        if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                            cell = new PdfPCell(new Paragraph(formateador.format(resultproyectos.get(j).getPe_ejecucion()), fuente3));
                                            totaleje += resultproyectos.get(j).getPe_ejecucion();
                                        } else {
                                            cell = new PdfPCell(new Paragraph("---", fuente3));
                                        }
                                        cell.setBackgroundColor(BaseColor.WHITE);
                                        cell.setPadding(3);
                                        cell.setBorderWidth(1);
                                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                        tablef.addCell(cell);
                                    }

                                    if (resultproyectos.get(j).getPe_eficacia() > -1) {
                                        cell = new PdfPCell(new Paragraph("--", fuente3));
                                    } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() < 0) {
                                        cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación", fuente3));
                                    } else if (cuatrimestre.equals("0") && resultproyectos.get(j).getPe_eficacia() == 0) {
                                        cell = new PdfPCell(new Paragraph("Proyecto no evaluado", fuente3));
                                    } else if (resultproyectos.get(j).getPe_eficacia() == -2) {
                                        cell = new PdfPCell(new Paragraph("Proyecto no enviado para evaluación", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph("Proyecto no sujeto a evaluación en este periodo", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setPadding(3);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                                    tablef.addCell(cell);
                                }
                                cell = new PdfPCell(new Paragraph("TOTAL", fuentetitulo));
                                cell.setPadding(5);
                                cell.setBackgroundColor(azul);
                                cell.setBorderWidthRight(1);
                                cell.setColspan(3);
                                cell.setBorderColorRight(BaseColor.WHITE);
                                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                tablef.addCell(cell);

                                BigDecimal efit = BigDecimal.valueOf(totalf);
                                BigDecimal efict = BigDecimal.valueOf(totalefi);
                                efit = efit.setScale(2, RoundingMode.HALF_UP);
                                efict = efict.setScale(2, RoundingMode.HALF_UP);
                                if (tot == 0) {
                                    totalefe = ((efict.doubleValue()) + (efit.doubleValue()));
                                } else {
                                    totalefe = ((efict.doubleValue() / tot) + (efit.doubleValue() / tot));
                                }
                                BigDecimal efec = BigDecimal.valueOf(totalefe);
                                efec = efec.setScale(2, RoundingMode.HALF_UP);

                                if (cuatrimestre.equals("3") || cuatrimestre.equals("0") || !anio.equals("2020")) {
                                    if (tot == 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);

                                    if (tot == 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efict) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efict.doubleValue() / tot) + "%", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);

                                    if (tot == 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efec) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efec.doubleValue() / 2) + "%", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(formateador.format(tmplan), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);

                                    cell = new PdfPCell(new Paragraph(formateador.format(totaleje), fuente3));
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setColspan(2);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);
                                } else {
                                    if (tot == 0) {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efit) + "%", fuente3));
                                    } else {
                                        cell = new PdfPCell(new Paragraph(formateador.format(efit.doubleValue() / tot) + "%", fuente3));
                                    }
                                    cell.setBackgroundColor(BaseColor.WHITE);
                                    cell.setBorderWidth(1);
                                    cell.setColspan(2);
                                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                                    cell.setVerticalAlignment(Element.ALIGN_CENTER);
                                    cell.setPadding(3);
                                    tablef.addCell(cell);
                                }
                                document.add(tablef);
                                document.add(new Paragraph(" "));
                            }
                        }
                    }
                }
            }
        } catch (DocumentException de) {
            de.printStackTrace();
            System.err.println("document: " + de.getMessage());
            System.err.println("error: " + de.getMessage());
        }
// Paso: Cerramos el ‘document (el ‘outputstream’ se cierra automáticamente internamente)

        document.close();
    }

    private void reporteJustificativo(HttpServletRequest request, HttpServletResponse response) throws FileNotFoundException, IOException, DocumentException {
        //3-top
        //1-left
        Document document = new Document(PageSize.LETTER, 40, 45, 10, 50);
        //Document document = new Document(PageSize.LETTER, 60, 45, 140, 75);
        DecimalFormat formateador = new DecimalFormat("####,###,###.##");
        try {
            String path = getServletContext().getRealPath("/") + "img/reporte/";
            String pathimg = getServletContext().getRealPath("/") + "img/reporte/";
// Paso 2: Establecemos el ContentType y creamos una instancia del Writer
            response.setContentType("application/pdf");
            String solicitud = request.getParameter("idjustificativo");
            String estado = request.getParameter("idestadojust");
            String anio = request.getParameter("anioid");
            OutputStream file = new FileOutputStream(new File(path + "reporte_justificativo.pdf"));
            PdfWriter writer = PdfWriter.getInstance(document, response.getOutputStream());
            //PdfWriter writer2 = PdfWriter.getInstance(document, file);
            formatoBlanco eventos = new formatoBlanco();

            writer.setPageEvent(eventos);
            //writer2.setPageEvent(eventos);
// Paso 3
            document.open();
// Paso 4
            document.addTitle("Justificativo");

            Font fuente = new Font();
            fuente.setSize(10);
            Font fuen = new Font(Font.FontFamily.HELVETICA, 8, 1);
            Font fuendatost = new Font(Font.FontFamily.HELVETICA, 6, 1);
            Font fuendatossn = new Font(Font.FontFamily.HELVETICA, 7);
            Font fuen2 = new Font(Font.FontFamily.HELVETICA, 4);
            Font fuendatos = new Font(Font.FontFamily.HELVETICA, 6);
            Double o1 = 0.0, o2 = 0.0, o3 = 0.0, o4 = 0.0;

            adEjecucion cEje = new adEjecucion();
            List<cActividadRequerimiento> solicitudda = new ArrayList<cActividadRequerimiento>();
            List<cActividadRequerimiento> requerimientos = new ArrayList<cActividadRequerimiento>();
            solicitudda = cEje.ListarSolicitudDatos(Integer.parseInt(solicitud));

            PdfPTable table = new PdfPTable(8);
            table.setTotalWidth(new float[]{35, 65, 60, 90, 90, 90, 55, 55});
            table.setLockedWidth(true);
            PdfPCell cell;

            cell = new PdfPCell();
            cell.setColspan(2);
            //cell.setRowspan(2);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            Image image = Image.getInstance(pathimg + "ESPOCH.png");
            image.scalePercent(8, 8);
            image.setAlignment(Element.ALIGN_MIDDLE);
            cell.addElement(image);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("ESCUELA SUPERIOR POLITÉCNICA DE CHIMBORAZO\n JUSTIFICATIVO DE REQUERIMIENTO Y SOLICITUD DE COMPRA", fuen));
            cell.setColspan(6);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            table.addCell(cell);

            for (int i = 0; i < solicitudda.size(); i++) {
                Date date = Calendar.getInstance().getTime();
                DateFormat formatter = new SimpleDateFormat("dd/MM/yyyy");
                String today = formatter.format(solicitudda.get(i).getSolestado_fecha());
                String today2 = formatter.format(date);
                cell = new PdfPCell(new Paragraph("FACULTAD/DEPARTAMENTO: " + solicitudda.get(i).getAg_nombre(), fuen));
                cell.setColspan(6);
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("No: " + solicitudda.get(i).getSolicitud_codigo() + "-UCP-" + anio, fuen));
                cell.setColspan(2);
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CENTRO DE COSTO: " + solicitudda.get(i).getSolicitud_centro_costo(), fuen));
                cell.setColspan(6);
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("USO EXCLUSIVO U.COMPRAS PUBLICAS", fuen2));
                cell.setColspan(2);
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("PARA:", fuen));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(solicitudda.get(i).getAutoridades_nombre() + " - " + solicitudda.get(i).getAutoridades_cargo(), fuendatossn));
                cell.setColspan(7);
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("DE ", fuen));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(solicitudda.get(i).getUsuario_titulo() + " " + solicitudda.get(i).getUsuario_nombre() + " - " + solicitudda.get(i).getTc_nombre(), fuendatossn));
                cell.setColspan(7);
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("FECHA:", fuen));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                table.addCell(cell);

                if (estado.equals("37") || estado.equals("38")) {
                    cell = new PdfPCell(new Paragraph(today2, fuendatossn));
                } else {
                    cell = new PdfPCell(new Paragraph(today, fuendatossn));
                }
                cell.setColspan(7);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("(1) OEI.", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("(2) CANT.", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("(3) UNIDAD DE MEDIDA.", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("(4) DESCRIPCION Y/O ESPECIFICACIONES (En base al Sistema de Control de Bienes e Inventarios)", fuendatost));
                cell.setColspan(3);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("(5) PRESUPUESTO REFERENCIAL INDIVIDUAL (SIN IVA)", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("(6) PRESUPUESTO REFERENCIAL TOTAL (1X4) (SIN IVA)", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                table.addCell(cell);

                requerimientos = cEje.ListarSolicitudSolicitud(Integer.parseInt(solicitud));
                double total = 0;
                for (int j = 0; j < requerimientos.size(); j++) {
                    switch (requerimientos.get(j).getPerspectiva_id()) {
                        case 1:
                            o1 = o1 + requerimientos.get(j).getReq_costo_sin_iva();
                            break;
                        case 2:
                            o2 = o2 + requerimientos.get(j).getReq_costo_sin_iva();
                            break;
                        case 3:
                            o3 = o3 + requerimientos.get(j).getReq_costo_sin_iva();
                            break;
                        case 4:
                            o4 = o4 + requerimientos.get(j).getReq_costo_sin_iva();
                            break;
                    }
                    cell = new PdfPCell(new Paragraph("OEI-0" + requerimientos.get(j).getPerspectiva_id(), fuendatossn));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph(requerimientos.get(j).getReq_cantidad().toString(), fuendatossn));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph(requerimientos.get(j).getUnidad_nombre(), fuendatossn));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph(requerimientos.get(j).getReq_nombre(), fuendatossn));
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setColspan(3);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph(formateador.format(requerimientos.get(j).getReq_costo_unitario()), fuendatossn));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph(formateador.format(requerimientos.get(j).getReq_costo_sin_iva()), fuendatossn));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    table.addCell(cell);
                    total += requerimientos.get(j).getReq_costo_sin_iva();
                }
                cell = new PdfPCell(new Paragraph("NOTA: En cada Solicitud se deberán agrupar homogeneamente los bienes y servicios, conforme la naturaleza de los mismos. Adjuntar informe técnico en los casos en que aplique", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("TOTAL (SIN IVA)", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("$ " + formateador.format(total), fuendatossn));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("SOLICITADO POR:", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("AUTORIZADO POR:", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CUSTODIO:", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                cell.setRowspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                cell.setRowspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("NOMBRE: " + solicitudda.get(i).getSolicitud_nombre(), fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CÉDULA: " + solicitudda.get(i).getSolicitud_cedula(), fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CARGO: " + solicitudda.get(i).getSolicitud_cargo(), fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("___________________________", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("___________________________", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                cell.setRowspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(solicitudda.get(i).getUsuario_titulo() + " " + solicitudda.get(i).getUsuario_nombre(), fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(solicitudda.get(i).getAutoridades_nombre(), fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(solicitudda.get(i).getTc_nombre(), fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(solicitudda.get(i).getAutoridades_cargo(), fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("___________________________", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(solicitudda.get(i).getUsuario_cedula(), fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CI: " + solicitudda.get(i).getAutoridades_cedula(), fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("FIRMA", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                if (solicitudda.get(i).getAutoridades_id() == 4) {
                    cell = new PdfPCell(new Paragraph("Delegado Resolución Administrativa No.015.ESPOCH.2019", fuendatost));
                } else {
                    cell = new PdfPCell(new Paragraph(" ", fuendatost));
                }
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("UNIDAD DE COMPRAS PÚBLICAS", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.LIGHT_GRAY);
                cell.setColspan(8);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("VERIFICACIÓN PLAN OPERATIVO ANUAL", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.LIGHT_GRAY);
                cell.setColspan(8);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CONTROL DE TRAMITE", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("EXISTE LO SOLICITADO EN EL PAC:", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("SI X             NO __", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("FIRMA Y FECHA DE INGRESO", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("_____________________________________", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(4);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("COORDINADOR ADMINISTRATIVO DE COMPRAS PÚBLICAS", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("FIRMA Y FECHA DE SALIDA", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(4);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CC:", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("PROCESO DE CONTRATACIÓN", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setColspan(8);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("AUTORIZACIÓN ÍNFIMA CUANTÍA", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("Obras", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("Consultoría", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("Catálogo Electrónico", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("Infima Cuantía", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("Proceso dinámicos y comunes", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("Régimen Especial", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("SI __", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("NO __", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                table.addCell(cell);

                //Linea en blanco
                if (solicitudda.get(i).getTc_id() == 1) {
                    cell = new PdfPCell(new Paragraph("X", fuendatos));
                } else {
                    cell = new PdfPCell(new Paragraph(" ", fuendatos));
                }
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                if (solicitudda.get(i).getTc_id() == 2) {
                    cell = new PdfPCell(new Paragraph("X", fuendatos));
                } else {
                    cell = new PdfPCell(new Paragraph(" ", fuendatos));
                }
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                if (solicitudda.get(i).getTc_id() == 3) {
                    cell = new PdfPCell(new Paragraph("X", fuendatos));
                } else {
                    cell = new PdfPCell(new Paragraph(" ", fuendatos));
                }
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                if (solicitudda.get(i).getTc_id() == 4) {
                    cell = new PdfPCell(new Paragraph("X", fuendatos));
                } else {
                    cell = new PdfPCell(new Paragraph(" ", fuendatos));
                }
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                if (solicitudda.get(i).getTc_id() == 5) {
                    cell = new PdfPCell(new Paragraph("X", fuendatos));
                } else {
                    cell = new PdfPCell(new Paragraph(" ", fuendatos));
                }
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                if (solicitudda.get(i).getTc_id() == 6) {
                    cell = new PdfPCell(new Paragraph("X", fuendatos));
                } else {
                    cell = new PdfPCell(new Paragraph(" ", fuendatos));
                }
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                //Linea en blanco 2
                cell = new PdfPCell(new Paragraph(" ", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                //Linea en blanco 2.1
                cell = new PdfPCell(new Paragraph(" ", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                //Linea en blanco 3
                cell = new PdfPCell(new Paragraph(" ", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("_______________________", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("OTRO: (especifique)", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                if (solicitudda.get(i).getTc_id() == 7) {
                    cell = new PdfPCell(new Paragraph(solicitudda.get(i).getAe_observacion(), fuendatos));
                } else {
                    cell = new PdfPCell(new Paragraph(".............................................................................", fuendatost));
                }
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setColspan(4);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("FIRMA Y SELLO", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CC:", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("Art.60 del reglamento de 'Sistema Nacional de Contratación Pública'", fuen2));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("DIRECCIÓN DE PLANIFICACIÓN", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.LIGHT_GRAY);
                cell.setColspan(8);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("VERIFICACIÓN PLAN OPERATIVO ANUAL", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.LIGHT_GRAY);
                cell.setColspan(8);
                table.addCell(cell);

                //Planificacion
                cell = new PdfPCell(new Paragraph("EXISTE LO SOLICITADO EN EL POA:", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("SI X             NO __", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CONTROL DE TRAMITE", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("FIRMA Y FECHA DE INGRESO", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("OEI-01 Docencia", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                if (o1 > 0) {
                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(o1), fuendatost));
                } else {
                    cell = new PdfPCell(new Paragraph("_", fuendatost));
                }
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("OEI-02 Investigación", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                if (o2 > 0) {
                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(o2), fuendatost));
                } else {
                    cell = new PdfPCell(new Paragraph("_", fuendatost));
                }
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("_____________________________________", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("FIRMA Y FECHA DE SALIDA", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("OEI-03 Vinculación", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                if (o3 > 0) {
                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(o3), fuendatost));
                } else {
                    cell = new PdfPCell(new Paragraph("_", fuendatost));
                }
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("DIRECTOR/A DE PLANIFICACIÓN", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("OEI-04 Gestión Administrativa", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                if (o4 > 0) {
                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(o4), fuendatost));
                } else {
                    cell = new PdfPCell(new Paragraph("_", fuendatost));
                }
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CC:", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("DIRECCIÓN FINANCIERA", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.LIGHT_GRAY);
                cell.setColspan(8);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("VERIFICACIÓN PLAN OPERATIVO ANUAL", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.LIGHT_GRAY);
                cell.setColspan(8);
                table.addCell(cell);

                //Financiero
                cell = new PdfPCell(new Paragraph("Unidad de Presupuesto: Sirvase emitir la certificación presupuestaria y continué con el trámite correspondiente.", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CONTROL DE TRAMITE", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("FIRMA Y FECHA DE INGRESO", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(4);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("_____________________________________", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("FIRMA Y FECHA DE SALIDA", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(4);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("DIRECTOR/A FINANCIERO/A", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(4);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CC:", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);
            }

            document.add(table);

        } catch (DocumentException de) {
            de.printStackTrace();
            System.err.println("document: " + de.getMessage());
            System.err.println("error: " + de.getMessage());
        }
// Paso: Cerramos el ‘document (el ‘outputstream’ se cierra automáticamente internamente)
        document.close();
    }

    private void reporteJustificativoUni(HttpServletRequest request, HttpServletResponse response) throws FileNotFoundException, IOException, DocumentException {
        //3-top
        //1-left
        Document document = new Document(PageSize.LETTER, 40, 45, 10, 50);
        //Document document = new Document(PageSize.LETTER, 60, 45, 140, 75);
        DecimalFormat formateador = new DecimalFormat("####,###,###.##");
        try {
            String path = getServletContext().getRealPath("/") + "img/reporte/";
            String pathimg = getServletContext().getRealPath("/") + "img/reporte/";
// Paso 2: Establecemos el ContentType y creamos una instancia del Writer
            response.setContentType("application/pdf");
            String solicitud = request.getParameter("idjustificativo");
            String estado = request.getParameter("idestadojust");
            String anio = request.getParameter("anioid");
            OutputStream file = new FileOutputStream(new File(path + "reporte_justificativo.pdf"));
            PdfWriter writer = PdfWriter.getInstance(document, response.getOutputStream());
            //PdfWriter writer2 = PdfWriter.getInstance(document, file);
            formatoBlanco eventos = new formatoBlanco();

            writer.setPageEvent(eventos);
            //writer2.setPageEvent(eventos);
// Paso 3
            document.open();
// Paso 4
            document.addTitle("Justificativo");

            Font fuente = new Font();
            fuente.setSize(10);
            Font fuen = new Font(Font.FontFamily.HELVETICA, 8, 1);
            Font fuendatost = new Font(Font.FontFamily.HELVETICA, 6, 1);
            Font fuendatossn = new Font(Font.FontFamily.HELVETICA, 7);
            Font fuen2 = new Font(Font.FontFamily.HELVETICA, 4);
            Font fuendatos = new Font(Font.FontFamily.HELVETICA, 6);
            Double o1 = 0.0, o2 = 0.0, o3 = 0.0, o4 = 0.0;

            adEjecucion cEje = new adEjecucion();
            List<cActividadRequerimiento> solicitudda = new ArrayList<cActividadRequerimiento>();
            List<cActividadRequerimiento> requerimientos = new ArrayList<cActividadRequerimiento>();
            solicitudda = cEje.ListarSolicitudDatosUnif(Integer.parseInt(solicitud));

            PdfPTable table = new PdfPTable(8);
            table.setTotalWidth(new float[]{35, 65, 60, 90, 90, 90, 55, 55});
            table.setLockedWidth(true);
            PdfPCell cell;

            cell = new PdfPCell();
            cell.setColspan(2);
            //cell.setRowspan(2);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            Image image = Image.getInstance(pathimg + "ESPOCH.png");
            image.scalePercent(8, 8);
            image.setAlignment(Element.ALIGN_MIDDLE);
            cell.addElement(image);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("ESCUELA SUPERIOR POLITÉCNICA DE CHIMBORAZO\n JUSTIFICATIVO DE REQUERIMIENTO Y SOLICITUD DE COMPRA", fuen));
            cell.setColspan(6);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            table.addCell(cell);

            for (int i = 0; i < solicitudda.size(); i++) {
                Date date = Calendar.getInstance().getTime();
                DateFormat formatter = new SimpleDateFormat("dd/MM/yyyy");
                String today = formatter.format(solicitudda.get(i).getSolestado_fecha());
                String today2 = formatter.format(date);
                cell = new PdfPCell(new Paragraph("FACULTAD/DEPARTAMENTO: " + solicitudda.get(i).getAg_nombre(), fuen));
                cell.setColspan(6);
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("No: " + solicitudda.get(i).getSolicitud_codigo() + "-UCP-" + anio, fuen));
                cell.setColspan(2);
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CENTRO DE COSTO: " + solicitudda.get(i).getSolicitud_centro_costo(), fuen));
                cell.setColspan(6);
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("USO EXCLUSIVO U.COMPRAS PUBLICAS", fuen2));
                cell.setColspan(2);
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("PARA:", fuen));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(solicitudda.get(i).getAutoridades_nombre() + " - " + solicitudda.get(i).getAutoridades_cargo(), fuendatossn));
                cell.setColspan(7);
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("DE ", fuen));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(solicitudda.get(i).getUsuario_titulo() + " " + solicitudda.get(i).getUsuario_nombre() + " - " + solicitudda.get(i).getTc_nombre(), fuendatossn));
                cell.setColspan(7);
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("FECHA:", fuen));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                table.addCell(cell);

                if (estado.equals("37") || estado.equals("38")) {
                    cell = new PdfPCell(new Paragraph(today2, fuendatossn));
                } else {
                    cell = new PdfPCell(new Paragraph(today, fuendatossn));
                }
                cell.setColspan(7);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("(1) OEI.", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("(2) CANT.", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("(3) UNIDAD DE MEDIDA.", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("(4) DESCRIPCION Y/O ESPECIFICACIONES (En base al Sistema de Control de Bienes e Inventarios)", fuendatost));
                cell.setColspan(3);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("(5) PRESUPUESTO REFERENCIAL INDIVIDUAL (SIN IVA)", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("(6) PRESUPUESTO REFERENCIAL TOTAL (1X4) (SIN IVA)", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                table.addCell(cell);

                requerimientos = cEje.ListarSolicitudSolicitudUnificados(Integer.parseInt(solicitud));
                double total = 0;
                for (int j = 0; j < requerimientos.size(); j++) {
                    switch (requerimientos.get(j).getPerspectiva_id()) {
                        case 1:
                            o1 = o1 + requerimientos.get(j).getReq_costo_sin_iva();
                            break;
                        case 2:
                            o2 = o2 + requerimientos.get(j).getReq_costo_sin_iva();
                            break;
                        case 3:
                            o3 = o3 + requerimientos.get(j).getReq_costo_sin_iva();
                            break;
                        case 4:
                            o4 = o4 + requerimientos.get(j).getReq_costo_sin_iva();
                            break;
                    }
                    cell = new PdfPCell(new Paragraph("OEI-0" + requerimientos.get(j).getPerspectiva_id(), fuendatossn));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph(requerimientos.get(j).getReq_cantidad().toString(), fuendatossn));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph(requerimientos.get(j).getUnidad_nombre(), fuendatossn));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph(requerimientos.get(j).getReq_nombre(), fuendatossn));
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setColspan(3);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph(formateador.format(requerimientos.get(j).getReq_costo_unitario()), fuendatossn));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph(formateador.format(requerimientos.get(j).getReq_costo_sin_iva()), fuendatossn));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    table.addCell(cell);
                    total += requerimientos.get(j).getReq_costo_sin_iva();
                }
                cell = new PdfPCell(new Paragraph("NOTA: En cada Solicitud se deberán agrupar homogeneamente los bienes y servicios, conforme la naturaleza de los mismos. Adjuntar informe técnico en los casos en que aplique", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("TOTAL (SIN IVA)", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("$ " + formateador.format(total), fuendatossn));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("SOLICITADO POR:", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("AUTORIZADO POR:", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CUSTODIO:", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                cell.setRowspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                cell.setRowspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("NOMBRE: " + solicitudda.get(i).getSolicitud_nombre(), fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CÉDULA: " + solicitudda.get(i).getSolicitud_cedula(), fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CARGO: " + solicitudda.get(i).getSolicitud_cargo(), fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("___________________________", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("___________________________", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                cell.setRowspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(solicitudda.get(i).getUsuario_titulo() + " " + solicitudda.get(i).getUsuario_nombre(), fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(solicitudda.get(i).getAutoridades_nombre(), fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(solicitudda.get(i).getTc_nombre(), fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(solicitudda.get(i).getAutoridades_cargo(), fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("___________________________", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CI: " + solicitudda.get(i).getUsuario_cedula(), fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CI: " + solicitudda.get(i).getAutoridades_cedula(), fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("FIRMA", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                if (solicitudda.get(i).getAutoridades_id() == 4) {
                    cell = new PdfPCell(new Paragraph("Delegado Resolución Administrativa No.015.ESPOCH.2019", fuendatost));
                } else {
                    cell = new PdfPCell(new Paragraph(" ", fuendatost));
                }
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("UNIDAD DE COMPRAS PÚBLICAS", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.LIGHT_GRAY);
                cell.setColspan(8);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("VERIFICACIÓN PLAN OPERATIVO ANUAL", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.LIGHT_GRAY);
                cell.setColspan(8);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("EXISTE LO SOLICITADO EN EL PAC:", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("SI X             NO __", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CONTROL DE TRAMITE", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("FIRMA Y FECHA DE INGRESO", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("EXISTE LO SOLICITADO EN EL", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CÁTALOGO ELECTRÓNICO", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("SI __            NO __", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("_____________________________________", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("FIRMA Y FECHA DE SALIDA", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(4);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("COORDINADOR ADMINISTRATIVO DE COMPRAS PÚBLICAS", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(4);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CC:", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("PROCESO DE CONTRATACIÓN", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setColspan(8);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("AUTORIZACIÓN ÍNFIMA CUANTÍA", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("Obras", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("Consultoría", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("Catálogo Electrónico", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("Infima Cuantía", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("Proceso dinámicos y comunes", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("Régimen Especial", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("SI __", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("NO __", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                table.addCell(cell);

                //Linea en blanco
                cell = new PdfPCell(new Paragraph(" ", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                //Linea en blanco 2
                cell = new PdfPCell(new Paragraph(" ", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                //Linea en blanco 2.1
                cell = new PdfPCell(new Paragraph(" ", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                //Linea en blanco 3
                cell = new PdfPCell(new Paragraph(" ", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("_______________________", fuendatos));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("OTRO: (especifique)", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(".............................................................................", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setColspan(4);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("FIRMA Y SELLO", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CC:", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("Art.60 del reglamento de 'Sistema Nacional de Contratación Pública'", fuen2));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("DIRECCIÓN DE PLANIFICACIÓN", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.LIGHT_GRAY);
                cell.setColspan(8);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("VERIFICACIÓN PLAN OPERATIVO ANUAL", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.LIGHT_GRAY);
                cell.setColspan(8);
                table.addCell(cell);

                //Planificacion
                cell = new PdfPCell(new Paragraph("EXISTE LO SOLICITADO EN EL POA:", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(3);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("SI X             NO __", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CONTROL DE TRAMITE", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("FIRMA Y FECHA DE INGRESO", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("OEI-01 Docencia", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                if (o1 > 0) {
                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(o1), fuendatost));
                } else {
                    cell = new PdfPCell(new Paragraph("_", fuendatost));
                }
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("OEI-02 Investigación", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                if (o2 > 0) {
                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(o2), fuendatost));
                } else {
                    cell = new PdfPCell(new Paragraph("_", fuendatost));
                }
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("_____________________________________", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("FIRMA Y FECHA DE SALIDA", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("OEI-03 Vinculación", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                if (o3 > 0) {
                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(o3), fuendatost));
                } else {
                    cell = new PdfPCell(new Paragraph("_", fuendatost));
                }
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("DIRECTOR/A DE PLANIFICACIÓN", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("OEI-04 Gestión Administrativa", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                if (o4 > 0) {
                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(o4), fuendatost));
                } else {
                    cell = new PdfPCell(new Paragraph("_", fuendatost));
                }
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CC:", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("DIRECCIÓN FINANCIERA", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.LIGHT_GRAY);
                cell.setColspan(8);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("VERIFICACIÓN PLAN OPERATIVO ANUAL", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.LIGHT_GRAY);
                cell.setColspan(8);
                table.addCell(cell);

                //Financiero
                cell = new PdfPCell(new Paragraph("Unidad de Presupuesto: Sirvase emitir la certificación presupuestaria y continué con el trámite correspondiente.", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CONTROL DE TRAMITE", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("FIRMA Y FECHA DE INGRESO", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(4);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("_____________________________________", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("FIRMA Y FECHA DE SALIDA", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setColspan(4);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("DIRECTOR/A FINANCIERO/A", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthRight((float) 0.1);
                cell.setBorderColorRight(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(4);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("CC:", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthLeft((float) 0.1);
                cell.setBorderColorLeft(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setBorderWidthBottom((float) 0.1);
                cell.setBorderColorBottom(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(6);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuendatost));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBorderWidthTop((float) 0.1);
                cell.setBorderColorTop(BaseColor.WHITE);
                cell.setColspan(2);
                table.addCell(cell);
            }

            document.add(table);

        } catch (DocumentException de) {
            de.printStackTrace();
            System.err.println("document: " + de.getMessage());
            System.err.println("error: " + de.getMessage());
        }
// Paso: Cerramos el ‘document (el ‘outputstream’ se cierra automáticamente internamente)
        document.close();
    }

    private void reporteOficio(HttpServletRequest request, HttpServletResponse response) throws FileNotFoundException, IOException, DocumentException {
        Document document = new Document(PageSize.LETTER, 60, 45, 120, 50);
        //Document document = new Document(PageSize.LETTER, 60, 45, 140, 75);
        DecimalFormat formateador = new DecimalFormat("####,###,###.##");
        try {
            String path = getServletContext().getRealPath("/") + "img/reporte/";
            String pathimg = getServletContext().getRealPath("/") + "img/reporte/";
// Paso 2: Establecemos el ContentType y creamos una instancia del Writer
            response.setContentType("application/pdf");
            String solicitud = request.getParameter("idjustificativo");
            String numero = request.getParameter("numerooficio");
            String estado = request.getParameter("estadojus");
            String tipo = request.getParameter("tipo");
            String observacion = request.getParameter("observacion");
            String titulo, codigo;
            Integer ag;
            OutputStream file = new FileOutputStream(new File(path + "oficio_devolucion.pdf"));
            PdfWriter writer = PdfWriter.getInstance(document, response.getOutputStream());
            //PdfWriter writer2 = PdfWriter.getInstance(document, file);
            if (Integer.parseInt(estado) == 33) {
                titulo = "UNIDAD DE COMPRAS PUBLICAS";
                codigo = "UCP";
                ag = 59;
            } else {
                titulo = "DIRECCION DE PLANIFICACION";
                codigo = "DP";
                ag = 52;
            }
            formatoReporteV eventos = new formatoReporteV(path, titulo, pathimg + "logo-plan.png");

            writer.setPageEvent(eventos);
            //writer2.setPageEvent(eventos);
// Paso 3
            document.open();
// Paso 4
            document.addTitle("Memo");

            //Lista de presupuesto
            Date date = Calendar.getInstance().getTime();
            DateFormat formatter = new SimpleDateFormat();
            String today = formatter.format(date);
            List<cActividadRequerimiento> solicitudda = new ArrayList<cActividadRequerimiento>();
            List<cActividadRequerimiento> directores = new ArrayList<cActividadRequerimiento>();
            adEjecucion cEje = new adEjecucion();
            if (tipo.equals("1")) {
                solicitudda = cEje.ListarSolicitudDatos(Integer.parseInt(solicitud));
            } else {
                solicitudda = cEje.ListarSolicitudDatosUnif(Integer.parseInt(solicitud));
            }

            directores = cEje.ListarDirectoresPlaniUniC(ag);

            Font fuente = new Font();
            fuente.setSize(10);
            Font fuen = new Font(Font.FontFamily.TIMES_ROMAN, 12, 1);
            Font fuen1 = new Font(Font.FontFamily.TIMES_ROMAN, 11, Font.BOLD | Font.ITALIC);
            Font fuente1 = new Font(Font.FontFamily.TIMES_ROMAN, 11, 1);
            Font fuente2 = new Font(Font.FontFamily.TIMES_ROMAN, 10, 1);
            Font fuente3 = new Font(Font.FontFamily.TIMES_ROMAN, 10, 0);
            Font fuente3ne = new Font(Font.FontFamily.TIMES_ROMAN, 7, 1, BaseColor.BLACK);

            BaseColor azul = WebColors.getRGBColor("#133351");
            Chunk parteag = new Chunk("MEMORANDUM.No. 00" + numero + "." + codigo + ".ESPOCH.2020", fuente2);
            Paragraph paraag = new Paragraph();
            paraag.add(parteag);
            paraag.setAlignment(Element.ALIGN_RIGHT);
            document.add(paraag);
            document.add(new Paragraph(" "));

            PdfPTable tablef = new PdfPTable(4);
            tablef.setTotalWidth(new float[]{80, 180, 80, 180});
            tablef.setLockedWidth(true);
            PdfPCell cell;
            String codigoj = "0";

            for (int i = 0; i < solicitudda.size(); i++) {
                cell = new PdfPCell(new Paragraph("FECHA:", fuente2));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setBorderWidth(1);
                cell.setBorderColor(BaseColor.WHITE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph(today, fuente3));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                cell.setBorderWidth(1);
                cell.setBorderColor(BaseColor.WHITE);
                cell.setColspan(3);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("PARA: ", fuente2));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setBorderWidth(1);
                cell.setBorderColor(BaseColor.WHITE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph(solicitudda.get(i).getUsuario_titulo() + " " + solicitudda.get(i).getUsuario_nombre() + " - " + solicitudda.get(i).getTc_nombre(), fuente3));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                cell.setBorderWidth(1);
                cell.setBorderColor(BaseColor.WHITE);
                cell.setColspan(3);
                tablef.addCell(cell);
                codigoj = solicitudda.get(i).getSolicitud_codigo();
            }

            for (int j = 0; j < directores.size(); j++) {
                cell = new PdfPCell(new Paragraph("DE: ", fuente2));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setBorderWidth(1);
                cell.setBorderColor(BaseColor.WHITE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph(directores.get(j).getUsuario_titulo() + " " + directores.get(j).getUsuario_nombre() + " - " + directores.get(j).getTc_nombre(), fuente3));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                cell.setBorderWidth(1);
                cell.setBorderColor(BaseColor.WHITE);
                cell.setColspan(3);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("ASUNTO: ", fuente2));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setBorderWidth(1);
                cell.setBorderColor(BaseColor.WHITE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("DEVOLUCION DEL JUSTIFICATIVO No." + codigoj + "-UCP-2020", fuente3));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                cell.setBorderWidth(1);
                cell.setBorderColor(BaseColor.WHITE);
                cell.setColspan(3);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuente3));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                cell.setBorderWidth(1);
                cell.setBorderColor(BaseColor.WHITE);
                cell.setColspan(4);
                tablef.addCell(cell);

                Paragraph parrafo = new Paragraph();
                Chunk text1 = new Chunk("SE PROCEDE A LA DEVOLUCION DEL JUSTIFICATIVO ", fuente3);
                Chunk text2 = new Chunk("No." + codigoj + "-UCP-2020, ", fuente2);
                Chunk text3 = new Chunk(observacion, fuente3);
                parrafo.add(text1);
                parrafo.add(text2);
                parrafo.add(text3);
                cell = new PdfPCell(parrafo);
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                cell.setBorderWidth(1);
                cell.setBorderColor(BaseColor.WHITE);
                cell.setColspan(4);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("SE LE RECUERDA QUE, LA EFICIENCIA Y CALIDAD DE LOS SERVICIOS QUE PRESTA LA ESPOCH, DEPENDEN DE LA EFICIENCIA EN LA GESTION DE CADA UNO DE LOS FUNCIONARIOS", fuente3));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                cell.setBorderWidth(1);
                cell.setBorderColor(BaseColor.WHITE);
                cell.setColspan(4);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuente3));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                cell.setBorderWidth(1);
                cell.setBorderColor(BaseColor.WHITE);
                cell.setColspan(4);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph(" ", fuente3));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                cell.setBorderWidth(1);
                cell.setBorderColor(BaseColor.WHITE);
                cell.setColspan(4);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("__________________________________", fuente3));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidth(1);
                cell.setBorderColor(BaseColor.WHITE);
                cell.setColspan(4);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph(directores.get(j).getUsuario_titulo() + " " + directores.get(j).getUsuario_nombre(), fuente3));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidth(1);
                cell.setBorderColor(BaseColor.WHITE);
                cell.setColspan(4);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph(directores.get(j).getTc_nombre(), fuente2));
                cell.setBackgroundColor(BaseColor.WHITE);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setBorderWidth(1);
                cell.setBorderColor(BaseColor.WHITE);
                cell.setColspan(4);
                tablef.addCell(cell);
            }

            document.add(tablef);
        } catch (DocumentException de) {
            de.printStackTrace();
            System.err.println("document: " + de.getMessage());
            System.err.println("error: " + de.getMessage());
        }
// Paso: Cerramos el ‘document (el ‘outputstream’ se cierra automáticamente internamente)
        document.close();
    }

    private void reporteCustodios(HttpServletRequest request, HttpServletResponse response) throws FileNotFoundException, IOException, DocumentException {
        Document document = new Document(PageSize.LETTER.rotate(), 39, 36, 132, 67);
        //Document document = new Document(PageSize.LETTER, 60, 45, 140, 75);
        DecimalFormat formateador = new DecimalFormat("####,###,###.##");
        try {
            String path = getServletContext().getRealPath("/") + "img/reporte/";
            String pathimg = getServletContext().getRealPath("/") + "img/reporte/";
// Paso 2: Establecemos el ContentType y creamos una instancia del Writer
            response.setContentType("application/pdf");
            String titulo = request.getParameter("agnombrepdf");
            String agid = request.getParameter("agidpoa");
            String agunificadora = request.getParameter("agunificadora");
            String agaliasuni = request.getParameter("agunificadoraalias");
            String solid = request.getParameter("codigosol");
            String tag = request.getParameter("tagunidad");
            String anio = request.getParameter("anioselect");
            OutputStream file = new FileOutputStream(new File(path + "reporte_POA.pdf"));
            PdfWriter writer = PdfWriter.getInstance(document, response.getOutputStream());
            //PdfWriter writer2 = PdfWriter.getInstance(document, file);
            formatoReporteH eventos = new formatoReporteH(path, titulo, pathimg + "logo-plan.png");

            writer.setPageEvent(eventos);
            //writer2.setPageEvent(eventos);
// Paso 3
            document.open();
// Paso 4
            document.addTitle("Autorizacion");

            Font fuente = new Font();
            fuente.setSize(10);
            Font fuen = new Font(Font.FontFamily.TIMES_ROMAN, 12, 1);
            Font fuen1 = new Font(Font.FontFamily.TIMES_ROMAN, 11, Font.BOLD | Font.ITALIC);
            Font fuente1 = new Font(Font.FontFamily.TIMES_ROMAN, 11, 1);
            Font fuente2 = new Font(Font.FontFamily.TIMES_ROMAN, 8, 1);
            Font fuente3 = new Font(Font.FontFamily.TIMES_ROMAN, 7, 0);
            Font fuente3ne = new Font(Font.FontFamily.TIMES_ROMAN, 7, 1, BaseColor.BLACK);

            Chunk parte2 = new Chunk("Unidad Unificadora: " + agaliasuni, fuen);
            Paragraph para2 = new Paragraph();
            para2.add(parte2);
            para2.setAlignment(Element.ALIGN_CENTER);
            document.add(para2);
            document.add(new Paragraph(" "));

            Chunk parte3 = new Chunk("AUTORIZACIÓN DE UNIFICACIÓN DEL PROCESO", fuen);
            Paragraph para3 = new Paragraph();
            para3.add(parte3);
            para3.setAlignment(Element.ALIGN_CENTER);
            document.add(para3);
            document.add(new Paragraph(" "));

            adEjecucion cCo = new adEjecucion();
            List<cActividadRequerimiento> custodios = new ArrayList<cActividadRequerimiento>();
            Integer area2;
            if (tag.equals("4")) {
                area2 = 0;
            } else {
                area2 = Integer.parseInt(agid);
            }
            custodios = cCo.ListarProyectosCuatodios(Integer.parseInt(agid), Integer.parseInt(solid), area2);
            if (custodios.size() > 0) {
                PdfPTable tablef = new PdfPTable(9);
                tablef.setTotalWidth(new float[]{100, 50, 105, 105, 70, 75, 60, 70, 85});
                tablef.setLockedWidth(true);
                PdfPCell cell;

                cell = new PdfPCell(new Paragraph("Proyecto", fuente2));
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setPadding(5);
                cell.setRowspan(2);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("Cant.", fuente2));
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setPadding(5);
                cell.setRowspan(2);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("Requerimiento Planificad", fuente2));
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setPadding(5);
                cell.setRowspan(2);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("Requerimiento Unificado", fuente2));
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setPadding(5);
                cell.setRowspan(2);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("Justificativo", fuente2));
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setPadding(5);
                cell.setRowspan(2);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("Custodio", fuente2));
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setPadding(5);
                cell.setColspan(4);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("Ubicaciòn", fuente2));
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("Cédula", fuente2));
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("Nombre", fuente2));
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                tablef.addCell(cell);

                cell = new PdfPCell(new Paragraph("Firma", fuente2));
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                cell.setPadding(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                tablef.addCell(cell);

                for (int i = 0; i < custodios.size(); i++) {
                    cell = new PdfPCell(new Paragraph(custodios.get(i).getProyecto_nombre(), fuente3));
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setPadding(5);
                    cell.setRowspan(custodios.get(i).getReq().size());
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    tablef.addCell(cell);

                    for (int j = 0; j < custodios.get(i).getReq().size(); j++) {
                        cell = new PdfPCell(new Paragraph(custodios.get(i).getReq().get(j).getReq_cantidad().toString(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(custodios.get(i).getReq().get(j).getReq_nombre(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(custodios.get(i).getReq().get(j).getReq_descripcion(), fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                        tablef.addCell(cell);

                        cell = new PdfPCell(new Paragraph(custodios.get(i).getReq().get(j).getSolicitud_codigo() + "-UCP-" + anio, fuente3));
                        cell.setBackgroundColor(BaseColor.WHITE);
                        cell.setPadding(5);
                        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                        tablef.addCell(cell);

                        if (j == 0) {
                            cell = new PdfPCell(new Paragraph(custodios.get(i).getSolicitud_centro_costo(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(5);
                            cell.setRowspan(custodios.get(i).getReq().size());
                            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph(custodios.get(i).getSolicitud_cedula(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(5);
                            cell.setRowspan(custodios.get(i).getReq().size());
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph(custodios.get(i).getSolicitud_nombre(), fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(5);
                            cell.setRowspan(custodios.get(i).getReq().size());
                            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                            tablef.addCell(cell);

                            cell = new PdfPCell(new Paragraph(" ", fuente3));
                            cell.setBackgroundColor(BaseColor.WHITE);
                            cell.setPadding(5);
                            cell.setRowspan(custodios.get(i).getReq().size());
                            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                            tablef.addCell(cell);
                        }
                    }
                }
                document.add(tablef);
            }

            document.add(new Paragraph("  "));
            document.add(new Paragraph("  "));
            Chunk parte4 = new Chunk("_____________________________", fuen);
            Paragraph para4 = new Paragraph();
            para4.add(parte4);
            para4.setAlignment(Element.ALIGN_CENTER);
            document.add(para4);

            Chunk parte5;
            if ((tag.equals("4") || tag.equals("3") || tag.equals("5")) && !agid.equals("45")) {
                parte5 = new Chunk("Firma Director/a", fuen);
            } else if (tag.equals("4") && agid.equals("45")) {
                parte5 = new Chunk("Firma Vicerrector/a", fuen);
            } else {
                parte5 = new Chunk("Firma Decano/a", fuen);
            }
            Paragraph para5 = new Paragraph();
            para5.add(parte5);
            para5.setAlignment(Element.ALIGN_CENTER);
            document.add(para5);

        } catch (DocumentException de) {
            de.printStackTrace();
            System.err.println("document: " + de.getMessage());
            System.err.println("error: " + de.getMessage());
        }
// Paso: Cerramos el ‘document (el ‘outputstream’ se cierra automáticamente internamente)
        document.close();
    }

    private void reporteSolicitud(HttpServletRequest request, HttpServletResponse response) throws FileNotFoundException, IOException, DocumentException {
        Document document = new Document(PageSize.LETTER, 60, 45, 120, 50);
        //Document document = new Document(PageSize.LETTER, 60, 45, 140, 75);
        DecimalFormat formateador = new DecimalFormat("####,###,###.##");
        try {
            String path = getServletContext().getRealPath("/") + "img/reporte/";
            String pathimg = getServletContext().getRealPath("/") + "img/reporte/";
// Paso 2: Establecemos el ContentType y creamos una instancia del Writer
            response.setContentType("application/pdf");
            String titulo = request.getParameter("agnombrepdf");
            String anio = request.getParameter("aniopdf");
            String justificativo = request.getParameter("idjustificativo");
            OutputStream file = new FileOutputStream(new File(path + "solicitud_nopac.pdf"));
            PdfWriter writer = PdfWriter.getInstance(document, response.getOutputStream());
            //PdfWriter writer2 = PdfWriter.getInstance(document, file);
            formatoReporteVS eventos = new formatoReporteVS(path);

            writer.setPageEvent(eventos);
            //writer2.setPageEvent(eventos);
// Paso 3
            document.open();
// Paso 4
            document.addTitle("SOLICITUD DE TRAMITE PRESUPUESTARIO");

            //Lista de presupuesto
            List<cActividadRequerimiento> resultproy = new ArrayList<cActividadRequerimiento>();
            adEjecucion aComp = new adEjecucion();
            resultproy = aComp.ListarSolicitudNPCompleta(Integer.parseInt(justificativo));

            Font fuente = new Font();
            fuente.setSize(10);
            Font fuente4 = new Font(Font.FontFamily.TIMES_ROMAN, 10, 0);
            Font fuente5 = new Font(Font.FontFamily.TIMES_ROMAN, 10, 1);
            Font fuente2 = new Font(Font.FontFamily.TIMES_ROMAN, 9, 1);
            Font fuente3 = new Font(Font.FontFamily.TIMES_ROMAN, 9, 0);
            Font fuente3ne = new Font(Font.FontFamily.TIMES_ROMAN, 7, 1, BaseColor.BLACK);
            Font fuente3ne2 = new Font(Font.FontFamily.TIMES_ROMAN, 7, 0);
            Font fuente3n8 = new Font(Font.FontFamily.HELVETICA, 8, 1, BaseColor.BLACK);
            Font fuente3n82 = new Font(Font.FontFamily.HELVETICA, 8, 0);

            Chunk partcodigo;
            if (Integer.parseInt(resultproy.get(0).getSolicitud_codigo()) < 100) {
                partcodigo = new Chunk("SOLICITUD N° 0" + resultproy.get(0).getSolicitud_codigo() + "-STP-" + anio, fuente3);
            } else {
                partcodigo = new Chunk("SOLICITUD N° " + resultproy.get(0).getSolicitud_codigo() + "-STP-" + anio, fuente3);
            }
            Paragraph paracodigo = new Paragraph();
            paracodigo.add(partcodigo);
            paracodigo.setAlignment(Element.ALIGN_RIGHT);
            document.add(paracodigo);

            Locale espanol = new Locale("es", "ES");
            Date date = resultproy.get(0).getSolestado_fecha();
            DateFormat formatter = new SimpleDateFormat("d MMMM yyyy", espanol);
            DateFormat formatter2 = new SimpleDateFormat("dd/MM/yyyy", espanol);
            String today = formatter.format(date);
            Chunk partfecha = new Chunk("RIOBAMBA, " + today.toUpperCase(), fuente3);
            Paragraph parafecha = new Paragraph();
            parafecha.add(partfecha);
            parafecha.setAlignment(Element.ALIGN_RIGHT);
            document.add(parafecha);

            Chunk parteag = new Chunk("SOLICITUD DE TRAMITE PRESUPUESTARIO", fuente2);
            Paragraph paraag = new Paragraph();
            paraag.add(parteag);
            paraag.setAlignment(Element.ALIGN_CENTER);
            document.add(paraag);
            document.add(new Paragraph(" "));

            PdfPTable tablef = new PdfPTable(3);
            tablef.setTotalWidth(new float[]{105, 208, 207});
            tablef.setLockedWidth(true);
            PdfPCell cell;

            cell = new PdfPCell(new Paragraph("ASUNTO:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(0);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(0);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getTc_nombre(), fuente3));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("UNIDAD:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setPaddingTop(5);
            cell.setPaddingLeft(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(titulo, fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setPaddingTop(5);
            cell.setPaddingLeft(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("DIRECCION DE PLANIFICACION", fuente3n8));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.BLACK);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("VERIFICACION POA " + anio, fuente3n8));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente3));
            cell.setColspan(2);
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(0);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(0);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPaddingLeft(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("FECHA:", fuente3n8));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPaddingLeft(60);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getSolicitud_cargo(), fuente3));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getActividad_responsable(), fuente3));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("DIRECTOR/A FINANCIERO/A ESPOCH", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente3));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("DIRECTOR/A", fuente3n8));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("DE MI CONSIDERACION", fuente3));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("REVISADO POR: " + resultproy.get(0).getSolicitud_cedula().toUpperCase(), fuente3n82));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("FECHA: " + formatter2.format(date), fuente3n82));
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.BLACK);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPaddingBottom(5);

            tablef.addCell(cell);

            document.add(tablef);
            document.add(new Paragraph(" "));

            Chunk partecomp = new Chunk("SOLICITO A USTED, AUTORICE A QUIEN CORRESPONDA, REALICE EL TRAMITE DE: " + resultproy.get(0).getTc_nombre() + ", " + resultproy.get(0).getSolestado_observacion() + ", DE ACUERDO AL SIGUIENTE DETALLE:", fuente3);
            Paragraph paraComp = new Paragraph();
            paraComp.add(partecomp);
            paraComp.setAlignment(Element.ALIGN_JUSTIFIED);
            document.add(paraComp);

            document.add(new Paragraph(" "));

            PdfPTable table = new PdfPTable(7);
            table.setTotalWidth(new float[]{36, 36, 152, 72, 75, 61, 83});
            table.setLockedWidth(true);

            cell = new PdfPCell(new Paragraph("(1) OEI.", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(2) CANT.", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(3) DESCRIPCION Y/O ESPECIFICACIONES", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(4) COSTO UNITARIO", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(5) SUBTOTAL", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(6) IVA", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(7) TOTAL", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            double total = 0.0, tiva = 0.0, totaliva = 0.0;
            if (resultproy.get(0).getActividad_eval().size() > 0) {
                for (int i = 0; i < resultproy.get(0).getActividad_eval().size(); i++) {
                    cell = new PdfPCell(new Paragraph("OEI-0" + resultproy.get(0).getActividad_eval().get(i).getPerspectiva_id(), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph(resultproy.get(0).getActividad_eval().get(i).getReq_cantidad().toString(), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph(resultproy.get(0).getActividad_eval().get(i).getReq_nombre(), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(resultproy.get(0).getActividad_eval().get(i).getReq_costo_unitario()), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(resultproy.get(0).getActividad_eval().get(i).getReq_costo_sin_iva()), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    total += resultproy.get(0).getActividad_eval().get(i).getReq_costo_sin_iva();
                    table.addCell(cell);

                    double iv = 0;
                    if (resultproy.get(0).getActividad_eval().get(i).getReq_iva() == 1) {
                        iv = resultproy.get(0).getActividad_eval().get(i).getReq_costo_sin_iva() * 0.12;
                    } else {
                        iv = 0.0;
                    }
                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(iv), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    tiva += iv;
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(resultproy.get(0).getActividad_eval().get(i).getReq_costo_sin_iva() + iv), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    totaliva += resultproy.get(0).getActividad_eval().get(i).getReq_costo_sin_iva() + iv;
                    table.addCell(cell);
                }
            }

            cell = new PdfPCell(new Paragraph("Nota: Adjuntar documentos habilitantes en el caso que amerite.", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            cell.setColspan(3);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("Total", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.WHITE);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("$ " + formateador.format(total), fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.WHITE);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("$ " + formateador.format(tiva), fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.WHITE);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("$ " + formateador.format(totaliva), fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.WHITE);
            table.addCell(cell);

            document.add(table);

            document.add(new Paragraph(" "));
            Chunk partecomp2 = new Chunk("AGRADEZCO SU ATENCION", fuente3);
            Paragraph paraComp2 = new Paragraph();
            paraComp2.add(partecomp2);
            paraComp2.setAlignment(Element.ALIGN_JUSTIFIED);
            document.add(paraComp2);

            document.add(new Paragraph(" "));
            document.add(new Paragraph(" "));
            document.add(new Paragraph(" "));
            document.add(new Paragraph(" "));
            Chunk partedire = new Chunk(resultproy.get(0).getUsuario_titulo() + " " + resultproy.get(0).getUsuario_nombre(), fuente2);
            Paragraph paradir = new Paragraph();
            paradir.add(partedire);
            paradir.setAlignment(Element.ALIGN_LEFT);
            document.add(paradir);
            Chunk partetit = new Chunk(resultproy.get(0).getAg_alias(), fuente2);
            Paragraph paratitul = new Paragraph();
            paratitul.add(partetit);
            paratitul.setAlignment(Element.ALIGN_LEFT);
            document.add(paratitul);

        } catch (DocumentException de) {
            de.printStackTrace();
            System.err.println("document: " + de.getMessage());
            System.err.println("error: " + de.getMessage());
        }
// Paso: Cerramos el ‘document (el ‘outputstream’ se cierra automáticamente internamente)
        document.close();
    }

    private void reporteSolicitudOP(HttpServletRequest request, HttpServletResponse response) throws FileNotFoundException, IOException, DocumentException {
        Document document = new Document(PageSize.LETTER, 60, 45, 120, 50);
        //Document document = new Document(PageSize.LETTER, 60, 45, 140, 75);
        DecimalFormat formateador = new DecimalFormat("####,###,###.##");
        try {
            String path = getServletContext().getRealPath("/") + "img/reporte/";
            String pathimg = getServletContext().getRealPath("/") + "img/reporte/";
// Paso 2: Establecemos el ContentType y creamos una instancia del Writer
            response.setContentType("application/pdf");
            String titulo = request.getParameter("agnombrepdf");
            String justificativo = request.getParameter("idjustificativo");
            String anio = request.getParameter("anioid");
            OutputStream file = new FileOutputStream(new File(path + "solicitud_nopac.pdf"));
            PdfWriter writer = PdfWriter.getInstance(document, response.getOutputStream());
            //PdfWriter writer2 = PdfWriter.getInstance(document, file);
            formatoReporteVS eventos = new formatoReporteVS(path);

            writer.setPageEvent(eventos);
            //writer2.setPageEvent(eventos);
// Paso 3
            document.open();
// Paso 4
            document.addTitle("SOLICITUD DE TRAMITE PRESUPUESTARIO");

            //Lista de presupuesto
            List<cActividadRequerimiento> resultproy = new ArrayList<cActividadRequerimiento>();
            adEjecucion aComp = new adEjecucion();
            resultproy = aComp.ListarSolicitudNPCompletaOP(Integer.parseInt(justificativo));

            Font fuente = new Font();
            fuente.setSize(10);
            Font fuente4 = new Font(Font.FontFamily.TIMES_ROMAN, 10, 0);
            Font fuente5 = new Font(Font.FontFamily.TIMES_ROMAN, 10, 1);
            Font fuente2 = new Font(Font.FontFamily.TIMES_ROMAN, 9, 1);
            Font fuente3 = new Font(Font.FontFamily.TIMES_ROMAN, 9, 0);
            Font fuente3ne = new Font(Font.FontFamily.TIMES_ROMAN, 7, 1, BaseColor.BLACK);
            Font fuente3ne2 = new Font(Font.FontFamily.TIMES_ROMAN, 7, 0);
            Font fuente3n8 = new Font(Font.FontFamily.HELVETICA, 8, 1, BaseColor.BLACK);
            Font fuente3n82 = new Font(Font.FontFamily.HELVETICA, 8, 0);

            Chunk partcodigo;
            if (Integer.parseInt(resultproy.get(0).getSolicitud_codigo()) < 100) {
                partcodigo = new Chunk("SOLICITUD N° 0" + resultproy.get(0).getSolicitud_codigo() + "-STP-" + anio, fuente3);
            } else {
                partcodigo = new Chunk("SOLICITUD N° " + resultproy.get(0).getSolicitud_codigo() + "-STP-" + anio, fuente3);
            }
            Paragraph paracodigo = new Paragraph();
            paracodigo.add(partcodigo);
            paracodigo.setAlignment(Element.ALIGN_RIGHT);
            document.add(paracodigo);

            Locale espanol = new Locale("es", "ES");
            Date date = resultproy.get(0).getSolestado_fecha();
            DateFormat formatter = new SimpleDateFormat("d MMMM yyyy", espanol);
            DateFormat formatter2 = new SimpleDateFormat("dd/MM/yyyy", espanol);
            String today = formatter.format(date);
            Chunk partfecha = new Chunk("RIOBAMBA, " + today.toUpperCase(), fuente3);
            Paragraph parafecha = new Paragraph();
            parafecha.add(partfecha);
            parafecha.setAlignment(Element.ALIGN_RIGHT);
            document.add(parafecha);

            Chunk parteag = new Chunk("SOLICITUD DE TRAMITE PRESUPUESTARIO", fuente2);
            Paragraph paraag = new Paragraph();
            paraag.add(parteag);
            paraag.setAlignment(Element.ALIGN_CENTER);
            document.add(paraag);
            document.add(new Paragraph(" "));

            PdfPTable tablef = new PdfPTable(3);
            tablef.setTotalWidth(new float[]{105, 208, 207});
            tablef.setLockedWidth(true);
            PdfPCell cell;

            cell = new PdfPCell(new Paragraph("ASUNTO:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(0);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(0);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getTc_nombre(), fuente3));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("UNIDAD:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setPaddingTop(5);
            cell.setPaddingLeft(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getAg_nombre(), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setPaddingTop(5);
            cell.setPaddingLeft(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("DIRECCION DE PLANIFICACION", fuente3n8));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.BLACK);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("VERIFICACION POA " + anio, fuente3n8));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente3));
            cell.setColspan(2);
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(0);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(0);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPaddingLeft(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("FECHA:", fuente3n8));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPaddingLeft(60);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente3));
            cell.setColspan(2);
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(0);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(0);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPaddingLeft(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente3n8));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPaddingLeft(60);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getSolicitud_cargo(), fuente3));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getActividad_responsable(), fuente3));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("DIRECTOR/A FINANCIERO/A ESPOCH", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente3));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("DIRECTOR/A", fuente3n8));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("DE MI CONSIDERACION", fuente3));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("REVISADO POR: " + resultproy.get(0).getSolicitud_cedula().toUpperCase(), fuente3n82));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("FECHA: " + formatter2.format(date), fuente3n82));
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.BLACK);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPaddingBottom(5);
            tablef.addCell(cell);

            document.add(tablef);

            document.add(new Paragraph(" "));

            Chunk partecomp = new Chunk("SOLICITO A USTED, AUTORICE A QUIEN CORRESPONDA, REALICE EL TRAMITE DE: " + resultproy.get(0).getTc_nombre() + ", " + resultproy.get(0).getSolestado_observacion() + ", DE ACUERDO AL SIGUIENTE DETALLE:", fuente3);
            Paragraph paraComp = new Paragraph();
            paraComp.add(partecomp);
            paraComp.setAlignment(Element.ALIGN_JUSTIFIED);
            document.add(paraComp);

            document.add(new Paragraph(" "));

            PdfPTable table = new PdfPTable(6);
            table.setTotalWidth(new float[]{50, 140, 80, 80, 80, 80});
            table.setLockedWidth(true);

            cell = new PdfPCell(new Paragraph("(1) OEI.", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(2) DESCRIPCION Y/O ESPECIFICACIONES", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(3) MONTO", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(4) MONTO IVA", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(5) ANTICIPO (998)", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(6) TOTAL", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            double total = 0.0, totald = 0.0;
            if (resultproy.get(0).getActividad_eval().size() > 0) {
                for (int i = 0; i < resultproy.get(0).getActividad_eval().size(); i++) {
                    cell = new PdfPCell(new Paragraph("OEI-0" + resultproy.get(0).getActividad_eval().get(i).getPerspectiva_id(), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph(resultproy.get(0).getActividad_eval().get(i).getReq_nombre(), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(resultproy.get(0).getActividad_eval().get(i).getReq_costo_unitario()), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(resultproy.get(0).getActividad_eval().get(i).getReq_costo_sin_iva()), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(resultproy.get(0).getActividad_eval().get(i).getReq_costo_total()), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    total = resultproy.get(0).getActividad_eval().get(i).getReq_costo_sin_iva() + resultproy.get(0).getActividad_eval().get(i).getReq_costo_unitario() + resultproy.get(0).getActividad_eval().get(i).getReq_costo_total();
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(total), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    table.addCell(cell);
                    totald += total;
                }
                cell = new PdfPCell(new Paragraph("TOTAL", fuente3ne));
                cell.setColspan(5);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                table.addCell(cell);

                cell = new PdfPCell(new Paragraph("$ " + formateador.format(totald), fuente3ne2));
                cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.WHITE);
                table.addCell(cell);
            }

            document.add(table);

            document.add(new Paragraph(" "));
            Chunk partecomp2 = new Chunk("AGRADEZCO SU ATENCION", fuente3);
            Paragraph paraComp2 = new Paragraph();
            paraComp2.add(partecomp2);
            paraComp2.setAlignment(Element.ALIGN_JUSTIFIED);
            document.add(paraComp2);

            document.add(new Paragraph(" "));
            document.add(new Paragraph(" "));
            document.add(new Paragraph(" "));
            document.add(new Paragraph(" "));
            Chunk partedire = new Chunk(resultproy.get(0).getUsuario_titulo() + " " + resultproy.get(0).getUsuario_nombre(), fuente2);
            Paragraph paradir = new Paragraph();
            paradir.add(partedire);
            paradir.setAlignment(Element.ALIGN_LEFT);
            document.add(paradir);
            Chunk partetit = new Chunk(resultproy.get(0).getAg_alias(), fuente2);
            Paragraph paratitul = new Paragraph();
            paratitul.add(partetit);
            paratitul.setAlignment(Element.ALIGN_LEFT);
            document.add(paratitul);

        } catch (DocumentException de) {
            de.printStackTrace();
            System.err.println("document: " + de.getMessage());
            System.err.println("error: " + de.getMessage());
        }
// Paso: Cerramos el ‘document (el ‘outputstream’ se cierra automáticamente internamente)
        document.close();
    }

    private void reporteSolicitudTH(HttpServletRequest request, HttpServletResponse response) throws FileNotFoundException, IOException, DocumentException {
        Document document = new Document(PageSize.LETTER, 60, 45, 105, 50);
        //Document document = new Document(PageSize.LETTER, 60, 45, 140, 75);
        DecimalFormat formateador = new DecimalFormat("####,###,###.##");
        try {
            String path = getServletContext().getRealPath("/") + "img/reporte/";
// Paso 2: Establecemos el ContentType y creamos una instancia del Writer
            response.setContentType("application/pdf");
            String titulo = request.getParameter("agnombrepdf");
            String justificativo = request.getParameter("idjustificativoTH");
            String anio = request.getParameter("aniopdf");
            OutputStream file = new FileOutputStream(new File(path + "solicitud_nopac.pdf"));
            PdfWriter writer = PdfWriter.getInstance(document, response.getOutputStream());
            //PdfWriter writer2 = PdfWriter.getInstance(document, file);
            formatoReporteVS eventos = new formatoReporteVS(path);

            writer.setPageEvent(eventos);
            //writer2.setPageEvent(eventos);
// Paso 3
            document.open();
// Paso 4
            document.addTitle("SOLICITUD DE TRAMITE PRESUPUESTARIO");

            //Lista de presupuesto
            List<cActividadRequerimiento> resultproy = new ArrayList<cActividadRequerimiento>();
            List<cActividadRequerimiento> resultsp = new ArrayList<cActividadRequerimiento>();
            List<cActividadRequerimiento> resultest = new ArrayList<cActividadRequerimiento>();
            List<cActividadRequerimiento> resultCodigo = new ArrayList<cActividadRequerimiento>();
            adEjecucion aComp = new adEjecucion();
            adActividadRequerimiento adAct = new adActividadRequerimiento();
            resultproy = aComp.ListarSolicitudNPCompleta(Integer.parseInt(justificativo));

            Font fuente = new Font();
            fuente.setSize(10);
            Font fuente4 = new Font(Font.FontFamily.TIMES_ROMAN, 10, 0);
            Font fuente5 = new Font(Font.FontFamily.TIMES_ROMAN, 10, 1);
            Font fuente2 = new Font(Font.FontFamily.TIMES_ROMAN, 9, 1);
            Font fuente3 = new Font(Font.FontFamily.TIMES_ROMAN, 9, 0);
            Font fuente3ne = new Font(Font.FontFamily.TIMES_ROMAN, 7, 1, BaseColor.BLACK);
            Font fuente3ne2 = new Font(Font.FontFamily.TIMES_ROMAN, 7, 0);
            Font fuente3ne3 = new Font(Font.FontFamily.TIMES_ROMAN, 8, Font.BOLD | Font.ITALIC);
            Font fuente3n8 = new Font(Font.FontFamily.HELVETICA, 8, 1, BaseColor.BLACK);
            Font fuente3n82 = new Font(Font.FontFamily.HELVETICA, 8, 0);

            Chunk partcodigo;
            if (Integer.parseInt(resultproy.get(0).getSolicitud_codigo()) < 100) {
                partcodigo = new Chunk("SOLICITUD N° 0" + resultproy.get(0).getSolicitud_codigo() + "-STP-" + anio, fuente2);
            } else {
                partcodigo = new Chunk("SOLICITUD N° " + resultproy.get(0).getSolicitud_codigo() + "-STP-" + anio, fuente2);
            }
            Paragraph paracodigo = new Paragraph();
            paracodigo.add(partcodigo);
            paracodigo.setAlignment(Element.ALIGN_RIGHT);
            document.add(paracodigo);

            Locale espanol = new Locale("es", "ES");
            Date date = resultproy.get(0).getSolestado_fecha();
            DateFormat formatter = new SimpleDateFormat("d MMMM yyyy", espanol);
            DateFormat formatter2 = new SimpleDateFormat("dd/MM/yyyy", espanol);
            String today = formatter.format(date);
            Chunk partfecha = new Chunk("RIOBAMBA, " + today.toUpperCase(), fuente3);
            Paragraph parafecha = new Paragraph();
            parafecha.add(partfecha);
            parafecha.setAlignment(Element.ALIGN_RIGHT);
            document.add(parafecha);

            Chunk parteag = new Chunk("SOLICITUD DE TRAMITE PRESUPUESTARIO", fuente2);
            Paragraph paraag = new Paragraph();
            paraag.add(parteag);
            paraag.setAlignment(Element.ALIGN_CENTER);
            document.add(paraag);
            document.add(new Paragraph(" "));

            PdfPTable tablef = new PdfPTable(3);
            tablef.setTotalWidth(new float[]{105, 208, 207});
            tablef.setLockedWidth(true);
            PdfPCell cell;

            cell = new PdfPCell(new Paragraph("ASUNTO:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(0);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(0);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getTc_nombre(), fuente3));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("UNIDAD:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setPaddingTop(5);
            cell.setPaddingLeft(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(titulo, fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setPaddingTop(5);
            cell.setPaddingLeft(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("DIRECCION DE PLANIFICACION", fuente3n8));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.BLACK);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("VERIFICACION POA " + anio, fuente3n8));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente3));
            cell.setColspan(2);
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(0);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(0);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPaddingLeft(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("FECHA:", fuente3n8));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPaddingLeft(60);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getSolicitud_cargo(), fuente3));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getActividad_responsable(), fuente3));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("DIRECTOR/A FINANCIERO/A ESPOCH", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente3));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("DIRECTOR/A", fuente3n8));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("DE MI CONSIDERACION", fuente3));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("REVISADO POR: " + resultproy.get(0).getSolicitud_cedula().toUpperCase(), fuente3n82));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("FECHA: " + formatter2.format(date), fuente3n82));
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.BLACK);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPaddingBottom(5);

            tablef.addCell(cell);

            document.add(tablef);
            document.add(new Paragraph(" "));
            if (!adAct.codigoSolitudDispo(Integer.parseInt(justificativo))) {
                Chunk partecomp = new Chunk("SOLICITO A USTED, AUTORICE A QUIEN CORRESPONDA, REALICE EL TRAMITE DE: " + resultproy.get(0).getTc_nombre() + ", " + resultproy.get(0).getSolestado_observacion() + ", DE ACUERDO AL SIGUIENTE DETALLE:", fuente3);
                Paragraph paraComp = new Paragraph();
                paraComp.add(partecomp);
                paraComp.setAlignment(Element.ALIGN_JUSTIFIED);
                document.add(paraComp);
            } else {
                resultCodigo = adAct.ListarcodigosSTP(Integer.parseInt(justificativo));
                String codigo = "";
                for (int i = 0; i < resultCodigo.size(); i++) {
                    codigo += resultCodigo.get(i).getSolicitud_codigo() + "-STP-" + resultCodigo.get(i).getReq_anio() + ",";
                }
                Chunk partecomp = new Chunk("SOLICITO A USTED, AUTORICE A QUIEN CORRESPONDA, REALICE EL TRAMITE DE: " + resultproy.get(0).getTc_nombre() + ", " + resultproy.get(0).getSolestado_observacion() + ".", fuente3);
                Paragraph paraComp = new Paragraph();
                paraComp.add(partecomp);
                paraComp.setAlignment(Element.ALIGN_JUSTIFIED);
                document.add(paraComp);

                Chunk partecompd = new Chunk("REFERENCIA DISPONIBILIDAD N° " + codigo + " DE ACUERDO AL SIGUIENTE DETALLE:", fuente3);
                Paragraph paraCompd = new Paragraph();
                paraCompd.add(partecompd);
                paraCompd.setAlignment(Element.ALIGN_JUSTIFIED);
                document.add(paraCompd);
            }

            document.add(new Paragraph(" "));

            PdfPTable table = new PdfPTable(7);
            table.setTotalWidth(new float[]{36, 36, 152, 72, 75, 61, 83});
            table.setLockedWidth(true);

            cell = new PdfPCell(new Paragraph("(1) OEI.", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(2) CANT.", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(3) DESCRIPCION Y/O ESPECIFICACIONES", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(4) COSTO UNITARIO", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(5) SUBTOTAL", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(6) IVA", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(7) TOTAL", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            double total = 0.0, tiva = 0.0, totaliva = 0.0;
            if (resultproy.get(0).getActividad_eval().size() > 0) {
                for (int i = 0; i < resultproy.get(0).getActividad_eval().size(); i++) {
                    cell = new PdfPCell(new Paragraph("OEI-0" + resultproy.get(0).getActividad_eval().get(i).getPerspectiva_id(), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph(resultproy.get(0).getActividad_eval().get(i).getReq_cantidad().toString(), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph(resultproy.get(0).getActividad_eval().get(i).getReq_nombre(), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(resultproy.get(0).getActividad_eval().get(i).getReq_costo_unitario()), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(resultproy.get(0).getActividad_eval().get(i).getReq_costo_sin_iva()), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    total += resultproy.get(0).getActividad_eval().get(i).getReq_costo_sin_iva();
                    table.addCell(cell);
                    double iv = 0;
                    if (resultproy.get(0).getActividad_eval().get(i).getReq_iva() == 1) {
                        iv = resultproy.get(0).getActividad_eval().get(i).getReq_costo_sin_iva() * 0.12;
                    } else {
                        iv = 0.0;
                    }
                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(iv), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    tiva += iv;
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(resultproy.get(0).getActividad_eval().get(i).getReq_costo_sin_iva() + iv), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    totaliva += resultproy.get(0).getActividad_eval().get(i).getReq_costo_sin_iva() + iv;
                    table.addCell(cell);
                }
            }

            cell = new PdfPCell(new Paragraph("Nota: Adjuntar documentos habilitantes en el caso que amerite.", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            cell.setColspan(3);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("Total", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.WHITE);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("$ " + formateador.format(total), fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.WHITE);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("$ " + formateador.format(tiva), fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.WHITE);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("$ " + formateador.format(totaliva), fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.WHITE);
            table.addCell(cell);

            document.add(table);

            document.add(new Paragraph(" "));
            Chunk partecomp2 = new Chunk("AGRADEZCO SU ATENCION", fuente3);
            Paragraph paraComp2 = new Paragraph();
            paraComp2.add(partecomp2);
            paraComp2.setAlignment(Element.ALIGN_JUSTIFIED);
            document.add(paraComp2);

            document.add(new Paragraph(" "));
            document.add(new Paragraph(" "));
            document.add(new Paragraph(" "));
            document.add(new Paragraph(" "));
            Chunk partedire = new Chunk(resultproy.get(0).getUsuario_titulo() + " " + resultproy.get(0).getUsuario_nombre(), fuente2);
            Paragraph paradir = new Paragraph();
            paradir.add(partedire);
            paradir.setAlignment(Element.ALIGN_LEFT);
            document.add(paradir);
            Chunk partetit = new Chunk(resultproy.get(0).getAg_alias(), fuente2);
            Paragraph paratitul = new Paragraph();
            paratitul.add(partetit);
            paratitul.setAlignment(Element.ALIGN_LEFT);
            document.add(paratitul);

            Chunk parteadj = new Chunk("Adj. Listado Personal", fuente3ne3);
            Paragraph paratituladj = new Paragraph();
            paratituladj.add(parteadj);
            paratituladj.setAlignment(Element.ALIGN_LEFT);
            document.add(paratituladj);
            document.newPage();

            resultsp = adAct.ListarPersonalSol(Integer.parseInt(justificativo));
            parteag = new Chunk("LISTA PERSONAL", fuente2);
            paraag = new Paragraph();
            paraag.add(parteag);
            paraag.setAlignment(Element.ALIGN_CENTER);
            document.add(paraag);
            document.add(new Paragraph(" "));

            resultest = adAct.ListarPersonalSolEst(Integer.parseInt(justificativo));
            if (resultest.size() > 0) {
                PdfPTable tablesp = new PdfPTable(10);
                tablesp.setTotalWidth(new float[]{60, 60, 60, 60, 55, 50, 50, 55, 42, 48});
                tablesp.setLockedWidth(true);

                for (int j = 0; j < resultest.size(); j++) {
                    cell = new PdfPCell(new Paragraph("DATOS ESTUDIANTE", fuente3ne));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                    cell.setColspan(10);
                    tablesp.addCell(cell);

                    cell = new PdfPCell(new Paragraph("CI: " + resultest.get(j).getSolicitud_cedula(), fuente3ne));
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setColspan(2);
                    tablesp.addCell(cell);

                    cell = new PdfPCell(new Paragraph("NOMBRE: " + resultest.get(j).getSolicitud_nombre() + " " + resultest.get(j).getSolicitud_cargo(), fuente3ne));
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    cell.setColspan(8);
                    tablesp.addCell(cell);

                    cell = new PdfPCell(new Paragraph("DATOS MIEMBRO Y/O TUTOR", fuente3ne));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                    cell.setColspan(10);
                    tablesp.addCell(cell);

                    cell = new PdfPCell(new Paragraph("APELLIDOS Y NOMBRES", fuente3ne));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                    tablesp.addCell(cell);

                    cell = new PdfPCell(new Paragraph("CARGO", fuente3ne));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                    tablesp.addCell(cell);

                    cell = new PdfPCell(new Paragraph("DEPENDENCIA", fuente3ne));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                    tablesp.addCell(cell);

                    cell = new PdfPCell(new Paragraph("PROYECTO", fuente3ne));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                    tablesp.addCell(cell);

                    cell = new PdfPCell(new Paragraph("TIPO", fuente3ne));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                    tablesp.addCell(cell);

                    cell = new PdfPCell(new Paragraph("FECHA INI.", fuente3ne));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                    tablesp.addCell(cell);

                    cell = new PdfPCell(new Paragraph("FECHA FIN", fuente3ne));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                    tablesp.addCell(cell);

                    cell = new PdfPCell(new Paragraph("TOTAL SIN IVA", fuente3ne));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                    tablesp.addCell(cell);

                    cell = new PdfPCell(new Paragraph("IVA", fuente3ne));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                    tablesp.addCell(cell);

                    cell = new PdfPCell(new Paragraph("TOTAL", fuente3ne));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                    tablesp.addCell(cell);

                    double totalsp = 0.0, totalsiva = 0.0, iva = 0.0, toiva = 0.0;

                    for (int i = 0; i < resultsp.size(); i++) {
                        if (resultest.get(j).getSolicitud_cedula().equals(resultsp.get(i).getAutoridades_cedula())) {
                            cell = new PdfPCell(new Paragraph(resultsp.get(i).getReq_descripcion() + " " + resultsp.get(i).getReq_nombre(), fuente3ne2));
                            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                            cell.setBackgroundColor(BaseColor.WHITE);
                            tablesp.addCell(cell);

                            cell = new PdfPCell(new Paragraph(resultsp.get(i).getActividad_nombre(), fuente3ne2));
                            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                            cell.setBackgroundColor(BaseColor.WHITE);
                            tablesp.addCell(cell);

                            cell = new PdfPCell(new Paragraph(resultsp.get(i).getAg_nombre(), fuente3ne2));
                            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                            cell.setBackgroundColor(BaseColor.WHITE);
                            tablesp.addCell(cell);

                            cell = new PdfPCell(new Paragraph(resultsp.get(i).getProyecto_nombre(), fuente3ne2));
                            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                            cell.setBackgroundColor(BaseColor.WHITE);
                            tablesp.addCell(cell);

                            String tipo;
                            if (null == resultsp.get(i).getActividad_id()) {
                                tipo = "--";
                            } else {
                                switch (resultsp.get(i).getActividad_id()) {
                                    case 3:
                                        tipo = "HONORARIO FIJO";
                                        break;
                                    case 2:
                                        tipo = "HONORARIOS MENSUALES";
                                        break;
                                    case 1:
                                        tipo = "HORAS CLASE";
                                        break;
                                    default:
                                        tipo = "--";
                                        break;
                                }
                            }
                            cell = new PdfPCell(new Paragraph(tipo, fuente3ne2));
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                            cell.setBackgroundColor(BaseColor.WHITE);
                            tablesp.addCell(cell);

                            try {
                                if (resultsp.get(i).getFecha_inicio().isEmpty()) {
                                    cell = new PdfPCell(new Paragraph("---", fuente3ne2));
                                } else {
                                    cell = new PdfPCell(new Paragraph(resultsp.get(i).getFecha_inicio(), fuente3ne2));
                                }
                            } catch (Exception e) {
                                cell = new PdfPCell(new Paragraph("---", fuente3ne2));
                            }
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                            cell.setBackgroundColor(BaseColor.WHITE);
                            tablesp.addCell(cell);

                            try {
                                if (resultsp.get(i).getFecha_fin().isEmpty()) {
                                    cell = new PdfPCell(new Paragraph("---", fuente3ne2));
                                } else {
                                    cell = new PdfPCell(new Paragraph(resultsp.get(i).getFecha_fin(), fuente3ne2));
                                }
                            } catch (Exception e) {
                                cell = new PdfPCell(new Paragraph("---", fuente3ne2));
                            }
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                            cell.setBackgroundColor(BaseColor.WHITE);
                            tablesp.addCell(cell);

                            cell = new PdfPCell(new Paragraph("$ " + formateador.format(resultsp.get(i).getReq_costo_sin_iva()), fuente3ne2));
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                            cell.setBackgroundColor(BaseColor.WHITE);
                            tablesp.addCell(cell);
                            totalsiva += resultsp.get(i).getReq_costo_sin_iva();

                            iva = resultsp.get(i).getReq_costo_total() - resultsp.get(i).getReq_costo_sin_iva();
                            cell = new PdfPCell(new Paragraph("$ " + formateador.format(iva), fuente3ne2));
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                            cell.setBackgroundColor(BaseColor.WHITE);
                            tablesp.addCell(cell);
                            toiva += iva;

                            cell = new PdfPCell(new Paragraph("$ " + formateador.format(resultsp.get(i).getReq_costo_total()), fuente3ne2));
                            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                            cell.setBackgroundColor(BaseColor.WHITE);
                            tablesp.addCell(cell);
                            totalsp += resultsp.get(i).getReq_costo_total();
                        }
                    }
                }
                document.add(tablesp);
            } else {
                PdfPTable tablesp = new PdfPTable(10);
                tablesp.setTotalWidth(new float[]{60, 60, 60, 60, 55, 50, 50, 55, 42, 48});
                tablesp.setLockedWidth(true);

                cell = new PdfPCell(new Paragraph("APELLIDOS Y NOMBRES", fuente3ne));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                tablesp.addCell(cell);

                cell = new PdfPCell(new Paragraph("CARGO", fuente3ne));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                tablesp.addCell(cell);

                cell = new PdfPCell(new Paragraph("DEPENDENCIA", fuente3ne));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                tablesp.addCell(cell);

                cell = new PdfPCell(new Paragraph("PROYECTO", fuente3ne));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                tablesp.addCell(cell);

                cell = new PdfPCell(new Paragraph("TIPO", fuente3ne));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                tablesp.addCell(cell);

                cell = new PdfPCell(new Paragraph("FECHA INI.", fuente3ne));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                tablesp.addCell(cell);

                cell = new PdfPCell(new Paragraph("FECHA FIN", fuente3ne));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                tablesp.addCell(cell);

                cell = new PdfPCell(new Paragraph("TOTAL SIN IVA", fuente3ne));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                tablesp.addCell(cell);

                cell = new PdfPCell(new Paragraph("IVA", fuente3ne));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                tablesp.addCell(cell);

                cell = new PdfPCell(new Paragraph("TOTAL", fuente3ne));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
                tablesp.addCell(cell);

                double totalsp = 0.0, totalsiva = 0.0, iva = 0.0, toiva = 0.0;

                for (int i = 0; i < resultsp.size(); i++) {
                    cell = new PdfPCell(new Paragraph(resultsp.get(i).getReq_descripcion() + " " + resultsp.get(i).getReq_nombre(), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    tablesp.addCell(cell);

                    cell = new PdfPCell(new Paragraph(resultsp.get(i).getActividad_nombre(), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    tablesp.addCell(cell);

                    cell = new PdfPCell(new Paragraph(resultsp.get(i).getAg_nombre(), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    tablesp.addCell(cell);

                    cell = new PdfPCell(new Paragraph(resultsp.get(i).getProyecto_nombre(), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    tablesp.addCell(cell);

                    String tipo;
                    if (null == resultsp.get(i).getActividad_id()) {
                        tipo = "--";
                    } else {
                        switch (resultsp.get(i).getActividad_id()) {
                            case 3:
                                tipo = "HONORARIO FIJO";
                                break;
                            case 2:
                                tipo = "HONORARIOS MENSUALES";
                                break;
                            case 1:
                                tipo = "HORAS CLASE";
                                break;
                            default:
                                tipo = "--";
                                break;
                        }
                    }
                    cell = new PdfPCell(new Paragraph(tipo, fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    tablesp.addCell(cell);

                    try {
                        if (resultsp.get(i).getFecha_inicio().isEmpty()) {
                            cell = new PdfPCell(new Paragraph("---", fuente3ne2));
                        } else {
                            cell = new PdfPCell(new Paragraph(resultsp.get(i).getFecha_inicio(), fuente3ne2));
                        }
                    } catch (Exception e) {
                        cell = new PdfPCell(new Paragraph("---", fuente3ne2));
                    }
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    tablesp.addCell(cell);

                    try {
                        if (resultsp.get(i).getFecha_fin().isEmpty()) {
                            cell = new PdfPCell(new Paragraph("---", fuente3ne2));
                        } else {
                            cell = new PdfPCell(new Paragraph(resultsp.get(i).getFecha_fin(), fuente3ne2));
                        }
                    } catch (Exception e) {
                        cell = new PdfPCell(new Paragraph("---", fuente3ne2));
                    }
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    tablesp.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(resultsp.get(i).getReq_costo_sin_iva()), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    tablesp.addCell(cell);
                    totalsiva += resultsp.get(i).getReq_costo_sin_iva();

                    iva = resultsp.get(i).getReq_costo_total() - resultsp.get(i).getReq_costo_sin_iva();
                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(iva), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    tablesp.addCell(cell);
                    toiva += iva;

                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(resultsp.get(i).getReq_costo_total()), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    tablesp.addCell(cell);
                    totalsp += resultsp.get(i).getReq_costo_total();
                }
                document.add(tablesp);
            }
        } catch (DocumentException de) {
            de.printStackTrace();
            System.err.println("document: " + de.getMessage());
            System.err.println("error: " + de.getMessage());
        }
// Paso: Cerramos el ‘document (el ‘outputstream’ se cierra automáticamente internamente)
        document.close();
    }

    private void reporteSolicitudTHOP(HttpServletRequest request, HttpServletResponse response) throws FileNotFoundException, IOException, DocumentException {
        Document document = new Document(PageSize.LETTER, 60, 45, 105, 50);
        //Document document = new Document(PageSize.LETTER, 60, 45, 140, 75);
        DecimalFormat formateador = new DecimalFormat("####,###,###.##");
        try {
            String path = getServletContext().getRealPath("/") + "img/reporte/";
// Paso 2: Establecemos el ContentType y creamos una instancia del Writer
            response.setContentType("application/pdf");
            String titulo = request.getParameter("agnombrepdf");
            String justificativo = request.getParameter("idjustificativoTH");
            String anio = request.getParameter("anioid");
            OutputStream file = new FileOutputStream(new File(path + "solicitud_nopac.pdf"));
            PdfWriter writer = PdfWriter.getInstance(document, response.getOutputStream());
            //PdfWriter writer2 = PdfWriter.getInstance(document, file);
            formatoReporteVS eventos = new formatoReporteVS(path);

            writer.setPageEvent(eventos);
            //writer2.setPageEvent(eventos);
// Paso 3
            document.open();
// Paso 4
            document.addTitle("SOLICITUD DE TRAMITE PRESUPUESTARIO");

            //Lista de presupuesto
            List<cActividadRequerimiento> resultproy = new ArrayList<cActividadRequerimiento>();
            List<cActividadRequerimiento> resultsp = new ArrayList<cActividadRequerimiento>();
            adEjecucion aComp = new adEjecucion();
            adActividadRequerimiento adAct = new adActividadRequerimiento();
            resultproy = aComp.ListarSolicitudNPCompletaOP(Integer.parseInt(justificativo));

            Font fuente = new Font();
            fuente.setSize(10);
            Font fuente4 = new Font(Font.FontFamily.TIMES_ROMAN, 10, 0);
            Font fuente5 = new Font(Font.FontFamily.TIMES_ROMAN, 10, 1);
            Font fuente2 = new Font(Font.FontFamily.TIMES_ROMAN, 9, 1);
            Font fuente3 = new Font(Font.FontFamily.TIMES_ROMAN, 9, 0);
            Font fuente3ne = new Font(Font.FontFamily.TIMES_ROMAN, 7, 1, BaseColor.BLACK);
            Font fuente3ne2 = new Font(Font.FontFamily.TIMES_ROMAN, 7, 0);
            Font fuente3ne3 = new Font(Font.FontFamily.TIMES_ROMAN, 8, Font.BOLD | Font.ITALIC);
            Font fuente3n8 = new Font(Font.FontFamily.HELVETICA, 8, 1, BaseColor.BLACK);
            Font fuente3n82 = new Font(Font.FontFamily.HELVETICA, 8, 0);

            Chunk partcodigo;
            if (Integer.parseInt(resultproy.get(0).getSolicitud_codigo()) < 100) {
                partcodigo = new Chunk("SOLICITUD N° 0" + resultproy.get(0).getSolicitud_codigo() + "-STP-" + anio, fuente2);
            } else {
                partcodigo = new Chunk("SOLICITUD N° " + resultproy.get(0).getSolicitud_codigo() + "-STP-" + anio, fuente2);
            }
            Paragraph paracodigo = new Paragraph();
            paracodigo.add(partcodigo);
            paracodigo.setAlignment(Element.ALIGN_RIGHT);
            document.add(paracodigo);

            Locale espanol = new Locale("es", "ES");
            Date date = resultproy.get(0).getSolestado_fecha();
            DateFormat formatter = new SimpleDateFormat("d MMMM yyyy", espanol);
            DateFormat formatter2 = new SimpleDateFormat("dd/MM/yyyy", espanol);
            String today = formatter.format(date);
            Chunk partfecha = new Chunk("RIOBAMBA, " + today.toUpperCase(), fuente3);
            Paragraph parafecha = new Paragraph();
            parafecha.add(partfecha);
            parafecha.setAlignment(Element.ALIGN_RIGHT);
            document.add(parafecha);

            Chunk parteag = new Chunk("SOLICITUD DE TRAMITE PRESUPUESTARIO", fuente2);
            Paragraph paraag = new Paragraph();
            paraag.add(parteag);
            paraag.setAlignment(Element.ALIGN_CENTER);
            document.add(paraag);
            document.add(new Paragraph(" "));

            PdfPTable tablef = new PdfPTable(3);
            tablef.setTotalWidth(new float[]{105, 208, 207});
            tablef.setLockedWidth(true);
            PdfPCell cell;

            cell = new PdfPCell(new Paragraph("ASUNTO:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(0);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(0);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getTc_nombre(), fuente3));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setPadding(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("UNIDAD:", fuente2));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setPaddingTop(5);
            cell.setPaddingLeft(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getAg_nombre(), fuente3));
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setPaddingTop(5);
            cell.setPaddingLeft(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("DIRECCION DE PLANIFICACION", fuente3n8));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.BLACK);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("VERIFICACION POA " + anio, fuente3n8));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente3));
            cell.setColspan(2);
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(0);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(0);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPaddingLeft(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("FECHA:", fuente3n8));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPaddingLeft(60);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente3));
            cell.setColspan(2);
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(0);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(0);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPaddingLeft(5);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente3n8));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPaddingLeft(60);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getSolicitud_cargo(), fuente3));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(resultproy.get(0).getActividad_responsable(), fuente3));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("DIRECTOR/A FINANCIERO/A ESPOCH", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente3));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("DIRECTOR/A", fuente3n8));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("DE MI CONSIDERACION", fuente3));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("REVISADO POR: " + resultproy.get(0).getSolicitud_cedula().toUpperCase(), fuente3n82));
            cell.setBorderWidthBottom(0);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph(" ", fuente2));
            cell.setColspan(2);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.WHITE);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.WHITE);
            cell.setBorderWidthTop(1);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setHorizontalAlignment(Element.ALIGN_LEFT);
            cell.setPaddingLeft(5);
            tablef.addCell(cell);

            cell = new PdfPCell(new Paragraph("FECHA: " + formatter2.format(date), fuente3n82));
            cell.setBorderWidthBottom(1);
            cell.setBorderColorBottom(BaseColor.BLACK);
            cell.setBorderWidthLeft(1);
            cell.setBorderColorLeft(BaseColor.BLACK);
            cell.setBorderWidthRight(1);
            cell.setBorderColorRight(BaseColor.BLACK);
            cell.setBorderWidthTop(0);
            cell.setBorderColorTop(BaseColor.WHITE);
            cell.setBackgroundColor(BaseColor.WHITE);
            cell.setPaddingBottom(5);
            tablef.addCell(cell);

            document.add(tablef);

            document.add(new Paragraph(" "));

            Chunk partecomp = new Chunk("SOLICITO A USTED, AUTORICE A QUIEN CORRESPONDA, REALICE EL TRAMITE DE: " + resultproy.get(0).getTc_nombre() + ", " + resultproy.get(0).getSolestado_observacion() + ", DE ACUERDO AL SIGUIENTE DETALLE:", fuente3);
            Paragraph paraComp = new Paragraph();
            paraComp.add(partecomp);
            paraComp.setAlignment(Element.ALIGN_JUSTIFIED);
            document.add(paraComp);

            document.add(new Paragraph(" "));

            PdfPTable table = new PdfPTable(6);
            table.setTotalWidth(new float[]{50, 140, 80, 80, 80, 80});
            table.setLockedWidth(true);

            cell = new PdfPCell(new Paragraph("(1) OEI.", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(2) DESCRIPCION Y/O ESPECIFICACIONES", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(3) MONTO", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(4) MONTO IVA", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(5) ANTICIPO (998)", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            cell = new PdfPCell(new Paragraph("(6) TOTAL", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            table.addCell(cell);

            double total = 0.0;
            if (resultproy.get(0).getActividad_eval().size() > 0) {
                for (int i = 0; i < resultproy.get(0).getActividad_eval().size(); i++) {
                    cell = new PdfPCell(new Paragraph("OEI-0" + resultproy.get(0).getActividad_eval().get(i).getPerspectiva_id(), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph(resultproy.get(0).getActividad_eval().get(i).getReq_nombre(), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(resultproy.get(0).getActividad_eval().get(i).getReq_costo_unitario()), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(resultproy.get(0).getActividad_eval().get(i).getReq_costo_sin_iva()), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(resultproy.get(0).getActividad_eval().get(i).getReq_costo_total()), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    total = resultproy.get(0).getActividad_eval().get(i).getReq_costo_sin_iva() + resultproy.get(0).getActividad_eval().get(i).getReq_costo_unitario() + resultproy.get(0).getActividad_eval().get(i).getReq_costo_total();
                    table.addCell(cell);

                    cell = new PdfPCell(new Paragraph("$ " + formateador.format(total), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    table.addCell(cell);
                }
            }

            document.add(table);

            document.add(new Paragraph(" "));
            Chunk partecomp2 = new Chunk("AGRADEZCO SU ATENCION", fuente3);
            Paragraph paraComp2 = new Paragraph();
            paraComp2.add(partecomp2);
            paraComp2.setAlignment(Element.ALIGN_JUSTIFIED);
            document.add(paraComp2);

            document.add(new Paragraph(" "));
            document.add(new Paragraph(" "));
            document.add(new Paragraph(" "));
            document.add(new Paragraph(" "));
            Chunk partedire = new Chunk(resultproy.get(0).getUsuario_titulo() + " " + resultproy.get(0).getUsuario_nombre(), fuente2);
            Paragraph paradir = new Paragraph();
            paradir.add(partedire);
            paradir.setAlignment(Element.ALIGN_LEFT);
            document.add(paradir);
            Chunk partetit = new Chunk(resultproy.get(0).getAg_alias(), fuente2);
            Paragraph paratitul = new Paragraph();
            paratitul.add(partetit);
            paratitul.setAlignment(Element.ALIGN_LEFT);
            document.add(paratitul);

            Chunk parteadj = new Chunk("Adj. Listado Personal", fuente3ne3);
            Paragraph paratituladj = new Paragraph();
            paratituladj.add(parteadj);
            paratituladj.setAlignment(Element.ALIGN_LEFT);
            document.add(paratituladj);
            document.newPage();

            resultsp = adAct.ListarPersonalSolOP(Integer.parseInt(justificativo));
            parteag = new Chunk("LISTA PERSONAL", fuente2);
            paraag = new Paragraph();
            paraag.add(parteag);
            paraag.setAlignment(Element.ALIGN_CENTER);
            document.add(paraag);
            document.add(new Paragraph(" "));

            PdfPTable tablesp = new PdfPTable(10);
            tablesp.setTotalWidth(new float[]{60, 60, 60, 60, 55, 50, 50, 55, 42, 48});
            tablesp.setLockedWidth(true);

            cell = new PdfPCell(new Paragraph("APELLIDOS Y NOMBRES", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            tablesp.addCell(cell);

            cell = new PdfPCell(new Paragraph("CARGO", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            tablesp.addCell(cell);

            cell = new PdfPCell(new Paragraph("DEPENDENCIA", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            tablesp.addCell(cell);

            cell = new PdfPCell(new Paragraph("PROYECTO", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            tablesp.addCell(cell);

            cell = new PdfPCell(new Paragraph("TIPO", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            tablesp.addCell(cell);

            cell = new PdfPCell(new Paragraph("FECHA INI.", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            tablesp.addCell(cell);

            cell = new PdfPCell(new Paragraph("FECHA FIN", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            tablesp.addCell(cell);

            cell = new PdfPCell(new Paragraph("TOTAL SIN IVA", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            tablesp.addCell(cell);

            cell = new PdfPCell(new Paragraph("IVA", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            tablesp.addCell(cell);

            cell = new PdfPCell(new Paragraph("TOTAL", fuente3ne));
            cell.setHorizontalAlignment(Element.ALIGN_CENTER);
            cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
            cell.setBackgroundColor(BaseColor.LIGHT_GRAY);
            tablesp.addCell(cell);

            double totalsp = 0.0, totalsiva = 0.0, iva = 0.0, toiva = 0.0;

            for (int i = 0; i < resultsp.size(); i++) {
                cell = new PdfPCell(new Paragraph(resultsp.get(i).getReq_descripcion() + " " + resultsp.get(i).getReq_nombre(), fuente3ne2));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.WHITE);
                tablesp.addCell(cell);

                cell = new PdfPCell(new Paragraph(resultsp.get(i).getActividad_nombre(), fuente3ne2));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.WHITE);
                tablesp.addCell(cell);

                cell = new PdfPCell(new Paragraph(resultsp.get(i).getAg_nombre(), fuente3ne2));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.WHITE);
                tablesp.addCell(cell);

                cell = new PdfPCell(new Paragraph(resultsp.get(i).getProyecto_nombre(), fuente3ne2));
                cell.setHorizontalAlignment(Element.ALIGN_LEFT);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.WHITE);
                tablesp.addCell(cell);

                String tipo;
                if (null == resultsp.get(i).getActividad_id()) {
                    tipo = "--";
                } else {
                    switch (resultsp.get(i).getActividad_id()) {
                        case 3:
                            tipo = "HONORARIO FIJO";
                            break;
                        case 2:
                            tipo = "HONORARIOS MENSUALES";
                            break;
                        case 1:
                            tipo = "HORAS CLASE";
                            break;
                        default:
                            tipo = "--";
                            break;
                    }
                }
                cell = new PdfPCell(new Paragraph(tipo, fuente3ne2));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.WHITE);
                tablesp.addCell(cell);

                if (resultsp.get(i).getActividad_id() == 2) {
                    cell = new PdfPCell(new Paragraph(resultsp.get(i).getFecha_inicio(), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    tablesp.addCell(cell);

                    cell = new PdfPCell(new Paragraph(resultsp.get(i).getFecha_fin(), fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    tablesp.addCell(cell);
                } else {
                    cell = new PdfPCell(new Paragraph("---", fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    tablesp.addCell(cell);

                    cell = new PdfPCell(new Paragraph("---", fuente3ne2));
                    cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                    cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                    cell.setBackgroundColor(BaseColor.WHITE);
                    tablesp.addCell(cell);
                }

                cell = new PdfPCell(new Paragraph("$ " + formateador.format(resultsp.get(i).getReq_costo_sin_iva()), fuente3ne2));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.WHITE);
                tablesp.addCell(cell);
                totalsiva += resultsp.get(i).getReq_costo_sin_iva();

                iva = resultsp.get(i).getReq_costo_total() - resultsp.get(i).getReq_costo_sin_iva();
                cell = new PdfPCell(new Paragraph("$ " + formateador.format(iva), fuente3ne2));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.WHITE);
                tablesp.addCell(cell);
                toiva += iva;

                cell = new PdfPCell(new Paragraph("$ " + formateador.format(resultsp.get(i).getReq_costo_total()), fuente3ne2));
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
                cell.setBackgroundColor(BaseColor.WHITE);
                tablesp.addCell(cell);
                totalsp += resultsp.get(i).getReq_costo_total();
            }
            document.add(tablesp);

        } catch (DocumentException de) {
            de.printStackTrace();
            System.err.println("document: " + de.getMessage());
            System.err.println("error: " + de.getMessage());
        }
// Paso: Cerramos el ‘document (el ‘outputstream’ se cierra automáticamente internamente)
        document.close();
    }
}
